<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–¢–∞–∫—Å–∏ ¬´–£—Å–ø–µ—Ö¬ª ‚Äî –ë–µ–ª–æ—É—Å–æ–≤–∫–∞</title>

    <!-- Google Analytics (–ö–û–î –ê–ö–¢–ò–í–ò–†–û–í–ê–ù: G-NMCTD2Q8R2) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NMCTD2Q8R2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('config', 'G-NMCTD2Q8R2');
    </script>
    <!-- –ö–û–ù–ï–¶ Google Analytics -->

    <!-- Favicon –∏ –∏–∫–æ–Ω–∫–∏ –¥–ª—è Apple/Android -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png?v=12">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon-192x192.png?v=12">
    <link rel="apple-touch-icon" href="apple-touch-icon.png?v=12">
    <link rel="manifest" href="site.webmanifest?v=12">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        /* –£–ª—É—á—à–µ–Ω–∏–µ –¥–ª—è PWA: –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ "—Ä–µ–∑–∏–Ω–æ–≤–æ–π" –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
        html, body {
            overscroll-behavior-y: none;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f5f5f5; /* light mode bg */
            padding-bottom: 90px; /* –£–≤–µ–ª–∏—á–µ–Ω–æ –∏–∑-–∑–∞ –Ω–∏–∂–Ω–µ–≥–æ –±–∞—Ä–∞ */
            transition: background-color 0.3s, color 0.3s;
            color: #1f2937; 
            -webkit-tap-highlight-color: transparent; /* –£–±–∏—Ä–∞–µ—Ç —Å–∏–Ω—é—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ —Ç–∞–ø–µ –Ω–∞ Android */
        }
        
        /* Glassmorphism Header */
        .header-bg { 
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.95) 0%, rgba(29, 78, 216, 0.95) 100%); 
            backdrop-filter: blur(10px);
            transition: background 0.3s;
        }

        .btn-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .btn-active:active { transform: scale(0.97); } /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è */

        .service-card, .main-card, .auction-cta, .stroy-dom-cta, .faq-item { 
            transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s, border-color 0.3s, color 0.3s;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .service-card:hover { transform: scale(1.03); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .auction-cta { background-color: #fff; border: 2px solid #f59e0b; }
        .stroy-dom-cta { background-color: #ecfdf5; border: 3px solid #059669; animation: pulse-green 4s infinite; }
        
        @keyframes pulse-green {
            0%, 100% { border-color: #059669; } 
            50% { border-color: #34d399; } 
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –≥–∞–ª–æ—á–∫–∏ —É—Å–ø–µ—Ö–∞ */
        @keyframes checkmark {
            0% { stroke-dashoffset: 100px; }
            100% { stroke-dashoffset: 0; }
        }
        @keyframes checkmark-circle {
            0% { stroke-dashoffset: 480px; }
            100% { stroke-dashoffset: 960px; }
        }
        .success-checkmark { width: 80px; height: 80px; margin: 0 auto; }
        .success-checkmark circle { 
            fill: none; stroke-width: 4; stroke-miterlimit: 10; stroke: #10b981; 
            stroke-dasharray: 480px; stroke-dashoffset: 480px;
            animation: checkmark-circle 0.6s ease-in-out backwards;
        }
        .success-checkmark path { 
            fill: none; stroke-width: 4; stroke-linecap: round; stroke-linejoin: round; stroke: #10b981;
            stroke-dasharray: 100px; stroke-dashoffset: 100px;
            animation: checkmark 0.4s ease-in-out 0.3s backwards;
        }

        /* –ê–ù–ò–ú–ê–¶–ò–Ø –ú–û–†–ì–ê–ù–ò–Ø */
        @keyframes blink-custom {
            0%, 100% { transform: scale(1); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); filter: brightness(1); }
            50% { transform: scale(1.03); box-shadow: 0 0 20px rgba(59, 130, 246, 0.9); filter: brightness(1.2); }
        }
        .blink-btn { animation: blink-custom 1.5s infinite ease-in-out; }
        
        #locationBtn {
            padding: 10px 12px; font-size: 1rem; background-color: #e5e7eb; color: #374151; font-weight: 600;
            border-radius: 8px; transition: background-color 0.2s, color 0.2s;
        }
        #locationBtn:hover { background-color: #d1d5db; }

        .compact-util-btn {
            padding: 12px 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 0.8rem; font-weight: 600; line-height: 1.2;
        }
        .quick-order-btn {
            padding-top: 12px; padding-bottom: 12px; display: flex; flex-direction: column; align-items: center;
            justify-content: center; font-size: 0.875rem; font-weight: 700; 
        }
        
        /* === MODALS (–ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏) === */
        /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ–¥–∏–Ω—ã–π –∫–ª–∞—Å—Å modal-overlay –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–∞–ª–æ–∫ */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center;
            z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;
            backdrop-filter: blur(4px); 
        }
        /* –ö–ª–∞—Å—Å active –≤–∫–ª—é—á–∞–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å */
        .modal-overlay.active { opacity: 1; visibility: visible; }
        
        /* –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–∞–ª–∫–∏ (–ø–æ —Ü–µ–Ω—Ç—Ä—É) */
        .modal {
            background: white; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; 
            overflow-y: auto; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            /* –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –º–∞—Å—à—Ç–∞–±–∞ */
            transform: scale(0.95); 
            transition: transform 0.3s ease, background-color 0.3s;
        }
        .modal-overlay.active .modal {
            transform: scale(1);
        }

        /* === BOTTOM SHEET STYLE FOR MOBILE (FORCE APPLY) === */
        @media (max-width: 768px) {
            .modal-overlay {
                align-items: flex-end !important; /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–∂–∏–º–∞–µ–º –∫ –Ω–∏–∑—É */
            }
            .modal {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                border-bottom-left-radius: 0 !important;
                border-bottom-right-radius: 0 !important;
                border-top-left-radius: 20px !important;
                border-top-right-radius: 20px !important;
                max-height: 85vh !important;
                padding-bottom: env(safe-area-inset-bottom, 20px); /* –£—á–µ—Ç –∑–æ–Ω—ã "–¥–æ–º–æ–π" –Ω–∞ iPhone */
                
                /* –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —Å–ø—Ä—è—Ç–∞–Ω–æ –≤–Ω–∏–∑—É */
                transform: translateY(100%) !important; 
                opacity: 1 !important; 
                transition: transform 0.35s cubic-bezier(0.16, 1, 0.3, 1) !important;
            }
            
            .modal-overlay.active .modal {
                /* –ö–æ–Ω–µ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –≤—ã–µ—Ö–∞–ª–æ –≤–≤–µ—Ä—Ö */
                transform: translateY(0) !important; 
            }
        }

        /* –†—É—á–∫–∞ –¥–ª—è —à—Ç–æ—Ä–∫–∏ */
        .modal-handle {
            width: 48px; height: 5px; background: #9ca3af; /* –ß—É—Ç—å —Ç–µ–º–Ω–µ–µ –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ */
            border-radius: 10px; margin: 12px auto 8px auto;
            display: none; /* –°–∫—Ä—ã—Ç–æ –Ω–∞ –ü–ö */
        }
        @media (max-width: 768px) {
            .modal-handle { display: block !important; } /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        }
        .dark .modal-handle { background: #4b5563; }
        
        .form-input-control {
             padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 8px; width: 100%;
             transition: border-color 0.2s, box-shadow 0.2s; box-sizing: border-box; font-size: 16px; 
        }
        .form-input-control:focus {
            border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); outline: none;
        }
        
        .input-with-plus-btn { display: flex; align-items: center; gap: 8px; }
        .input-with-plus-btn .form-input-control { flex-grow: 1; min-width: 0; }
        
        .geo-btn, .add-stop-btn, .remove-stop-btn {
            flex-shrink: 0; width: 44px; height: 44px; color: white; border-radius: 8px;
            transition: background-color 0.2s, transform 0.2s; display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; cursor: pointer;
        }
        .geo-btn { background-color: #f59e0b; box-shadow: 0 2px 5px rgba(245, 158, 11, 0.5); }
        .add-stop-btn { background-color: #10b981; box-shadow: 0 2px 5px rgba(16, 185, 129, 0.5); }
        .remove-stop-btn { background-color: #ef4444; box-shadow: 0 2px 5px rgba(239, 68, 68, 0.5); }
        
        .wish-tag { transition: all 0.2s ease; user-select: none; }
        .wish-tag:active { transform: scale(0.95); }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∏–ø—Å–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏ –∞–¥—Ä–µ—Å–æ–≤ */
        .history-chips-container {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 4px; padding-top: 4px;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none;  /* IE 10+ */
        }
        .history-chips-container::-webkit-scrollbar { width: 0; height: 0; display: none; }
        
        .history-chip {
            white-space: nowrap; padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;
            background-color: #f3f4f6; color: #4b5563; border: 1px solid #e5e7eb; cursor: pointer;
            transition: all 0.2s; display: flex; align-items: center;
        }
        .history-chip:hover { background-color: #e5e7eb; }
        .history-chip:active { transform: scale(0.95); background-color: #d1d5db; }
        .history-chip i { margin-right: 4px; color: #9ca3af; }

        /* Dark Mode */
        .dark { background-color: #111827; color: #f3f4f6; }
        .dark .header-bg { background: linear-gradient(135deg, rgba(76, 29, 149, 0.95) 0%, rgba(16, 185, 129, 0.95) 100%); }
        .dark .main-card, .dark .service-card, .dark .auction-cta, .dark .stroy-dom-cta, 
        .dark .modal, .dark #faq-accordion > div, .dark .faq-item-content {
            background-color: #1f2937 !important; color: #e5e7eb !important; 
        }
        .dark .text-gray-900, .dark .text-gray-800, .dark .text-gray-700 { color: #d1d5db !important; }
        .dark .text-gray-600 { color: #9ca3af !important; }
        .dark .text-gray-500 { color: #6b7280 !important; }
        .dark .text-blue-900 { color: #93c5fd !important; }
        .dark .border-t, .dark .border, .dark .border-b { border-color: #374151 !important; }
        .dark .main-card { border-color: #059669 !important; }
        .dark .stroy-dom-cta { border-color: #34d399 !important; background-color: #064e3b !important; color: #d1fae5 !important; }
        .dark .form-input-control { background-color: #374151; border-color: #4b5563; color: #f3f4f6; }
        .dark .form-input-control:focus { border-color: #60a5fa; }
        .dark .geo-btn { background-color: #b45309; }
        .dark #locationBtn { background-color: #374151; color: #f3f4f6; border: 1px solid #4b5563; }
        .dark #locationBtn:hover { background-color: #4b5563; }
        .dark .bg-red-100 { background-color: #7f1d1d !important; border-color: #991b1b !important; }
        .dark .text-red-700, .dark .text-red-600 { color: #fca5a5 !important; }
        .dark .bg-blue-50 { background-color: #1e3a8a !important; border-color: #1e40af !important; }
        .dark .border-blue-100, .dark .border-blue-200 { border-color: #1e40af !important; }
        .dark .text-blue-700 { color: #bfdbfe !important; }
        
        /* Dark Mode Chips */
        .dark .history-chip { background-color: #374151; color: #d1d5db; border-color: #4b5563; }
        .dark .history-chip i { color: #6b7280; }
        .dark .history-chip:hover { background-color: #4b5563; }

        /* Split Button */
        .split-btn { display: flex; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .split-btn-part {
            flex: 1; padding: 0.75rem 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: 700; font-size: 1.125rem; transition: background-color 0.2s, transform 0.2s; text-align: center;
            line-height: 1.3; cursor: pointer; border: none;
        }
        .split-btn-part:hover { transform: scale(1.02); }
        .split-btn-taxi { background-color: #10b981; color: white; border-right: 1px solid rgba(255, 255, 255, 0.3); }
        .split-btn-food { background-color: #ef4444; color: white; }
        .dark .split-btn-taxi { background-color: #047857; border-right: 1px solid rgba(255, 255, 255, 0.1); }
        .dark .split-btn-food { background-color: #b91c1c; }

        /* GLASSMORPHISM BOTTOM BAR */
        .bottom-bar-glass {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-top: 1px solid rgba(229, 231, 235, 0.5);
        }
        .dark .bottom-bar-glass {
            background-color: rgba(17, 24, 39, 0.9);
            border-top: 1px solid rgba(55, 65, 81, 0.5);
        }

    </style>
</head>

<body class="text-gray-900 min-h-screen flex flex-col">

    <!-- HEADER -->
    <header class="header-bg text-white py-10 rounded-b-xl shadow-xl relative">
        <div class="absolute top-4 right-4">
            <button id="themeToggle" onclick="toggleTheme()" class="text-white p-2 rounded-full bg-black bg-opacity-10 hover:bg-opacity-30 transition-all focus:outline-none z-50 btn-active">
                <i id="themeIcon" class="fas fa-moon text-xl"></i>
            </button>
        </div>
        <div class="max-w-md mx-auto px-4 text-center">
            <i class="fas fa-taxi text-4xl text-yellow-300 mb-2"></i>
            <h1 class="text-4xl font-extrabold tracking-tight mb-1">–¢–∞–∫—Å–∏ ¬´–£—Å–ø–µ—Ö¬ª</h1>
            <p class="text-white text-lg">–í–∞—à –∫–æ–º—Ñ–æ—Ä—Ç –≤ –ø–æ—Å—ë–ª–∫–µ –ë–µ–ª–æ—É—Å–æ–≤–∫–∞.</p>
        </div>
    </header>

    <!-- –ù–û–í–´–ô –ë–ê–ù–ù–ï–†: –û–ë–™–Ø–í–õ–ï–ù–ò–ï -->
    <div id="announcementBar" class="bg-red-500 text-white p-3 shadow-lg lg:hidden">
        <div class="max-w-3xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <i class="fas fa-exclamation-triangle text-xl"></i>
                <p id="announcementText" class="text-sm font-semibold">
                    –í–Ω–∏–º–∞–Ω–∏–µ! –ò–∑-–∑–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–æ—Å–∞ –Ω–∞ —Ç–∞–∫—Å–∏ –∏–ª–∏ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –≤—Ä–µ–º—è –ø–æ–¥–∞—á–∏ –æ—Ç 15-20 –º–∏–Ω—É—Ç.
                </p>
            </div>
            <button onclick="dismissAnnouncement()" class="text-sm opacity-80 hover:opacity-100 transition btn-active">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    
    <!-- MAIN -->
    <main class="max-w-3xl mx-auto px-4 py-8 flex-grow">
        
        <!-- –ë–õ–û–ö 1: –û–°–ù–û–í–ù–û–ô –ó–ê–ö–ê–ó -->
        <h2 class="text-2xl font-bold text-center mb-6 text-gray-700">–ë—ã—Å—Ç—Ä—ã–π –ó–∞–∫–∞–∑ –¢–∞–∫—Å–∏</h2>
        
        <div class="max-w-md mx-auto p-4 bg-white rounded-xl shadow-xl border-t-4 border-green-500 mb-6 main-card">
            
            <!-- –ö–ù–û–ü–ö–ê 1 (–°–ò–ù–Ø–Ø): –ë–´–°–¢–†–´–ô –ó–ê–ö–ê–ó (–ú–û–î–ê–õ TAXI) -->
            <button data-service="taxi"
                class="service-btn btn-hover btn-active bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-bold transition-all shadow-lg flex items-center justify-center space-x-2 w-full py-3 text-lg mb-3 blink-btn">
                <i class="fas fa-car-side text-lg"></i><span>–ó–∞–∫–∞–∑–∞—Ç—å Taxi</span>
            </button>
            
            <!-- 1. –†–ê–ó–î–ï–õ–ï–ù–ù–ê–Ø –ö–ù–û–ü–ö–ê (–¢–ï–ü–ï–†–¨ –ó–ï–õ–ï–ù–ê–Ø –ö–ù–û–ü–ö–ê –¢–û–ñ–ï –û–¢–ö–†–´–í–ê–ï–¢ –ú–ï–ù–Æ) -->
            <div class="split-btn mb-3">
                <!-- –ó–ï–õ–ï–ù–ê–Ø –ö–ù–û–ü–ö–ê: –û–¢–ö–†–´–í–ê–ï–¢ –ú–ï–ù–Æ –í –†–ï–ñ–ò–ú–ï WHATSAPP -->
                <button onclick="openServicesMenu('whatsapp')"
                    class="btn-hover btn-active split-btn-part split-btn-taxi">
                    <span>–ú–µ–Ω—é —É—Å–ª—É–≥</span>
                </button>
                
                <!-- –ö–ù–û–ü–ö–ê –ï–î–ê: –í–ù–ï–®–ù–Ø–Ø –°–°–´–õ–ö–ê -->
                <a href="https://taxiuspeh.github.io/landing-/SHASHDVOR.html" target="_blank"
                    class="btn-hover btn-active split-btn-part split-btn-food">
                    <span>–ó–∞–∫–∞–∑ –ï–¥—ã</span>
                </a>
            </div>
            
            <!-- 2. –ë–õ–û–ö –ë–´–°–¢–†–´–• –î–ï–ô–°–¢–í–ò–ô (–û–ë–ù–û–í–õ–ï–ù: –ü–û–î–ï–õ–ò–¢–¨–°–Ø –í–ú–ï–°–¢–û –ó–í–û–ù–ö–ê) -->
            <div class="grid grid-cols-3 gap-2 mb-4">
                <!-- –ö–Ω–æ–ø–∫–∞ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è (–í–ú–ï–°–¢–û –ó–í–û–ù–ö–ê) -->
                <button onclick="shareApp()" 
                    class="btn-hover btn-active bg-green-500 hover:bg-green-600 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fas fa-share-alt mb-0.5"></i><span>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                </button>
                
                <!-- TELEGRAM: –û–¢–ö–†–´–í–ê–ï–¢ –ú–ï–ù–Æ –í –†–ï–ñ–ò–ú–ï TELEGRAM -->
                <button onclick="openServicesMenu('telegram')"
                    class="btn-hover btn-active bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fab fa-telegram-plane mb-0.5"></i><span>Telegram</span>
                </button>
                
                <!-- –ê—É–∫—Ü–∏–æ–Ω -->
                <button data-service="auction"
                    class="service-btn btn-hover btn-active bg-yellow-500 hover:bg-yellow-600 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fas fa-gavel mb-0.5"></i><span>–ê—É–∫—Ü–∏–æ–Ω</span>
                </button>
            </div>
            
            <!-- –ë–õ–û–ö –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
            <button type="button" onclick="getCurrentLocation('main')" id="locationBtn"
                class="w-full text-gray-700 font-semibold transition flex items-center justify-center space-x-3 shadow-inner btn-active">
                <i class="fas fa-location-arrow"></i>
                <span id="locationBtnText">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</span>
            </button>
            <p id="locationResult" class="text-xs text-center text-gray-500 mt-2 hidden">
                <a id="locationAddress" href="#" target="_blank" class="coord-link"></a>
            </p>
            
            <!-- –°–ü–û–°–û–ë–´ –û–ü–õ–ê–¢–´ -->
            <div class="mt-4 pt-3 border-t border-gray-100 flex justify-center space-x-6 text-gray-600">
                <div class="flex items-center space-x-1">
                    <i class="fas fa-money-bill-wave text-xl text-green-500"></i>
                    <span class="font-semibold text-xs">–ù–∞–ª–∏—á–Ω—ã–µ</span>
                </div>
                <div class="flex items-center space-x-1">
                    <i class="fas fa-exchange-alt text-xl text-blue-500"></i>
                    <span class="font-semibold text-xs">–ü–µ—Ä–µ–≤–æ–¥ (Kaspi)</span>
                </div>
            </div>
            
        </div>
        
        <!-- –ë–õ–û–ö 2: –ú–ê–ì–ê–ó–ò–ù "–°–¢–†–û–ô –î–û–ú" -->
        <div class="mt-8 pt-4">
            <h3 class="text-2xl font-extrabold text-center mb-4 text-green-700">
                üõ†Ô∏è –°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã –ë–µ–ª–æ—É—Å–æ–≤–∫–∞
            </h3>
            <div class="stroy-dom-cta p-5 rounded-2xl flex flex-col sm:flex-row items-center justify-between text-blue-900 font-extrabold transition-all duration-300">
                <div class="flex flex-col items-center sm:items-start text-center sm:text-left mb-3 sm:mb-0">
                    <i class="fas fa-building text-4xl mb-1 text-emerald-600"></i>
                    <span class="text-2xl block leading-tight font-black text-emerald-800">–°–¢–†–û–ô –î–û–ú</span>
                    <span class="text-base text-gray-700 block mt-1">
                        –ú–∞–≥–∞–∑–∏–Ω —Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: <span class="font-bold">—É–ª. –Æ–±–∏–ª–µ–π–Ω–∞—è, 10</span>
                    </span>
                    <span class="text-sm text-gray-700 block mt-1">
                        –¢–µ–ª–µ—Ñ–æ–Ω: <a href="tel:+77764764606" class="text-blue-600 hover:text-blue-800 font-bold">+7 776 476 4606</a>
                    </span>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0">
                    <a href="https://wa.me/77764764606?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–ò–Ω—Ç–µ—Ä–µ—Å—É—é—Ç%20—Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã%20–≤%20–º–∞–≥–∞–∑–∏–Ω–µ%20%22–°—Ç—Ä–æ–π%20–î–æ–º%22%20–ø–æ%20–∞–¥—Ä–µ—Å—É%20–Æ–±–∏–ª–µ–π–Ω–∞—è%2010." target="_blank"
                       class="bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fab fa-whatsapp mr-2"></i> WhatsApp
                    </a>
                    <a href="https://yandex.kz/maps/-/CLgm7KK9" target="_blank"
                       class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fas fa-map-marked-alt mr-2"></i> –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
                    </a>
                    <a href="https://www.instagram.com/stroy_dom_bk" target="_blank"
                       class="bg-pink-600 hover:bg-pink-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fab fa-instagram mr-2"></i> Instagram
                    </a>
                </div>
            </div>
        </div>
        
        <!-- –ë–õ–û–ö 3: –ù–ê–®–ò –£–°–õ–£–ì–ò -->
        <h3 class="text-2xl font-bold text-center mb-6 text-gray-700 border-t pt-8 mt-8">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –£—Å–ª—É–≥–∏ (–§–æ—Ä–º–∞)</h3>
        
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 max-w-md mx-auto mb-8">
            <button data-service="delivery"
                class="service-btn btn-active service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-green-500">
                <i class="fas fa-box-open text-2xl mb-1 text-green-600"></i><span class="text-sm">–î–æ—Å—Ç–∞–≤–∫–∞</span>
            </button>
            <button data-service="cargo"
                class="service-btn btn-active service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-yellow-500">
                <i class="fas fa-truck-loading text-2xl mb-1 text-yellow-600"></i><span class="text-sm">–ì—Ä—É–∑–æ–≤–æ–π</span>
            </button>
            <button data-service="soberDriver"
                class="service-btn btn-active service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-red-500">
                <i class="fas fa-cocktail text-2xl mb-1 text-red-600"></i><span class="text-sm">–¢—Ä–µ–∑–≤—ã–π –≤–æ–¥–∏—Ç–µ–ª—å</span>
            </button>
            <button data-service="assistance"
                class="service-btn btn-active service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-indigo-500">
                <i class="fas fa-life-ring text-2xl mb-1 text-indigo-600"></i><span class="text-sm">–ü–æ–º–æ—â—å</span>
            </button>
        </div>


        <!-- –ë–õ–û–ö 4: –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø (–û–ë–ù–û–í–õ–ï–ù: –£–ë–†–ê–õ –î–£–ë–õ–¨ –ü–û–î–ï–õ–ò–¢–¨–°–Ø, –î–û–ë–ê–í–ò–õ PWA –í –°–ï–¢–ö–£) -->
        <h3 class="text-xl font-bold text-center mb-4 text-gray-700 border-t pt-4">–ë—ã—Å—Ç—Ä—ã–µ –î–µ–π—Å—Ç–≤–∏—è</h3>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 max-w-md mx-auto mb-8">
            <a href="https://wa.me/77770649648?text=–û—Ü–µ–Ω–∏—Ç–µ%20—Ä–∞–±–æ—Ç—É%20—Ç–∞–∫—Å–∏%20%C2%AB–£—Å–ø–µ—Ö%C2%BB%20–ø–æ%20—à–∫–∞–ª–µ%20–æ—Ç%201%20(–ü–ª–æ—Ö–æ)%20–¥–æ%205%20(–û—Ç–ª–∏—á–Ω–æ)." target="_blank"
                class="btn-hover btn-active bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-star text-xl mb-1"></i><span>–û—Ü–µ–Ω–∫–∞</span>
            </a>
            <a href="https://wa.me/77770649648?text=–ü—Ä–æ—à—É%20–ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å%20–º–Ω–µ%20–∫–∞–∫%20–º–æ–∂–Ω–æ%20—Å–∫–æ—Ä–µ–µ!" target="_blank"
                class="btn-hover btn-active bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-headset text-xl mb-1"></i><span>–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å</span>
            </a>
            
            <button onclick="showPartnerModal()" 
                class="btn-hover btn-active bg-pink-600 hover:bg-pink-700 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-handshake text-xl mb-1"></i><span>–ü–∞—Ä—Ç–Ω–µ—Ä—ã</span>
            </button>
            
            <button onclick="showPWAInstructions()" 
                class="btn-hover btn-active bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-mobile-alt text-xl mb-1"></i><span>–ù–∞ —ç–∫—Ä–∞–Ω</span>
            </button>
        </div>


        <!-- –ë–õ–û–ö 5: –¢–µ—Ö–û—Å–º–æ—Ç—Ä -->
        <div class="mt-8 border-t pt-6">
            <h3 class="text-xl font-bold text-center mb-4 text-gray-700">–ù–∞—à–∏–º –ü–∞—Ä—Ç–Ω–µ—Ä–∞–º: –¢–µ—Ö–û—Å–º–æ—Ç—Ä</h3>
            <div class="auction-cta p-5 rounded-2xl flex flex-col sm:flex-row items-center justify-between text-blue-900 font-extrabold transition-all duration-300 border-indigo-500 border-2">
                <div class="flex flex-col items-center sm:items-start text-center sm:text-left mb-3 sm:mb-0">
                    <i class="fas fa-wrench text-3xl mb-1 text-red-600"></i>
                    <span class="text-xl block leading-tight font-black text-red-600">–¢–ï–•–û–°–ú–û–¢–† –í –ë–ï–õ–û–£–°–û–í–ö–ï!</span>
                    <span class="text-sm text-gray-700 block mt-1">
                        –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¢–û: <span class="font-bold">—É–ª. –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è, 37</span>
                    </span>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0">
                    <a href="https://wa.me/77771383856?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20–∑–∞–ø–∏—Å–∞—Ç—å—Å—è%20–Ω–∞%20–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π%20–û—Å–º–æ—Ç—Ä%20–ø–æ%20–∞–¥—Ä–µ—Å—É%20–ú–æ–ª–æ–¥–µ–∂–Ω–∞—è%2037." target="_blank"
                       class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fab fa-whatsapp mr-2"></i> WhatsApp
                    </a>
                    <a href="https://yandex.kz/navi/-/CLGK5Sli" target="_blank"
                       class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fas fa-map-marked-alt mr-2"></i> –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
                    </a>
                    <a href="tel:+77771383856"
                       class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center btn-active">
                        <i class="fas fa-phone-alt mr-2"></i> –ó–≤–æ–Ω–æ–∫
                    </a>
                </div>
            </div>
        </div>

        
        <!-- –ë–õ–û–ö 6: FAQ –∏ –ü–†–ê–ô–°-–õ–ò–°–¢ -->
        <div class="mt-10 border-t pt-6 max-w-lg mx-auto">
            <h3 class="text-2xl font-bold text-center text-gray-700 mb-6">–í–æ–ø—Ä–æ—Å—ã –∏ –¶–µ–Ω—ã</h3>
            
            <div id="faq-accordion" class="space-y-4">
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-1')">
                        <span>üí∞ –ö–∞–∫–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏?</span>
                        <i id="icon-faq-1" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-1" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏ –ø–æ –ë–µ–ª–æ—É—Å–æ–≤–∫–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç **700 —Ç–µ–Ω–≥–µ**. –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ —Ç–µ–∫—É—â–µ–π –¥–æ—Ä–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.</p>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-4')">
                        <span>üì¶ –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —É—Å–ª—É–≥–∞ –î–æ—Å—Ç–∞–≤–∫–∏?</span>
                        <i id="icon-faq-4" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-4" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è **–æ—Ç 1200 KZT**.</p>
                        <p class="mt-2 text-sm italic">–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—â–µ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –æ–±—ä—ë–º–∞ –ø–æ–∫—É–ø–æ–∫.</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-2')">
                        <span>‚è∞ –ö–∞–∫–æ–π —É –≤–∞—Å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã?</span>
                        <i id="icon-faq-2" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-2" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>**–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ (24/7)**, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —É–µ—Ö–∞—Ç—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –¥–Ω—è –∏ –Ω–æ—á–∏.</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-3')">
                        <span>üìç –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ –ú–µ–∂–≥–æ—Ä–æ–¥ –∏ –ø—Ä–∏–≥–æ—Ä–æ–¥</span>
                        <i id="icon-faq-3" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-3" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p class="font-bold text-red-600 mb-2">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –¶–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ!</p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>**–ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:** **230 ‚Ç∏** –∑–∞ 1 –∫–º.</li>
                            <li>–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫: **4800‚Äî6210 ‚Ç∏**</li>
                            <li>–ì–ª—É–±–æ–∫–æ–µ: **–æ—Ç 4200 ‚Ç∏**</li>
                            <li>–ù–æ–≤–∞—è –ë—É—Ö—Ç–∞—Ä–º–∞: **–æ—Ç 24150 ‚Ç∏**</li>
                            <li>–†–∏–¥–¥–µ—Ä: **–æ—Ç 25300 ‚Ç∏**</li>
                            <li>–®–µ–º–æ–Ω–∞–∏—Ö–∞: **–æ—Ç 20700 ‚Ç∏**</li>
                            <li>–ê–ª—Ç–∞–π (–ó—ã—Ä—è–Ω–æ–≤—Å–∫): **–æ—Ç 45540 ‚Ç∏**</li>
                            <li>–£—Å—Ç—å-–¢–∞–ª–æ–≤–∫–∞: **–æ—Ç 19780 ‚Ç∏**</li>
                            <li>–°–µ–∫–∏—Å–æ–≤–∫–∞: **–æ—Ç 6440 ‚Ç∏**</li>
                            <li>–ë–µ–ª–æ–∫–∞–º–µ–Ω–∫–∞: **–æ—Ç 3500 ‚Ç∏**</li>
                            <li>–ú–∏—Ö–∞–π–ª–æ–≤–∫–∞: **–æ—Ç 4000 ‚Ç∏**</li>
                            <li>–ü—Ä–æ–≥—Ä–µ—Å—Å: **2990‚Äî3500 ‚Ç∏**</li>
                            <li>–ß–µ—Ä–Ω–æ–≥–æ—Ä–∫–∞: **2100‚Äî3000 ‚Ç∏**</li>
                            <li>–ö—Ä–∞—Å–Ω—ã–π –ü–∞—Ä—Ç–∏–∑–∞–Ω: **1800‚Äî2500 ‚Ç∏**</li>
                            <li>–ü–ª–∞–Ω–∏–¥–æ–≤–∫–∞: **2100‚Äî2500 ‚Ç∏**</li>
                            <li>–¢–∞—Ä—Ö–∞–Ω–∫–∞: **11270‚Äî12200 ‚Ç∏**</li>
                            <li>–ü—Ä–µ–¥–≥–æ—Ä–Ω–æ–µ: **8500‚Äî10000 ‚Ç∏**</li>
                            <li>–ø–æ—Å—ë–ª–æ–∫ –ê–ª—Ç–∞–π—Å–∫–∏–π: **6000‚Äî8000 ‚Ç∏**</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ë–õ–û–ö 7: –†–ï–ö–õ–ê–ú–ê –î–õ–Ø –ü–ê–†–¢–ù–ï–†–û–í -->
        <div class="mt-10 border-t pt-6">
            <h3 class="text-xl font-bold text-pink-600 mb-6 text-center">üì¢ –†–µ–∫–ª–∞–º–∞ –¥–ª—è –í–∞—à–µ–≥–æ –ë–∏–∑–Ω–µ—Å–∞</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20—Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å%20—Ä–µ–∫–ª–∞–º—É%20—Å–≤–æ–µ–≥–æ%20–º–∞–≥–∞–∑–∏–Ω–∞%20(–ü—Ä–æ–¥—É–∫—Ç—ã/–û–¥–µ–∂–¥–∞)." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-pink-500 flex flex-col items-center text-center">
                    <i class="fas fa-store text-4xl text-pink-500 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–ú–∞–≥–∞–∑–∏–Ω –∏–ª–∏ –¢–æ—á–∫–∞ –ü—Ä–æ–¥–∞–∂</p>
                    <p class="text-sm text-gray-600">–ü—Ä–∏–≤–ª–µ–∫–∞–π—Ç–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∫ –≤–∞—à–µ–º—É —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É. **(WhatsApp)**</p>
                </a>
                <a href="https://wa.me/77770649648?text=–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç%20—Ä–µ–∫–ª–∞–º–∞%20–º–æ–∏—Ö%20—É—Å–ª—É–≥%20(–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫/–†–µ–º–æ–Ω—Ç).%20–ü—Ä–∏—à–ª–∏—Ç–µ%20—É—Å–ª–æ–≤–∏—è." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-red-500 flex flex-col items-center text-center">
                    <i class="fas fa-tools text-4xl text-red-500 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–£—Å–ª—É–≥–∏, –°–µ—Ä–≤–∏—Å –∏–ª–∏ –ú–∞—Å—Ç–µ—Ä</p>
                    <p class="text-sm text-gray-600">–ù–∞–π–¥–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–µ–º–æ–Ω—Ç, –¥–æ—Å—Ç–∞–≤–∫—É –∏–ª–∏ –±—ã—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏. **(–£–∑–Ω–∞—Ç—å —Ü–µ–Ω—É)**</p>
                </a>
                <a href="https://wa.me/77770649648?text=–•–æ—á—É%20–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å%20–º–µ—Å—Ç–æ%20–¥–ª—è%20—Ä–µ–∫–ª–∞–º—ã%20–≥–æ—Ä—è—á–∏—Ö%20–∞–∫—Ü–∏–π." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-yellow-600 flex flex-col items-center text-center">
                    <i class="fas fa-bullhorn text-4xl text-yellow-600 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–ì–æ—Ä—è—á–∞—è –ê–∫—Ü–∏—è / –û–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
                    <p class="text-sm text-gray-600">–ú–µ—Å—Ç–æ –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –∏–ª–∏ —Å–µ–∑–æ–Ω–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π. **(–°–≤—è–∑–∞—Ç—å—Å—è)**</p>
                </a>
            </div>
        </div>
        
        <!-- –ë–õ–û–ö 8: –ü–†–ò–ì–õ–ê–®–ï–ù–ò–ï –í–û–î–ò–¢–ï–õ–ï–ô -->
        <div class="mt-10 border-t pt-6 text-center">
            <h3 class="text-2xl font-bold text-gray-700 mb-4">–ü—Ä–∏–≥–ª–∞—à–∞–µ–º –í–æ–¥–∏—Ç–µ–ª–µ–π –≤ –∫–æ–º–∞–Ω–¥—É!</h3>
            <p class="text-gray-600 mb-4 max-w-md mx-auto">
                –•–æ—Ç–∏—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –∏ –±—ã—Ç—å —á–∞—Å—Ç—å—é —É—Å–ø–µ—à–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ –ë–µ–ª–æ—É—Å–æ–≤–∫–µ?
            </p>
            <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20—Å—Ç–∞—Ç—å%20–≤–æ–¥–∏—Ç–µ–ª–µ–º%20—Ç–∞–∫—Å–∏%20%C2%AB–£—Å–ø–µ—Ö%C2%BB.%20–£–∫–∞–∂–∏—Ç–µ%2C%20–ø–æ–∂–∞–ª—É–π—Å—Ç–∞%2C%20—É—Å–ª–æ–≤–∏—è%20–∏%20—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è." target="_blank"
               class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg transition-all btn-hover btn-active">
                <i class="fas fa-car-side mr-2"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ó–∞—è–≤–∫—É –í–æ–¥–∏—Ç–µ–ª—è
            </a>
            <p class="text-sm text-gray-500 mt-4">
                –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ WhatsApp, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –≤—Å–µ —É—Å–ª–æ–≤–∏—è.
            </p>
        </div>
        
        <!-- –ë–õ–û–ö 9: –í—Ö–æ–¥ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è -->
        <div class="mt-6 border-t pt-6 text-center">
            <h3 class="text-xl font-bold text-gray-700 mb-4">–î–ª—è –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π</h3>
            <a href="https://chat.whatsapp.com/Ke2bt9sD8VfCFmZ1LeEcqe" target="_blank"
               class="inline-block bg-pink-600 hover:bg-pink-700 text-white px-8 py-3 rounded-xl text-lg font-semibold shadow-lg transition-all btn-active">
                <i class="fas fa-user-shield mr-2"></i> –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –í–æ–¥–∏—Ç–µ–ª—è
            </a>
            <p class="text-sm text-gray-500 mt-2">
                –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞–∫—Ä—ã—Ç—É—é –≥—Ä—É–ø–ø—É –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–∫–∞–∑–æ–≤.
            </p>
        </div>
        
    </main>

    <!-- –ù–∞–≤–∏–≥–∞—Ç–æ—Ä -->
    <section class="bg-blue-700 py-6 text-center mt-10 shadow-inner">
        <h3 class="text-xl font-bold text-white mb-3">üó∫ –û—Ç–∫—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å.–ù–∞–≤–∏–≥–∞—Ç–æ—Ä</h3>
        <a href="https://yandex.kz/navi" target="_blank"
            class="inline-block bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-3 rounded-xl text-lg font-semibold shadow-lg transition-all btn-active">
            <i class="fas fa-location-arrow mr-2"></i> –û—Ç–∫—Ä—ã—Ç—å –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
        </a>
    </section>

    <!-- –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ô –ù–ò–ñ–ù–ò–ô –ë–ê–† (–î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–•) -->
    <!-- –î–û–ë–ê–í–õ–ï–ù –ö–õ–ê–°–° bottom-bar-glass –î–õ–Ø –≠–§–§–ï–ö–¢–ê –°–¢–ï–ö–õ–ê -->
    <div class="fixed bottom-0 left-0 right-0 bottom-bar-glass shadow-2xl z-40 sm:hidden">
        <div class="flex justify-around items-center h-16">
            <a href="https://wa.me/77770649648?text=%5B–ê–¥—Ä–µ—Å%20–û–¢–ö–£–î–ê%5D%20-%20%5B–ê–¥—Ä–µ—Å%20–ö–£–î–ê%5D." class="flex flex-col items-center text-green-600 hover:text-green-700 btn-active p-1 rounded-lg">
                <i class="fab fa-whatsapp text-2xl"></i><span class="text-xs mt-0.5">–ó–∞–∫–∞–∑</span>
            </a>
            <a href="tel:+77770649648" class="flex flex-col items-center text-red-600 hover:text-red-700 btn-active p-1 rounded-lg">
                <i class="fas fa-phone-alt text-2xl"></i><span class="text-xs mt-0.5">–ó–≤–æ–Ω–æ–∫</span>
            </a>
            <a data-service="delivery" class="service-btn flex flex-col items-center text-yellow-600 hover:text-yellow-700 btn-active p-1 rounded-lg">
                <i class="fas fa-box-open text-2xl"></i><span class="text-xs mt-0.5">–î–æ—Å—Ç–∞–≤–∫–∞</span>
            </a>
            <a href="https://chat.whatsapp.com/Ke2bt9sD8VfCFmZ1LeEcqe" target="_blank" class="flex flex-col items-center text-pink-600 hover:text-pink-700 btn-active p-1 rounded-lg">
                <i class="fas fa-user-shield text-2xl"></i><span class="text-xs mt-0.5">–í–æ–¥–∏—Ç–µ–ª—å</span>
            </a>
        </div>
    </div>


    <!-- FOOTER -->
    <footer class="bg-gray-800 text-white text-center py-6 mt-10">
        <p class="text-sm px-4">
            <span class="font-bold">¬© 2025 ¬´–£—Å–ø–µ—Ö –¢–∞–∫—Å–∏¬ª</span>. 
            ¬´—Ç–∞–∫—Å–∏ –£—Å–ø–µ—Ö¬ª ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å. 
        </p>
        <p class="text-sm mt-2">
            –°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤–æ—Å—Ç—è–º–∏:
            <a href="https://whatsapp.com/channel/0029VajWGmEI1rcfICmXlJ01" class="text-green-400 hover:text-green-300 underline">WhatsApp-–∫–∞–Ω–∞–ª</a>
        </p>
    </footer>

    <!-- ========================================================= -->
    <!-- –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–û–ï –ú–ï–ù–Æ –£–°–õ–£–ì (–î–õ–Ø WHATSAPP –ò TELEGRAM) -->
    <!-- ========================================================= -->
    <div id="servicesMenuModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üìã –í—Å–µ —É—Å–ª—É–≥–∏ Taxi ¬´–£—Å–ø–µ—Ö¬ª</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="servicesMenuModal">√ó</button>
                </div>
                
                <p class="text-gray-600 mb-4 text-center">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:</p>
                
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <!-- –¢–∞–∫—Å–∏ -->
                    <button onclick="openServiceFromMenu('taxi')" 
                        class="p-4 bg-blue-50 hover:bg-blue-100 rounded-xl border border-blue-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-car-side text-2xl text-blue-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–¢–∞–∫—Å–∏</span>
                    </button>
                    <!-- –ê—É–∫—Ü–∏–æ–Ω -->
                    <button onclick="openServiceFromMenu('auction')"
                        class="p-4 bg-yellow-50 hover:bg-yellow-100 rounded-xl border border-yellow-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-gavel text-2xl text-yellow-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–ê—É–∫—Ü–∏–æ–Ω</span>
                    </button>
                    <!-- –î–æ—Å—Ç–∞–≤–∫–∞ -->
                    <button onclick="openServiceFromMenu('delivery')"
                        class="p-4 bg-green-50 hover:bg-green-100 rounded-xl border border-green-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-box-open text-2xl text-green-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–î–æ—Å—Ç–∞–≤–∫–∞</span>
                    </button>
                    <!-- –ì—Ä—É–∑–æ–≤–æ–π -->
                    <button onclick="openServiceFromMenu('cargo')"
                        class="p-4 bg-orange-50 hover:bg-orange-100 rounded-xl border border-orange-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-truck-loading text-2xl text-orange-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–ì—Ä—É–∑–æ–≤–æ–π</span>
                    </button>
                    <!-- –¢—Ä–µ–∑–≤—ã–π –≤–æ–¥–∏—Ç–µ–ª—å -->
                    <button onclick="openServiceFromMenu('soberDriver')"
                        class="p-4 bg-red-50 hover:bg-red-100 rounded-xl border border-red-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-cocktail text-2xl text-red-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–¢—Ä–µ–∑–≤—ã–π –≤–æ–¥–∏—Ç–µ–ª—å</span>
                    </button>
                    <!-- –ü–æ–º–æ—â—å -->
                    <button onclick="openServiceFromMenu('assistance')"
                        class="p-4 bg-indigo-50 hover:bg-indigo-100 rounded-xl border border-indigo-200 flex flex-col items-center text-center transition btn-active">
                        <i class="fas fa-life-ring text-2xl text-indigo-600 mb-2"></i>
                        <span class="font-bold text-gray-800 text-sm">–ü–æ–º–æ—â—å</span>
                    </button>
                </div>
                
                <!-- FOOTER: –¢–û–õ–¨–ö–û –î–õ–Ø TELEGRAM –†–ï–ñ–ò–ú–ê -->
                <div id="servicesMenuFooter" class="border-t pt-4 text-center hidden">
                    <p class="text-sm text-gray-500 mb-2">–•–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª?</p>
                    <a href="https://t.me/TaxiUspehk" target="_blank" 
                       class="inline-block bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow transition btn-active">
                        <i class="fab fa-telegram-plane mr-2"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- ========================================================= -->


    <!-- 1. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –¢–ê–ö–°–ò -->
    <div id="taxiModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üöï –ó–∞–∫–∞–∑–∞—Ç—å –¢–∞–∫—Å–∏</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="taxiModal">√ó</button>
                </div>
                <form id="taxiForm" class="space-y-4">
                    <div id="addressInputsTaxi">
                        <div class="flex flex-col">
                            <label for="taxiFrom" class="text-sm font-medium text-gray-700 mb-1">–û—Ç–∫—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="taxiFrom" name="from" type="text" list="fromHistory" autocomplete="off" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required oninput="updateTaxiPrice()">
                                <datalist id="fromHistory"></datalist>
                                <button type="button" onclick="getCurrentLocation('taxi')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="taxiGeoIcon" class="fas fa-compass"></i></button>
                            </div>
                            <!-- –ù–û–í–û–ï: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —á–∏–ø—Å–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏ -->
                            <div id="taxiHistoryChips" class="history-chips-container mt-2"></div>
                        </div>
                        
                        <!-- 1. –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê: –ü–û–ú–ï–ù–Ø–¢–¨ –ú–ï–°–¢–ê–ú–ò -->
                        <div class="relative flex justify-center -my-3 z-10">
                             <button type="button" onclick="swapTaxiAddresses()" class="bg-gray-200 hover:bg-gray-300 text-gray-600 rounded-full p-2 shadow-md border border-white transition transform hover:rotate-180 focus:outline-none btn-active" title="–ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏">
                                <i class="fas fa-exchange-alt rotate-90"></i>
                             </button>
                        </div>
                        
                        <div class="flex flex-col">
                            <label for="taxiTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="taxiTo" name="to" type="text" list="toHistory" autocomplete="off" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º/–æ–±—ä–µ–∫—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required oninput="updateTaxiPrice()">
                                <datalist id="toHistory"></datalist>
                                <button type="button" onclick="addStop('additionalStops', 'taxi')" class="add-stop-btn btn-active" title="–î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å"><i class="fas fa-plus"></i></button>
                            </div>
                            <div id="additionalStops" class="mt-2 space-y-2" oninput="updateTaxiPrice()"></div>
                        </div>
                    </div>
                    
                    <div class="border border-blue-200 rounded-lg overflow-hidden">
                        <button type="button" onclick="togglePreorder()" class="w-full p-3 bg-blue-50 flex justify-between items-center text-left focus:outline-none btn-active">
                            <span class="text-sm font-bold text-blue-700 flex items-center"><i class="fas fa-calendar-alt mr-2"></i> –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å (–ü—Ä–µ–¥–∑–∞–∫–∞–∑)</span>
                            <i id="preorderIcon" class="fas fa-chevron-down text-blue-500 transition-transform duration-300"></i>
                        </button>
                        <div id="preorderContent" class="hidden p-3 bg-white border-t border-blue-100 space-y-3">
                            <div class="flex flex-col">
                                <label for="taxiDateTime" class="text-xs font-medium text-gray-600 mb-1">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏</label>
                                <input id="taxiDateTime" name="dateTime" type="datetime-local" class="form-input-control">
                            </div>
                            <div class="flex flex-col">
                                <label for="taxiWishes" class="text-xs font-medium text-gray-600 mb-1">–ü–æ–∂–µ–ª–∞–Ω–∏—è</label>
                                <textarea id="taxiWishes" name="wishes" rows="2" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù—É–∂–Ω–æ –¥–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ, –º–∞—à–∏–Ω–∞ –ø–æ–±–æ–ª—å—à–µ."></textarea>
                                
                                <!-- 2. –ù–û–í–´–ï –ë–´–°–¢–†–´–ï –¢–ï–ì–ò -->
                                <div class="flex flex-wrap gap-2 mt-2">
                                    <button type="button" onclick="addWish('–î–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ')" class="wish-tag px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full border hover:bg-blue-100 hover:border-blue-300 transition">üë∂ –î–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ</button>
                                    <button type="button" onclick="addWish('–ü—É—Å—Ç–æ–π –±–∞–≥–∞–∂–Ω–∏–∫')" class="wish-tag px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full border hover:bg-blue-100 hover:border-blue-300 transition">üß≥ –ü—É—Å—Ç–æ–π –±–∞–≥–∞–∂–Ω–∏–∫</button>
                                    <button type="button" onclick="addWish('–° –∂–∏–≤–æ—Ç–Ω—ã–º')" class="wish-tag px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full border hover:bg-blue-100 hover:border-blue-300 transition">üêï –° –∂–∏–≤–æ—Ç–Ω—ã–º</button>
                                    <button type="button" onclick="addWish('–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä')" class="wish-tag px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full border hover:bg-blue-100 hover:border-blue-300 transition">‚ùÑÔ∏è –ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä</button>
                                    <button type="button" onclick="addWish('–°–¥–∞—á–∞ —Å 5000/10000')" class="wish-tag px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full border hover:bg-blue-100 hover:border-blue-300 transition">üíµ –°–¥–∞—á–∞</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col">
                        <label for="passengerPhone" class="text-sm font-medium text-gray-700 mb-1">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏ (–ø–∞—Å—Å–∞–∂–∏—Ä–∞)</label>
                        <input id="passengerPhone" name="passengerPhone" type="tel" pattern="[0-9+() -]*" class="form-input-control" placeholder="+7 (XXX) XXX-XX-XX">
                    </div>

                    <div id="taxiStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div id="taxiPriceEstimate" class="price-estimate">–æ—Ç 700‚Äì900 —Ç–≥</div>
                            <div class="price-note text-red-600 font-semibold">–í–Ω–∏–º–∞–Ω–∏–µ: —Ç–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–æ–¥–∏—Ç–µ–ª–µ–º.</div>
                        </div>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–ó–∞–∫–∞–∑–∞—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 2. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –î–û–°–¢–ê–í–ö–ê -->
    <div id="deliveryModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üõçÔ∏è –î–æ—Å—Ç–∞–≤–∫–∞ –¢–æ–≤–∞—Ä–æ–≤</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="deliveryModal">√ó</button>
                </div>
                <form id="deliveryForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="deliveryItems" class="text-sm font-medium text-gray-700 mb-1">–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ *</label>
                        <textarea id="deliveryItems" name="items" rows="3" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ö–ª–µ–±, –ø–∏–≤–æ, –æ–≥—É—Ä—Ü—ã 1 –∫–≥" required></textarea>
                    </div>
                    <div class="flex flex-col">
                        <label for="deliveryStore" class="text-sm font-medium text-gray-700 mb-1">–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –º–∞–≥–∞–∑–∏–Ω—É</label>
                        <input id="deliveryStore" name="store" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞–≥–∞–∑–∏–Ω ‚Ññ1, –°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç" />
                    </div>
                    <div class="flex flex-col">
                        <label for="deliveryAddress" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                        <div class="input-with-plus-btn">
                            <input id="deliveryAddress" name="address" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞" required />
                            <button type="button" onclick="getCurrentLocation('delivery')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="deliveryGeoIcon" class="fas fa-compass"></i></button>
                        </div>
                    </div>
                    <div id="deliveryStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>
                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate">–æ—Ç 1200 —Ç–≥</div>
                        </div>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 3. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ì–†–£–ó–û–í–û–ô -->
    <div id="cargoModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üöö –ì—Ä—É–∑–æ–≤—ã–µ –ü–µ—Ä–µ–≤–æ–∑–∫–∏</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="cargoModal">√ó</button>
                </div>
                <form id="cargoForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="cargoFrom" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏ *</label>
                        <div class="input-with-plus-btn">
                            <input id="cargoFrom" name="from" type="text" class="form-input-control" placeholder="–û—Ç–∫—É–¥–∞ –∑–∞–±—Ä–∞—Ç—å –≥—Ä—É–∑" required>
                            <button type="button" onclick="getCurrentLocation('cargo')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="cargoGeoIcon" class="fas fa-compass"></i></button>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="cargoTo" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –≤—ã–≥—Ä—É–∑–∫–∏ *</label>
                        <input id="cargoTo" name="to" type="text" class="form-input-control" placeholder="–ö—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä—É–∑" required>
                    </div>
                    <div class="flex flex-col">
                        <label for="cargoDescription" class="text-sm font-medium text-gray-700 mb-1">–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–∑–∞ *</label>
                        <textarea id="cargoDescription" name="description" rows="2" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1 —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ –∏ 5 –∫–æ—Ä–æ–±–æ–∫" required></textarea>
                    </div>
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg space-y-3">
                        <p class="text-sm font-bold text-blue-700 flex items-center"><i class="fas fa-calendar-alt mr-2"></i> –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å (–ü—Ä–µ–¥–∑–∞–∫–∞–∑)</p>
                        <div class="flex flex-col">
                            <label for="cargoDateTime" class="text-xs font-medium text-gray-600 mb-1">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–≥—Ä—É–∑–∫–∏</label>
                            <input id="cargoDateTime" name="dateTime" type="datetime-local" class="form-input-control">
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="cargoMovers" class="text-sm font-medium text-gray-700 mb-1">–ì—Ä—É–∑—á–∏–∫–∏</label>
                        <div class="input-with-plus-btn">
                            <select id="cargoMovers" name="movers" class="form-input-control" required onchange="updateCargoPrice()">
                                <option value="0">–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è</option>
                                <option value="1">1 —á–µ–ª–æ–≤–µ–∫</option>
                                <option value="2">2 —á–µ–ª–æ–≤–µ–∫–∞</option>
                                <option value="3">3 —á–µ–ª–æ–≤–µ–∫–∞</option>
                                <option value="4">4 —á–µ–ª–æ–≤–µ–∫–∞</option>
                            </select>
                            <span class="text-sm font-bold text-red-600">(+3000 —Ç–≥/—á–µ–ª)</span>
                        </div>
                    </div>
                    <div id="cargoStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>
                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (–∑–∞ 1 —á–∞—Å):</div>
                            <div id="cargoTotalPrice" class="price-estimate">6000 —Ç–≥</div>
                            <div id="cargoPriceNote" class="price-note font-semibold">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ - 1 —á–∞—Å.</div>
                        </div>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–ó–∞–∫–∞–∑–∞—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 4. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨ -->
    <div id="soberDriverModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üîë –¢—Ä–µ–∑–≤—ã–π –í–æ–¥–∏—Ç–µ–ª—å</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="soberDriverModal">√ó</button>
                </div>
                <form id="soberDriverForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="soberDriverFrom" class="text-sm font-medium text-gray-700 mb-1">–í–∞—à —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å *</label>
                        <div class="input-with-plus-btn">
                            <input id="soberDriverFrom" name="from" type="text" class="form-input-control" placeholder="–ê–¥—Ä–µ—Å, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–≤—Ç–æ" required>
                            <button type="button" onclick="getCurrentLocation('soberDriver')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="soberDriverGeoIcon" class="fas fa-compass"></i></button>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="soberDriverCarModel" class="text-sm font-medium text-gray-700 mb-1">–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ *</label>
                        <input id="soberDriverCarModel" name="carModel" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota Camry" required>
                    </div>
                    <div class="flex flex-col">
                        <label for="soberDriverTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å *</label>
                        <input id="soberDriverTo" name="to" type="text" class="form-input-control" placeholder="–ö–æ–Ω–µ—á–Ω—ã–π –∞–¥—Ä–µ—Å" required>
                    </div>
                    <div id="soberDriverStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>
                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate">–æ—Ç 3800 —Ç–≥</div>
                        </div>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–í—ã–∑–≤–∞—Ç—å –≤–æ–¥–∏—Ç–µ–ª—è</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 5. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ü–û–ú–û–©–¨ -->
    <div id="assistanceModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üôã –ü–æ–º–æ—â—å / –ü–æ–º–æ—â—å –Ω–∞ –¥–æ—Ä–æ–≥–µ</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="assistanceModal">√ó</button>
                </div>
                <form id="assistanceForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="assistanceType" class="text-sm font-medium text-gray-700 mb-1">–¢–∏–ø —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏ *</label>
                        <select id="assistanceType" name="type" class="form-input-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–º–æ—â–∏...</option>
                            <option value="–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ">–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ</option>
                            <option value="–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å">–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                            <option value="–ü—Ä–æ—á–µ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ/–ø–æ–º–æ—â—å">–ü—Ä–æ—á–µ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ/–ø–æ–º–æ—â—å</option>
                        </select>
                    </div>
                    <div id="carDetails" class="space-y-4 p-3 bg-teal-50 rounded-lg border border-dashed border-teal-300 hidden">
                        <p class="font-semibold text-sm text-teal-700">–î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–º–æ—â–∏ –Ω–∞ –¥–æ—Ä–æ–≥–µ</p>
                        <div class="flex flex-col">
                            <label for="carModel" class="text-sm font-medium text-gray-700 mb-1">–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ</label>
                            <input id="carModel" name="carModel" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota Camry">
                        </div>
                        <div class="flex flex-col">
                            <label for="licencePlate" class="text-sm font-medium text-gray-700 mb-1">–ì–æ—Å. –Ω–æ–º–µ—Ä</label>
                            <input id="licencePlate" name="licencePlate" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123ABC">
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="assistanceTask" class="text-sm font-medium text-gray-700 mb-1">–î–µ—Ç–∞–ª–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è</label>
                        <textarea id="assistanceTask" name="task" rows="3" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫–æ–µ –∫–æ–ª–µ—Å–æ —Å–ø—É—Å—Ç–∏–ª–æ"></textarea>
                    </div>
                    <div class="flex flex-col">
                        <label for="assistanceAddress" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å *</label>
                        <div class="input-with-plus-btn">
                            <input id="assistanceAddress" name="address" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º –∏–ª–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ" required />
                            <button type="button" onclick="getCurrentLocation('assistance')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="assistanceGeoIcon" class="fas fa-compass"></i></button>
                        </div>
                    </div>
                    <div id="assistanceStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>
                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate">–æ—Ç 1500 —Ç–≥</div>
                        </div>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 6. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ê–£–ö–¶–ò–û–ù -->
    <div id="auctionModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> <!-- –†—É—á–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üî® –ó–∞–∫–∞–∑-–ê—É–∫—Ü–∏–æ–Ω</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700 btn-active" data-modal="auctionModal">√ó</button>
                </div>
                <form id="auctionForm" class="space-y-4">
                    <div id="addressInputsAuction">
                        <div class="flex flex-col">
                            <label for="auctionFrom" class="text-sm font-medium text-gray-700 mb-1">–û—Ç–∫—É–¥–∞ (–∞–¥—Ä–µ—Å)</label>
                            <div class="input-with-plus-btn">
                                <input id="auctionFrom" name="from" type="text" autocomplete="off" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required>
                                <button type="button" onclick="getCurrentLocation('auction')" class="geo-btn btn-active" title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"><i id="auctionGeoIcon" class="fas fa-compass"></i></button>
                            </div>
                        </div>
                        <div class="flex flex-col">
                            <label for="auctionTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="auctionTo" name="to" type="text" autocomplete="off" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º/–æ–±—ä–µ–∫—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required>
                                <button type="button" onclick="addStop('additionalStopsAuction', 'auction')" class="add-stop-btn btn-active" title="–î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å"><i class="fas fa-plus"></i></button>
                            </div>
                            <div id="additionalStopsAuction" class="mt-2 space-y-2"></div>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="auctionPrice" class="text-sm font-medium text-gray-700 mb-1">–í–∞—à–∞ —Ü–µ–Ω–∞ –≤ —Ç–µ–Ω–≥–µ</label>
                        <input id="auctionPrice" name="price" type="number" inputmode="numeric" pattern="[0-9]*" min="500" class="form-input-control" placeholder="–ú–∏–Ω–∏–º—É–º 500 KZT" required>
                        <p class="text-xs text-gray-500 mt-1">‚ö†Ô∏è –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ —Å–≤–æ—é —Ü–µ–Ω—É, –∞ –≤–æ–¥–∏—Ç–µ–ª—å —Ä–µ—à–∞–µ—Ç, –±—Ä–∞—Ç—å –∑–∞–∫–∞–∑ –∏–ª–∏ –Ω–µ—Ç.</p>
                    </div>
                    <div id="auctionStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg" role="alert"></div>
                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-estimate text-yellow-600">–ù–∞—á–Ω–∏—Ç–µ –æ—Ç 500 —Ç–≥</div>
                        </div>
                        <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-200 btn-active">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ü–µ–Ω—É</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- PWA MODAL (–û–ë–ù–û–í–õ–ï–ù –î–õ–Ø –®–¢–û–†–ö–ò) -->
    <div id="pwaModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> 
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4 text-gray-800">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ¬´–¢–∞–∫—Å–∏ –£—Å–ø–µ—Ö¬ª –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!</h3>
                <p class="mb-4 text-gray-700">–ß—Ç–æ–±—ã –≤–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∏—Å–∫–∞—Ç—å —Å—Å—ã–ª–∫—É, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—à—É –ø—Ä–æ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä—è–º–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.</p>
                <div class="border p-4 rounded-lg mb-4 bg-gray-50">
                    <h4 class="text-lg font-bold text-blue-600 mb-2 flex items-center"><i class="fab fa-apple mr-2"></i> –î–ª—è iPhone (iOS)</h4>
                    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ **Safari**.</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª** (<i class="fas fa-share-square"></i>).</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ **¬´–ù–∞ —ç–∫—Ä–∞–Ω "–î–æ–º–æ–π"¬ª**.</li>
                    </ol>
                </div>
                <div class="border p-4 rounded-lg bg-gray-50">
                    <h4 class="text-lg font-bold text-green-600 mb-2 flex items-center"><i class="fab fa-android mr-2"></i> –î–ª—è Android (Chrome)</h4>
                    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                        <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ **—Ç—Ä–∏ —Ç–æ—á–∫–∏** (<i class="fas fa-ellipsis-v"></i>).</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ **¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª**.</li>
                    </ol>
                </div>
                <button onclick="closeModal('pwaModal')" class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg btn-active">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <!-- PARTNER MODAL (–û–ë–ù–û–í–õ–ï–ù –î–õ–Ø –®–¢–û–†–ö–ò) -->
    <div id="partnerModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="modal-handle"></div> 
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4 text-pink-600 flex items-center justify-center"><i class="fas fa-handshake mr-2"></i> –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –£—Å–ª—É–≥–∏</h3>
                <p class="mb-4 text-gray-800 font-semibold">–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è —Ä–µ–∫–ª–∞–º–∞ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞—à–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤!</p>
                <div class="border border-gray-200 p-4 rounded-lg mb-4 bg-gray-50">
                    <h4 class="text-lg font-bold text-gray-700">–•–æ—Ç–∏—Ç–µ —Å—Ç–∞—Ç—å –Ω–∞—à–∏–º –ü–∞—Ä—Ç–Ω–µ—Ä–æ–º?</h4>
                    <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20–æ–±—Å—É–¥–∏—Ç—å%20—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ%20—Ä–µ–∫–ª–∞–º—ã%20–Ω–∞%20–≤–∞—à–µ–π%20–ø—Ä–æ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–µ%20—Ç–∞–∫—Å–∏." target="_blank" class="w-full inline-block bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 rounded-lg transition btn-active">–°–≤—è–∑–∞—Ç—å—Å—è –ø–æ —Ä–µ–∫–ª–∞–º–µ</a>
                </div>
                <button onclick="closeModal('partnerModal')" class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg btn-active">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- FIREBASE –∏ JAVASCRIPT –õ–û–ì–ò–ö–ê -->
    <!-- ========================================================= -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        let app = null;
        let db = null;
        let auth = null;
        let userId = null;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∂–∏–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ (whatsapp –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        let orderDestination = 'whatsapp';
        
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null; 
        
        // --- –ù–û–í–û–ï: –ö–õ–Æ–ß –î–õ–Ø LocalStorage ---
        const LOCAL_STORAGE_HISTORY_KEY = 'taxi_address_history_v1';

        async function initFirebaseAndAuth() {
            if (!firebaseConfig) {
                console.error("Firebase configuration is missing.");
                return;
            }

            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        syncAddressHistory();
                    } 
                    setAddressHistory();
                });
            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
                setAddressHistory();
            }
        }
        
        const ADDRESS_HISTORY_DOC_PATH = "settings";
        const ADDRESS_HISTORY_FIELD = "addressHistory";

        // --- –û–ë–ù–û–í–õ–ï–ù–û: –°–ù–ê–ß–ê–õ–ê –ì–†–£–ó–ò–ú –ò–ó LS, –ü–û–¢–û–ú –°–ò–ù–•–†–û–ù–ò–ó–ò–†–£–ï–ú ---
        async function loadAddresses() {
            let localData = [];
            try {
                const stored = localStorage.getItem(LOCAL_STORAGE_HISTORY_KEY);
                if (stored) localData = JSON.parse(stored);
            } catch (e) { console.error("LS Error:", e); }
            return localData; 
        }
        
        // --- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò ---
        async function syncAddressHistory() {
            if (!db || !userId) return;
            try {
                const docRef = doc(db, "artifacts", appId, "users", userId, "data", ADDRESS_HISTORY_DOC_PATH);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const cloudData = docSnap.data()[ADDRESS_HISTORY_FIELD] || [];
                    if (cloudData.length > 0) {
                        localStorage.setItem(LOCAL_STORAGE_HISTORY_KEY, JSON.stringify(cloudData));
                        setAddressHistory();
                    }
                }
            } catch (e) {
                console.warn("Sync failed (offline?):", e);
            }
        }

        async function saveAddress(address) {
            if (!address || address.includes('[–ö–û–û–†–î–ò–ù–ê–¢–´]') || address.length < 3) return;

            let history = [];
            try {
                const stored = localStorage.getItem(LOCAL_STORAGE_HISTORY_KEY);
                if (stored) history = JSON.parse(stored);
            } catch(e) {}

            history = history.filter(item => item.toLowerCase() !== address.toLowerCase());
            history.unshift(address);
            history = history.slice(0, 10);
            
            localStorage.setItem(LOCAL_STORAGE_HISTORY_KEY, JSON.stringify(history));

            if (db && userId) {
                 const docRef = doc(db, "artifacts", appId, "users", userId, "data", ADDRESS_HISTORY_DOC_PATH);
                 setDoc(docRef, { [ADDRESS_HISTORY_FIELD]: history }, { merge: true }).catch(e => console.log("Firebase save error:", e));
            }
            
            await setAddressHistory();
        }

        async function populateDatalist(datalistId) {
            const historyArray = await loadAddresses();
            const datalist = document.getElementById(datalistId);
            if (!datalist) return;
            datalist.innerHTML = ''; 
            historyArray.forEach(address => {
                const option = document.createElement('option');
                option.value = address;
                datalist.appendChild(option);
            });
        }
        
        // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –û–¢–†–ò–°–û–í–ö–ò "–ß–ò–ü–°–û–í" –ò–°–¢–û–†–ò–ò
        async function renderHistoryChips() {
            const historyArray = await loadAddresses();
            const container = document.getElementById('taxiHistoryChips');
            if (!container) return;
            container.innerHTML = '';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5
            const recent = historyArray.slice(0, 5);
            
            if (recent.length === 0) {
                 container.style.display = 'none';
                 return;
            } else {
                 container.style.display = 'flex';
            }

            recent.forEach(addr => {
                const chip = document.createElement('button');
                chip.type = 'button';
                chip.className = 'history-chip btn-active';
                // –£—Ä–µ–∑–∞–µ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –¥–ª—è —á–∏–ø—Å–∞
                const displayAddr = addr.length > 20 ? addr.substring(0, 20) + '...' : addr;
                chip.innerHTML = `<i class="fas fa-history"></i> ${displayAddr}`;
                chip.onclick = () => fillAddressFromChip(addr);
                container.appendChild(chip);
            });
        }
        
        // –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑ —á–∏–ø—Å–∞
        window.fillAddressFromChip = function(address) {
            const fromInput = document.getElementById('taxiFrom');
            const toInput = document.getElementById('taxiTo');
            
            if (!fromInput.value) {
                fromInput.value = address;
            } else if (!toInput.value) {
                toInput.value = address;
            } else {
                // –ï—Å–ª–∏ –æ–±–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º "–ö—É–¥–∞"
                toInput.value = address;
            }
            updateTaxiPrice();
            
            // –í–∏–±—Ä–∞—Ü–∏—è
            if (navigator.vibrate) navigator.vibrate(10);
        }
        
        window.setAddressHistory = async function() {
             await populateDatalist('fromHistory');
             await populateDatalist('toHistory');
             await renderHistoryChips();
        }

        initFirebaseAndAuth();

        window.toggleAccordion = function(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            if (!content) return;
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                if (icon) icon.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                if (icon) icon.classList.remove('rotate-180');
            }
        }

        const locationBtnTextEl = document.getElementById('locationBtnText');
        const locationResultEl = document.getElementById('locationResult');
        const locationAddressEl = document.getElementById('locationAddress');
        const announcementBar = document.getElementById('announcementBar');
        
        let currentGeolocatedAddress = '';
        
        const CARGO_BASE_PRICE = 6000; 
        const MOVER_PRICE_PER_HOUR = 3000; 
        
        const INTERCITY_PRICES = {
            "—É—Å—Ç—å-–∫–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫": "–æ—Ç 4800‚Äì6210 —Ç–≥",
            "–≥–ª—É–±–æ–∫–æ–µ": "–æ—Ç 4200 —Ç–≥",
            "–Ω–æ–≤–∞—è –±—É—Ö—Ç–∞—Ä–º–∞": "–æ—Ç 24150 —Ç–≥",
            "—Ä–∏–¥–¥–µ—Ä": "–æ—Ç 25300 —Ç–≥",
            "—à–µ–º–æ–Ω–∞–∏—Ö–∞": "–æ—Ç 20700 —Ç–≥",
            "–∞–ª—Ç–∞–π": "–æ—Ç 45540 —Ç–≥", 
            "—É—Å—Ç—å-—Ç–∞–ª–æ–≤–∫–∞": "–æ—Ç 19780 —Ç–≥",
            "—Å–µ–∫–∏—Å–æ–≤–∫–∞": "–æ—Ç 6440 —Ç–≥",
            "–±–µ–ª–æ–∫–∞–º–µ–Ω–∫–∞": "–æ—Ç 3500 —Ç–≥",
            "–º–∏—Ö–∞–π–ª–æ–≤–∫–∞": "–æ—Ç 4000 —Ç–≥",
            "–ø—Ä–æ–≥—Ä–µ—Å—Å": "–æ—Ç 2990‚Äì3500 —Ç–≥",
            "—á–µ—Ä–Ω–æ–≥–æ—Ä–∫–∞": "–æ—Ç 2100‚Äì3000 —Ç–≥",
            "–∫—Ä–∞—Å–Ω—ã–π –ø–∞—Ä—Ç–∏–∑–∞–Ω": "–æ—Ç 1800‚Äì2500 —Ç–≥",
            "–ø–ª–∞–Ω–∏–¥–æ–≤–∫–∞": "–æ—Ç 2100‚Äì2500 —Ç–≥",
            "—Ç–∞—Ä—Ö–∞–Ω–∫–∞": "–æ—Ç 11270‚Äì12200 —Ç–≥",
            "–ø—Ä–µ–¥–≥–æ—Ä–Ω–æ–µ": "–æ—Ç 8500‚Äì10000 —Ç–≥",
            "–∞–ª—Ç–∞–π—Å–∫–∏–π": "–æ—Ç 6000‚Äì8000 —Ç–≥"
        };

        const MODALS = {
            'taxi': { id: 'taxiModal', formId: 'taxiForm', title: '–¢–ê–ö–°–ò', prefix: 'üöï –ù–û–í–´–ô –ó–ê–ö–ê–ó: –¢–ê–ö–°–ò' },
            'delivery': { id: 'deliveryModal', formId: 'deliveryForm', title: '–î–û–°–¢–ê–í–ö–ê', prefix: 'üõçÔ∏è –ù–û–í–´–ô –ó–ê–ö–ê–ó: –î–û–°–¢–ê–í–ö–ê' },
            'cargo': { id: 'cargoModal', formId: 'cargoForm', title: '–ì–†–£–ó–û–í–û–ô', prefix: 'üöö –ù–û–í–´–ô –ó–ê–ö–ê–ó: –ì–†–£–ó–û–í–û–ô' },
            'soberDriver': { id: 'soberDriverModal', formId: 'soberDriverForm', title: '–¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨', prefix: 'üîë –ù–û–í–´–ô –ó–ê–ö–ê–ó: –¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨' },
            'assistance': { id: 'assistanceModal', formId: 'assistanceForm', title: '–ü–û–ú–û–©–¨', prefix: 'üôã –ù–û–í–´–ô –ó–ê–ö–ê–ó: –ü–û–ú–û–©–¨' },
            'auction': { id: 'auctionModal', formId: 'auctionForm', title: '–ê–£–ö–¶–ò–û–ù', prefix: 'üî® –ó–ê–ö–ê–ó: –ê–£–ö–¶–ò–û–ù (–¶–ï–ù–ê –ö–õ–ò–ï–ù–¢–ê)' },
        };
        
        const PHONE_NUMBER = '77770649648'; 

        const THEME_KEY = 'taxi_theme_preference';
        const body = document.body;
        const themeIcon = document.getElementById('themeIcon');
        
        function updateThemeIcon(theme) {
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    themeIcon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É';
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    themeIcon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
                }
            }
        }

        function applyTheme(theme) {
            if (theme === 'dark') {
                body.classList.add('dark');
            } else {
                body.classList.remove('dark');
            }
            updateThemeIcon(theme);
        }

        window.toggleTheme = function() {
            const isDark = body.classList.contains('dark');
            const newTheme = isDark ? 'light' : 'dark';
            applyTheme(newTheme);
            localStorage.setItem(THEME_KEY, newTheme);
        }
        
        function loadTheme() {
            const savedTheme = localStorage.getItem(THEME_KEY);
            if (savedTheme) {
                applyTheme(savedTheme);
            } else {
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const defaultTheme = prefersDark ? 'dark' : 'light';
                applyTheme(defaultTheme);
            }
        }

        function checkAndShowAnnouncement() {
            const dismissKey = 'announcement_dismissed_v1';
            if (localStorage.getItem(dismissKey) === 'true') {
                announcementBar.classList.add('hidden');
            } else {
                announcementBar.classList.remove('hidden');
            }
        }

        window.dismissAnnouncement = function() {
            announcementBar.classList.add('hidden');
            localStorage.setItem('announcement_dismissed_v1', 'true');
        }

        function getFormattedCurrentTime() {
             const now = new Date();
             now.setMinutes(now.getMinutes() + 15); 
             const year = now.getFullYear();
             const month = String(now.getMonth() + 1).padStart(2, '0');
             const day = String(now.getDate()).padStart(2, '0');
             const hours = String(now.getHours()).padStart(2, '0');
             const minutes = String(now.getMinutes()).padStart(2, '0');
             return `${year}-${month}-${day}T${hours}:${minutes}`;
        }
        
        // --- 1. –ê–í–¢–û-–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –ù–û–ú–ï–†–ê –¢–ï–õ–ï–§–û–ù–ê (MASK) ---
        function initPhoneMask() {
            const phoneInput = document.getElementById('passengerPhone');
            if(phoneInput) {
                phoneInput.addEventListener('input', function (e) {
                    let x = e.target.value.replace(/\D/g, '').match(/(\d{0,1})(\d{0,3})(\d{0,3})(\d{0,2})(\d{0,2})/);
                    if (!x[2]) {
                         e.target.value = x[1] ? '+7' : '';
                         return;
                    }
                    e.target.value = '+7 (' + x[2] + (x[3] ? ') ' + x[3] : '') + (x[4] ? '-' + x[4] : '') + (x[5] ? '-' + x[5] : '');
                });
            }
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è –≤–∏–±—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ
        document.addEventListener('click', (e) => {
            if (e.target.closest('button') || e.target.closest('a')) {
                 if (navigator.vibrate) {
                     navigator.vibrate(5); // –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è
                 }
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
             loadTheme(); 
             checkAndShowAnnouncement();
             initPhoneMask(); // –ó–∞–ø—É—Å–∫ –º–∞—Å–∫–∏
             // --- –í–ê–ñ–ù–û: –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–¥—Ä–µ—Å–∞ —Å—Ä–∞–∑—É –∏–∑ LS –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ---
             setAddressHistory(); 
             
             const formattedNow = getFormattedCurrentTime();
             const taxiDateTimeInput = document.getElementById('taxiDateTime');
             if (taxiDateTimeInput) {
                 taxiDateTimeInput.value = formattedNow;
                 // --- 2. –ó–ê–©–ò–¢–ê –û–¢ –ü–†–û–®–õ–û–ì–û (MIN DATE) ---
                 taxiDateTimeInput.min = new Date().toISOString().slice(0, 16);
             }
             const cargoDateTimeInput = document.getElementById('cargoDateTime');
             if (cargoDateTimeInput) {
                 cargoDateTimeInput.value = formattedNow;
                 cargoDateTimeInput.min = new Date().toISOString().slice(0, 16);
             }
             updateCargoPrice(); 
             updateTaxiPrice(); 
        });
        
        function setGeoButtonLoading(mode, isLoading, isError = false) {
            let buttonEl, iconEl, textEl;
            if (mode === 'main') {
                buttonEl = document.getElementById('locationBtn');
                textEl = document.getElementById('locationBtnText');
                if (isLoading) {
                    textEl.innerHTML = '<i class="fas fa-spinner animate-spin"></i> –û–ø—Ä–µ–¥–µ–ª—è–µ–º...';
                    buttonEl.disabled = true;
                } else {
                    buttonEl.disabled = false;
                    textEl.innerHTML = isError ? '<i class="fas fa-times"></i> –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è' : '<i class="fas fa-check"></i> –ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
                }
                return;
            } 

            let iconId;
            switch(mode) {
                case 'taxi': iconId = 'taxiGeoIcon'; break;
                case 'auction': iconId = 'auctionGeoIcon'; break;
                case 'delivery': iconId = 'deliveryGeoIcon'; break;      
                case 'cargo': iconId = 'cargoGeoIcon'; break;           
                case 'soberDriver': iconId = 'soberDriverGeoIcon'; break; 
                case 'assistance': iconId = 'assistanceGeoIcon'; break; 
                default: return;
            }

            iconEl = document.getElementById(iconId);
            buttonEl = iconEl ? iconEl.closest('button') : null;

            if (buttonEl && iconEl) {
                buttonEl.disabled = isLoading;
                if (isLoading) {
                    iconEl.className = 'fas fa-spinner animate-spin';
                    buttonEl.title = '–û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ...';
                } else {
                    iconEl.className = isError ? 'fas fa-exclamation-triangle' : 'fas fa-compass';
                    buttonEl.title = '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ';
                }
            }
        }

        window.getCurrentLocation = function(trigger) {
            if (!navigator.geolocation) {
                displayMessageModal('–û—à–∏–±–∫–∞', '–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º.', true);
                setGeoButtonLoading(trigger, false, true);
                return;
            }

            setGeoButtonLoading(trigger, true);

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    setGeoButtonLoading(trigger, false, false);
                    const lat = position.coords.latitude.toFixed(5);
                    const lon = position.coords.longitude.toFixed(5);
                    const yandexMapUrl = `https://yandex.kz/maps/?pt=${lon},${lat}&z=16&l=map`;
                    currentGeolocatedAddress = `[–ö–û–û–†–î–ò–ù–ê–¢–´] ${lat}, ${lon}. –°—Å—ã–ª–∫–∞: ${yandexMapUrl}`; 
                    let inputId;
                    let message;
                    let placeholder;
                    let successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–û—Ç–∫—É–¥–∞".';

                    switch (trigger) {
                        case 'main':
                            locationResultEl.classList.remove('hidden');
                            locationAddressEl.textContent = `–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${lat}, ${lon} (–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É)`;
                            locationAddressEl.href = yandexMapUrl; 
                            locationAddressEl.title = '–û—Ç–∫—Ä—ã—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ';
                            setAllLocationFields(currentGeolocatedAddress);
                            displayMessageModal('–ì–æ—Ç–æ–≤–æ!', '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç—É) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ –≤—Å–µ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞ (–û—Ç–∫—É–¥–∞/–ê–¥—Ä–µ—Å)! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞–∫–∞–∑–∞—Ç—å" –≤ –ª—é–±–æ–π —Ñ–æ—Ä–º–µ.', false);
                            return;
                        case 'taxi': inputId = 'taxiFrom'; message = '–û—Ç–∫—É–¥–∞'; placeholder = '–û—Ç–∫—É–¥–∞ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; break;
                        case 'auction': inputId = 'auctionFrom'; message = '–û—Ç–∫—É–¥–∞'; placeholder = '–û—Ç–∫—É–¥–∞ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; break;
                        case 'delivery': inputId = 'deliveryAddress'; message = '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏'; placeholder = '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏".'; break;
                        case 'cargo': inputId = 'cargoFrom'; message = '–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏'; placeholder = '–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏".'; break;
                        case 'soberDriver': inputId = 'soberDriverFrom'; message = '–í–∞—à —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å'; placeholder = '–ê–¥—Ä–µ—Å –∞–≤—Ç–æ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–í–∞—à —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å".'; break;
                        case 'assistance': inputId = 'assistanceAddress'; message = '–ê–¥—Ä–µ—Å –ø–æ–º–æ—â–∏'; placeholder = '–ê–¥—Ä–µ—Å –ø–æ–º–æ—â–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å (–≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å)".'; break;
                        default: return;
                    }

                    const input = document.getElementById(inputId);
                    if (input) {
                        input.value = currentGeolocatedAddress;
                        input.placeholder = placeholder;
                    }
                    displayMessageModal('–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω', successMessage, false);
                    if (trigger === 'taxi') updateTaxiPrice();

                },
                (error) => {
                    setGeoButtonLoading(trigger, false, true);
                    let errorMessage = '–û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.';
                    if (error.code === error.PERMISSION_DENIED) errorMessage = '–î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.';
                    if (trigger === 'main') {
                         locationResultEl.classList.add('hidden');
                    }
                    displayMessageModal('–û—à–∏–±–∫–∞', errorMessage, true);
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
            );
        }
        
        let stopCounter = 0; 

        window.addStop = function(containerId, mode) {
            if (stopCounter >= 3) {
                displayMessageModal('–õ–∏–º–∏—Ç', '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ (3) –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ.', false);
                return;
            }
            stopCounter++;
            const stopsContainer = document.getElementById(containerId);
            const stopId = `${containerId}Input${stopCounter}`;
            const stopLabel = `–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å ${stopCounter}`;
            const stopDiv = document.createElement('div');
            stopDiv.className = "flex space-x-2 additional-stop-item input-with-plus-btn"; 
            const divId = `stopDiv${containerId}${stopCounter}`;
            stopDiv.id = divId;
            const inputEvents = (mode === 'taxi') ? 'oninput="updateTaxiPrice()"' : '';
            stopDiv.innerHTML = `
                <input id="${stopId}" name="${stopId}" type="text" list="toHistory" autocomplete="off" class="form-input-control" placeholder="${stopLabel} (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required ${inputEvents}>
                <button type="button" onclick="removeStop('${divId}', '${mode}')" class="remove-stop-btn btn-active" title="–£–¥–∞–ª–∏—Ç—å –∞–¥—Ä–µ—Å"><i class="fas fa-minus"></i></button>
            `;
            stopsContainer.appendChild(stopDiv);
            setAddressHistory(); 
            if (mode === 'taxi') updateTaxiPrice();
        }
        
        window.removeStop = function(divId, mode) {
            const elementToRemove = document.getElementById(divId);
            if (elementToRemove) {
                elementToRemove.remove();
                stopCounter--;
                if (stopCounter < 0) stopCounter = 0;
            }
            if (mode === 'taxi') updateTaxiPrice();
        }
        
        function countFilledAddresses() {
            let count = 0;
            const fromInput = document.getElementById('taxiFrom');
            const toInput = document.getElementById('taxiTo');
            const stopsContainer = document.getElementById('additionalStops');
            if (fromInput && fromInput.value.trim().length > 0) count++; 
            if (toInput && toInput.value.trim().length > 0) count++;
            if (stopsContainer) {
                stopsContainer.querySelectorAll('input.form-input-control').forEach(input => {
                    if (input.value.trim().length > 0) count++;
                });
            }
            return count;
        }
        
        window.updateTaxiPrice = function() {
            const priceEl = document.getElementById('taxiPriceEstimate');
            if (!priceEl) return;
            const toInput = document.getElementById('taxiTo');
            const destination = toInput ? toInput.value.trim().toLowerCase() : '';
            
            // --- 3. –£–ú–ù–´–ô –†–ê–°–ß–ï–¢ –¶–ï–ù–´ (–û—á–∏—Å—Ç–∫–∞ –æ—Ç "–≥.", "–≥–æ—Ä–æ–¥" –∏ —Ç.–¥.) ---
            const cleanDestination = destination.replace(/^(–≥\.|–≥–æ—Ä–æ–¥\s+|–ø\.|–ø–æ—Å\.|–ø–æ—Å–µ–ª–æ–∫\s+|—Å\.|—Å–µ–ª–æ\s+)/i, '').trim();
            
            let priceText;
            let isIntercity = false;
            for (const location in INTERCITY_PRICES) {
                // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—á–∏—â–µ–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º
                if (cleanDestination.startsWith(location)) {
                    priceText = INTERCITY_PRICES[location];
                    isIntercity = true;
                    break;
                }
            }
            if (isIntercity) {
                priceEl.textContent = priceText;
                return; 
            }
            const addressCount = countFilledAddresses();
            if (addressCount <= 2) priceText = '–æ—Ç 700‚Äì900 —Ç–≥';
            else if (addressCount >= 3) priceText = '–æ—Ç 1500‚Äì2000 —Ç–≥';
            else priceText = '–æ—Ç 700‚Äì900 —Ç–≥';
            priceEl.textContent = priceText;
        }

        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                document.querySelectorAll('.status-message').forEach(el => el.classList.remove('active'));
                if (modalId === 'taxiModal' || modalId === 'auctionModal') setAddressHistory();
                modal.classList.add('active');
                modal.setAttribute('aria-hidden', 'false');
                const formattedNow = getFormattedCurrentTime();
                const minTime = new Date().toISOString().slice(0, 16);
                 if (modalId === 'taxiModal') {
                     const dtInput = document.getElementById('taxiDateTime');
                     dtInput.value = formattedNow;
                     dtInput.min = minTime; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º—É–º–∞
                     updateTaxiPrice(); 
                 }
                 if (modalId === 'cargoModal') {
                     const dtInput = document.getElementById('cargoDateTime');
                     dtInput.value = formattedNow;
                     dtInput.min = minTime; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º—É–º–∞
                     document.getElementById('cargoMovers').value = '0'; 
                     updateCargoPrice(); 
                 }
                const firstInput = modal.querySelector('input, textarea, select');
                if (firstInput) firstInput.focus();
            }
        }

        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                modal.setAttribute('aria-hidden', 'true');
                
                if (modalId === 'taxiModal' || modalId === 'auctionModal') {
                    const stopsContainerTaxi = document.getElementById('additionalStops');
                    const stopsContainerAuction = document.getElementById('additionalStopsAuction');
                    if (stopsContainerTaxi) stopsContainerTaxi.innerHTML = '';
                    if (stopsContainerAuction) stopsContainerAuction.innerHTML = '';
                    stopCounter = 0; 
                    const form = document.getElementById(modalId.replace('Modal', 'Form'));
                    if (form) form.reset();
                } else if (modalId === 'servicesMenuModal') {
                    // –Ω–∏—á–µ–≥–æ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º
                } else {
                    const form = document.getElementById(modalId.replace('Modal', 'Form'));
                    if (form) form.reset();
                }
                
                if (modalId === 'assistanceModal') {
                    document.getElementById('carDetails').classList.add('hidden');
                    document.getElementById('assistanceType').value = '';
                }
                
                if (modalId === 'taxiModal') {
                     const content = document.getElementById('preorderContent');
                     const icon = document.getElementById('preorderIcon');
                     if (content && !content.classList.contains('hidden')) content.classList.add('hidden');
                     if (icon && icon.classList.contains('rotate-180')) icon.classList.remove('rotate-180');
                     
                     const formattedNow = getFormattedCurrentTime();
                     document.getElementById('taxiDateTime').value = formattedNow;
                     updateTaxiPrice(); 
                 }
                 if (modalId === 'cargoModal') {
                     const formattedNow = getFormattedCurrentTime();
                     document.getElementById('cargoDateTime').value = formattedNow;
                     document.getElementById('cargoMovers').value = '0'; 
                     updateCargoPrice(); 
                 }
            }
        }

        function showStatus(modalId, message) {
            const statusEl = document.getElementById(modalId.replace('Modal', 'Status'));
            if (statusEl) {
                statusEl.textContent = message;
                statusEl.classList.add('active');
            }
        }
        
        function displayMessageModal(title, message, isError = false) {
            const existingModal = document.getElementById('alertModal');
            if (existingModal) existingModal.remove();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –£–°–ü–ï–•, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä–∞—Å–∏–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            if (!isError && (title === '–ó–∞–∫–∞–∑ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!' || title === '–ì–æ—Ç–æ–≤–æ!')) {
                 const modalHtml = `
                    <div id="alertModal" class="modal-overlay active" aria-hidden="false" role="dialog">
                        <div class="modal">
                            <div class="modal-handle"></div>
                            <div class="p-8 text-center">
                                <div class="success-checkmark mb-4">
                                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 130.2 130.2">
                                      <circle class="path circle" fill="none" stroke="#10b981" stroke-width="6" stroke-miterlimit="10" cx="65.1" cy="65.1" r="62.1"/>
                                      <polyline class="path check" fill="none" stroke="#10b981" stroke-width="6" stroke-linecap="round" stroke-miterlimit="10" points="100.2,40.2 51.5,88.8 29.8,67.5 "/>
                                    </svg>
                                </div>
                                <h3 class="text-2xl font-bold mb-2 text-gray-800 dark:text-gray-200">${title}</h3>
                                <p class="mb-6 text-gray-600 dark:text-gray-300 text-sm">${message}</p>
                                <button onclick="document.getElementById('alertModal').remove()" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition transform hover:scale-105 btn-active">–û—Ç–ª–∏—á–Ω–æ</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHtml);
                return;
            }

            const modalHtml = `
                <div id="alertModal" class="modal-overlay active" aria-hidden="false" role="dialog">
                    <div class="modal">
                         <div class="modal-handle"></div>
                         <div class="p-6 text-center">
                            <h3 class="text-xl font-bold mb-4 ${isError ? 'text-red-600' : 'text-indigo-600'}">${title}</h3>
                            <p class="mb-6 text-gray-700 dark:text-gray-300">${message}</p>
                            <button onclick="document.getElementById('alertModal').remove()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg btn-active">OK</button>
                         </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function setAllLocationFields(locationText) {
            const fieldsToFill = [
                { id: 'taxiFrom', placeholder: '–û—Ç–∫—É–¥–∞ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }, 
                { id: 'deliveryAddress', placeholder: '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }, 
                { id: 'cargoFrom', placeholder: '–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }, 
                { id: 'soberDriverFrom', placeholder: '–ê–¥—Ä–µ—Å –∞–≤—Ç–æ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }, 
                { id: 'assistanceAddress', placeholder: '–ê–¥—Ä–µ—Å –ø–æ–º–æ—â–∏ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }, 
                { id: 'auctionFrom', placeholder: '–û—Ç–∫—É–¥–∞ (–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)' }
            ];
            fieldsToFill.forEach(field => {
                const input = document.getElementById(field.id);
                if (input) {
                    input.value = locationText;
                    input.placeholder = field.placeholder; 
                }
            });
            updateTaxiPrice();
        }
        
        window.updateCargoPrice = function() {
            const cargoMoversSelect = document.getElementById('cargoMovers');
            const cargoTotalPriceEl = document.getElementById('cargoTotalPrice');
            const cargoPriceNoteEl = document.getElementById('cargoPriceNote');
            if (!cargoMoversSelect || !cargoTotalPriceEl || !cargoPriceNoteEl) return;
            const moversCount = parseInt(cargoMoversSelect.value) || 0;
            const totalPrice = CARGO_BASE_PRICE + (moversCount * MOVER_PRICE_PER_HOUR);
            const formattedPrice = totalPrice.toLocaleString('ru-RU');
            cargoTotalPriceEl.textContent = `${formattedPrice} —Ç–≥`;
            if (moversCount > 0) cargoPriceNoteEl.innerHTML = `–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ${CARGO_BASE_PRICE.toLocaleString('ru-RU')} —Ç–≥ + –¥–æ–ø–ª–∞—Ç–∞ –∑–∞ ${moversCount} —á–µ–ª.`;
            else cargoPriceNoteEl.textContent = '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ - 1 —á–∞—Å.';
        }

        window.togglePreorder = function() {
            const content = document.getElementById('preorderContent');
            const icon = document.getElementById('preorderIcon');
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                if (icon) icon.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                if (icon) icon.classList.remove('rotate-180');
            }
        }
        
        // --- –õ–û–ì–ò–ö–ê –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–û–ì–û –ú–ï–ù–Æ (WHATSAPP –ò TELEGRAM) ---
        window.openServicesMenu = function(mode) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∂–∏–º: 'whatsapp' –∏–ª–∏ 'telegram'
            orderDestination = mode;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞–Ω–∞–ª Telegram –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
            const footer = document.getElementById('servicesMenuFooter');
            if (footer) {
                if (mode === 'telegram') {
                    footer.classList.remove('hidden');
                } else {
                    footer.classList.add('hidden');
                }
            }

            openModal('servicesMenuModal');
        }

        window.openServiceFromMenu = function(serviceKey) {
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å
            closeModal('servicesMenuModal');
            setTimeout(() => {
                if (MODALS[serviceKey]) {
                    openModal(MODALS[serviceKey].id);
                }
            }, 100);
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.setAttribute('readonly', '');
            textarea.style.position = 'absolute';
            textarea.style.left = '-9999px';
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
            } catch (err) {
                console.error('Failed to copy', err);
            }
            
            document.body.removeChild(textarea);
        }

        // --- –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò: –ü–û–ú–ï–ù–Ø–¢–¨ –ú–ï–°–¢–ê–ú–ò, –î–û–ë–ê–í–ò–¢–¨ –ü–û–ñ–ï–õ–ê–ù–ò–ï, –ü–û–î–ï–õ–ò–¢–¨–°–Ø ---

        window.swapTaxiAddresses = function() {
            const fromEl = document.getElementById('taxiFrom');
            const toEl = document.getElementById('taxiTo');
            const temp = fromEl.value;
            fromEl.value = toEl.value;
            toEl.value = temp;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–Ω—ã
            updateTaxiPrice();
        }

        window.addWish = function(text) {
            const wishEl = document.getElementById('taxiWishes');
            let currentText = wishEl.value.trim();
            
            // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞: –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–µ—Ç, —Å—Ç–∞–≤–∏–º. –ï—Å–ª–∏ –µ—Å—Ç—å, –¥–æ–±–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.
            if (!currentText) {
                wishEl.value = text;
            } else if (!currentText.includes(text)) {
                wishEl.value = currentText + ', ' + text;
            }
        }
        
        window.shareApp = async function() {
            const shareData = {
                title: '–¢–∞–∫—Å–∏ ¬´–£—Å–ø–µ—Ö¬ª',
                text: '–ó–∞–∫–∞–∑—ã–≤–∞–π —Ç–∞–∫—Å–∏ –≤ –ë–µ–ª–æ—É—Å–æ–≤–∫–µ –±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ!',
                url: window.location.href
            };
            try {
                if (navigator.share) {
                    await navigator.share(shareData);
                } else {
                    // Fallback
                    copyToClipboard(window.location.href);
                    displayMessageModal('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞', '–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ—ë –¥—Ä—É–∑—å—è–º!', false);
                }
            } catch (err) {
                console.error(err);
            }
        }
        
        document.querySelectorAll('.service-btn').forEach(button => {
            button.addEventListener('click', () => {
                // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å –∫–ª–∞—Å—Å–æ–º service-btn, –Ω–æ –±–µ–∑ —è–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–µ–Ω—é
                // (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–ª–∏—Ç–∫–∏ –≤–Ω–∏–∑—É "–î–æ—Å—Ç–∞–≤–∫–∞" –∏ —Ç.–¥.), —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ WhatsApp –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                orderDestination = 'whatsapp';
                const service = button.getAttribute('data-service');
                if (MODALS[service]) openModal(MODALS[service].id);
            });
        });

        document.querySelectorAll('.close-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const modalId = button.getAttribute('data-modal');
                closeModal(modalId);
            });
        });

        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) closeModal(overlay.id);
            });
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const openModal = document.querySelector('.modal-overlay.active');
                if (openModal) closeModal(openModal.id);
            }
        });
        
        const assistanceTypeSelect = document.getElementById('assistanceType');
        const carDetailsDiv = document.getElementById('carDetails');
        if (assistanceTypeSelect && carDetailsDiv) {
            assistanceTypeSelect.addEventListener('change', (e) => {
                const selectedType = e.target.value;
                if (selectedType === '–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ' || selectedType === '–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å') carDetailsDiv.classList.remove('hidden');
                else carDetailsDiv.classList.add('hidden');
            });
        }

        const forms = document.querySelectorAll('form');
        forms.forEach(form => {
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                const formId = this.id;
                const modalKey = Object.keys(MODALS).find(key => MODALS[key].formId === formId);
                const modalConfig = MODALS[modalKey];
                if (!modalConfig) return;
                const modalId = modalConfig.id;
                const statusEl = document.getElementById(modalId.replace('Modal', 'Status'));
                if (statusEl) statusEl.classList.remove('active');
                let message = `${modalConfig.prefix}\n\n`;
                let requiredFieldsMissing = false;

                const getVal = (id, label, isRequired = false) => {
                    const input = document.getElementById(id);
                    let value = input ? input.value.trim() : '';
                    if (isRequired && !value) requiredFieldsMissing = true;
                    if (input && input.type === 'checkbox') value = input.checked ? '–î–∞' : '–ù–µ—Ç';
                    return `*${label}*:\n${value || '‚Äî'}\n\n`;
                };

                const collectStops = (containerId) => {
                    let stops = '';
                    const container = document.getElementById(containerId);
                    if (container) {
                        container.querySelectorAll('input').forEach((input, index) => {
                            if (input.value.trim()) {
                                const stopLabel = `–î–æ–ø. –∞–¥—Ä–µ—Å ${index + 1}`;
                                stops += `*${stopLabel}*:\n${input.value.trim()}\n\n`;
                            }
                        });
                    }
                    return stops;
                };
                
                const handlePreorder = (dateTimeId, basePrefix) => {
                    const dateTimeInput = document.getElementById(dateTimeId).value;
                    let prefixMessage = basePrefix;
                    if (dateTimeInput) {
                        const selectedTime = new Date(dateTimeInput);
                        const currentTime = new Date();
                        if (selectedTime > currentTime) {
                            const formattedDate = selectedTime.toLocaleString('ru-RU', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
                            prefixMessage = `‚è∞ –ü–†–ï–î–ó–ê–ö–ê–ó (${modalConfig.title}) ‚è∞\n\n`;
                            prefixMessage += `*–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏*:\n${formattedDate}\n\n`;
                        }
                    }
                    return prefixMessage;
                };

                let addressesToSave = [];

                switch (modalKey) {
                    case 'taxi':
                        const fromAddress = document.getElementById('taxiFrom').value.trim();
                        const toAddress = document.getElementById('taxiTo').value.trim();
                        const wishes = document.getElementById('taxiWishes').value.trim();
                        const passengerPhone = document.getElementById('passengerPhone').value.trim(); 
                        const preorderContent = document.getElementById('preorderContent');
                        const isPreorderOpen = preorderContent && !preorderContent.classList.contains('hidden');
                        
                        if (isPreorderOpen) message = handlePreorder('taxiDateTime', modalConfig.prefix);
                        else message = `${modalConfig.prefix}\n\n`;
                        
                        // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –í–æ–∑–≤—Ä–∞—Ç —Ñ–æ—Ä–º–∞—Ç–∞ —Å "–û—Ç–∫—É–¥–∞" –∏ "–ö—É–¥–∞" ---
                        if (!fromAddress) requiredFieldsMissing = true;
                        if (!toAddress) requiredFieldsMissing = true;
                        
                        message += `–û—Ç–∫—É–¥–∞:\n${fromAddress}\n\n`;
                        message += `–ö—É–¥–∞:\n${toAddress}\n\n`;
                        // ----------------------------------------------------------------------
                        
                        if (wishes) message += `*–ü–æ–∂–µ–ª–∞–Ω–∏—è*:\n${wishes}\n\n`;
                        let stopMessage = collectStops('additionalStops');
                        if (stopMessage) {
                            message += '\n--- –î–û–ü. –ê–î–†–ï–°–ê –ü–û –ü–£–¢–ò ---\n\n';
                            message += stopMessage;
                            message += '---------------------------\n\n';
                        }
                        if (passengerPhone) {
                            message += 'üìû –ö–û–ù–¢–ê–ö–¢–´:\n';
                            message += `*–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏*:\n${passengerPhone}\n\n`;
                        }
                        const currentPriceText = document.getElementById('taxiPriceEstimate').textContent;
                        message += `üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: ${currentPriceText} (—É—Ç–æ—á–Ω–∏—Ç –≤–æ–¥–∏—Ç–µ–ª—å)`;
                        if (fromAddress) addressesToSave.push(fromAddress);
                        if (toAddress) addressesToSave.push(toAddress);
                        break;
                    case 'auction':
                        const auctionPrice = document.getElementById('auctionPrice').value;
                        if (!auctionPrice || parseInt(auctionPrice) < 500) {
                            requiredFieldsMissing = true;
                            showStatus(modalId, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É (–º–∏–Ω–∏–º—É–º 500 KZT).');
                            return;
                        }
                        message += getVal('auctionFrom', '–û—Ç–∫—É–¥–∞', true);
                        message += getVal('auctionTo', '–ö—É–¥–∞', true);
                        message += collectStops('additionalStopsAuction');
                        message += `*–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Ü–µ–Ω–∞*:\n${auctionPrice} KZT\n\n`;
                        message += '‚ö†Ô∏è –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –≠—Ç–æ —Ü–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞. –ü—Ä–∏–º–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –∑–∞–∫–∞–∑—É —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.';
                        const auctionFromAddress = document.getElementById('auctionFrom').value.trim();
                        const auctionToAddress = document.getElementById('auctionTo').value.trim();
                        if (auctionFromAddress) addressesToSave.push(auctionFromAddress);
                        if (auctionToAddress) addressesToSave.push(auctionToAddress);
                        break;
                    case 'delivery':
                        message += getVal('deliveryItems', '–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤', true);
                        message += getVal('deliveryAddress', '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏', true);
                        message += getVal('deliveryStore', '–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –º–∞–≥–∞–∑–∏–Ω—É');
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 1200 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è/–æ–±—ä–µ–º–∞)';
                        const deliveryAddress = document.getElementById('deliveryAddress').value.trim();
                        if (deliveryAddress) addressesToSave.push(deliveryAddress);
                        break;
                    case 'cargo':
                        const cargoMoversSelect = document.getElementById('cargoMovers');
                        const moversCount = parseInt(cargoMoversSelect.value);
                        const totalPrice = CARGO_BASE_PRICE + (moversCount * MOVER_PRICE_PER_HOUR);
                        const formattedPrice = totalPrice.toLocaleString('ru-RU');
                        const moversText = (moversCount > 0) ? `${moversCount} —á–µ–ª. (–î–æ–ø–ª–∞—Ç–∞: ${moversCount * MOVER_PRICE_PER_HOUR} —Ç–≥/—á–∞—Å)` : '–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è';
                        message = handlePreorder('cargoDateTime', modalConfig.prefix);
                        message += getVal('cargoFrom', '–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏', true);
                        message += getVal('cargoTo', '–ê–¥—Ä–µ—Å –≤—ã–≥—Ä—É–∑–∫–∏', true);
                        message += getVal('cargoDescription', '–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–∑–∞', true);
                        message += `*–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–∑—á–∏–∫–æ–≤*:\n${moversText}\n\n`;
                        message += `*–ò–¢–û–ì–û–í–ê–Ø –°–£–ú–ú–ê (–∑–∞ 1 —á–∞—Å)*:\n${formattedPrice} —Ç–≥\n\n`;
                        message += `üí∞ –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞: ${CARGO_BASE_PRICE.toLocaleString('ru-RU')} —Ç–≥/—á–∞—Å`;
                        const cargoFromAddress = document.getElementById('cargoFrom').value.trim();
                        const cargoToAddress = document.getElementById('cargoTo').value.trim();
                        if (cargoFromAddress) addressesToSave.push(cargoFromAddress);
                        if (cargoToAddress) addressesToSave.push(cargoToAddress);
                        break;
                    case 'soberDriver':
                        message += getVal('soberDriverFrom', '–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å (–ê–≤—Ç–æ)', true);
                        message += getVal('soberDriverCarModel', '–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ', true); 
                        message += getVal('soberDriverTo', '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∞–≤—Ç–æ', true);
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 3800 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è)';
                        const soberDriverFromAddress = document.getElementById('soberDriverFrom').value.trim();
                        if (soberDriverFromAddress) addressesToSave.push(soberDriverFromAddress);
                        break;
                    case 'assistance':
                        const type = document.getElementById('assistanceType').value;
                        if (!type) { requiredFieldsMissing = true; break; }
                        message += getVal('assistanceType', '–¢–∏–ø –ø–æ–º–æ—â–∏');
                        if (type === '–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ' || type === '–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å') {
                            message += getVal('carModel', '–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ');
                            message += getVal('licencePlate', '–ì–æ—Å. –Ω–æ–º–µ—Ä');
                        }
                        message += getVal('assistanceTask', '–î–µ—Ç–∞–ª–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è');
                        message += getVal('assistanceAddress', '–ê–¥—Ä–µ—Å (–≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å)', true);
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 1500 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏)';
                        const assistanceAddress = document.getElementById('assistanceAddress').value.trim();
                        if (assistanceAddress) addressesToSave.push(assistanceAddress);
                        break;
                } 

                if (requiredFieldsMissing) {
                    showStatus(modalId, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.');
                    return;
                }
                
                for (const address of addressesToSave) {
                    await saveAddress(address);
                }

                // VIBRATION FOR EVERYONE (–ü–ï–†–ï–ù–ï–°–ï–ù–û –°–Æ–î–ê)
                if (navigator.vibrate) {
                    navigator.vibrate(200); 
                }

                // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                if (orderDestination === 'telegram') {
                    copyToClipboard(message);
                    
                    displayMessageModal('–ó–∞–∫–∞–∑ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!', '–¢–µ–∫—Å—Ç –∑–∞–∫–∞–∑–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω. –°–µ–π—á–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Telegram ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –≤ —á–∞—Ç.', false);
                    setTimeout(() => {
                        window.open('https://t.me/TaxiUspehk', '_blank');
                    }, 1500); // 1.5 —Å–µ–∫—É–Ω–¥—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è Telegram

                } else {
                    // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π WhatsApp (–¢–ï–ü–ï–†–¨ –¢–û–ñ–ï –° –ê–ù–ò–ú–ê–¶–ò–ï–ô)
                    displayMessageModal('–ó–∞–∫–∞–∑ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!', '–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ WhatsApp –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è...', false);
                    
                    setTimeout(() => {
                         const waLink = `https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(message)}`;
                         window.open(waLink, '_blank');
                    }, 1000); // 1 —Å–µ–∫—É–Ω–¥–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è WhatsApp, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≥–∞–ª–æ—á–∫—É
                }

                closeModal(modalId);
                this.reset();
            }); 
        }); 

        window.showPWAInstructions = function() {
            document.getElementById('pwaModal').classList.remove('hidden');
            // Manual activation for PWA modal since it doesn't use openModal
             const pwaModal = document.getElementById('pwaModal');
             if (pwaModal) {
                 pwaModal.classList.add('active');
                 pwaModal.setAttribute('aria-hidden', 'false');
             }
        }
        window.showPartnerModal = function() {
            document.getElementById('partnerModal').classList.remove('hidden');
             // Manual activation for Partner modal since it doesn't use openModal
             const partnerModal = document.getElementById('partnerModal');
             if (partnerModal) {
                 partnerModal.classList.add('active');
                 partnerModal.setAttribute('aria-hidden', 'false');
             }
        }

    </script>
</body>
</html>
