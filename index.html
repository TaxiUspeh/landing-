<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>–¢–∞–∫—Å–∏ ¬´–£—Å–ø–µ—Ö¬ª ‚Äî –ë–µ–ª–æ—É—Å–æ–≤–∫–∞</title>

    <!-- Google Analytics (–ö–û–î –ê–ö–¢–ò–í–ò–†–û–í–ê–ù: G-NMCTD2Q8R2) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NMCTD2Q8R2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-NMCTD2Q8R2');
    </script>
    <!-- –ö–û–ù–ï–¶ Google Analytics -->

    <!-- Favicon –∏ –∏–∫–æ–Ω–∫–∏ –¥–ª—è Apple/Android (–ü–û–õ–ù–´–ô –ö–û–ú–ü–õ–ï–ö–¢ –° –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ú –°–ë–†–û–°–û–ú –ö–≠–®–ê v12) -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png?v=12">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon-192x192.png?v=12">
    <link rel="apple-touch-icon" href="apple-touch-icon.png?v=12">
    <!-- –ê–ö–¢–ò–í–ò–†–û–í–ê–ù –ú–ê–ù–ê–§–ï–°–¢ –î–õ–Ø –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø –Ø–†–õ–´–ö–ê –ù–ê –†–ê–ë–û–ß–ï–ú –°–¢–û–õ–ï -->
    <link rel="manifest" href="site.webmanifest?v=12">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —à—Ä–∏—Ñ—Ç—ã */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        :root {
            --color-primary-blue: #3b82f6; /* blue-500 */
            --color-primary-dark: #2563eb; /* blue-600 */
        }
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f5f5f5; /* light mode bg */
            padding-bottom: 72px; 
            transition: background-color 0.3s, color 0.3s;
            color: #1f2937; /* Default text color */
        }
        .header-bg { 
            background: linear-gradient(135deg, #f59e0b 0%, #1d4ed8 100%); 
            transition: background 0.3s;
        }
        .btn-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .service-card, .main-card, .auction-cta, .stroy-dom-cta, .faq-item { 
            transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s, border-color 0.3s, color 0.3s;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .service-card:hover { transform: scale(1.03); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .auction-cta { background-color: #fff; border: 2px solid #f59e0b; }
        .stroy-dom-cta { background-color: #ecfdf5; border: 3px solid #059669; animation: pulse-green 4s infinite; }
        
        @keyframes pulse-green {
            0%, 100% { border-color: #059669; } /* emerald-600 */
            50% { border-color: #34d399; } /* emerald-400 */
        }
        
        #locationBtn {
            padding: 10px 12px;
            font-size: 1rem;
            background-color: #e5e7eb; 
            color: #374151; 
            font-weight: 600;
            border-radius: 8px;
            transition: background-color 0.2s;
        }
        #locationBtn:hover {
            background-color: #d1d5db; 
        }
        .compact-util-btn {
            padding: 12px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            line-height: 1.2;
        }
        .quick-order-btn {
            padding-top: 12px;
            padding-bottom: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem; 
            font-weight: 700; 
        }
        
        /* === –°–¢–ò–õ–ò –î–õ–Ø –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh; 
            overflow-y: auto; 
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            transform: scale(0.95);
            transition: transform 0.3s ease, background-color 0.3s;
        }
        
        .form-input-control {
             padding: 8px 12px;
             border: 1px solid #d1d5db;
             border-radius: 8px;
             width: 100%;
             transition: border-color 0.2s, box-shadow 0.2s;
             box-sizing: border-box; 
        }
        .form-input-control:focus {
            border-color: var(--color-primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
            outline: none;
        }
        
        .input-with-plus-btn {
            display: flex;
            align-items: center;
            gap: 8px; 
        }
        .input-with-plus-btn .form-input-control {
            flex-grow: 1; 
            min-width: 0; 
        }
        
        .geo-btn {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            background-color: #f59e0b; /* amber-500 */
            color: white;
            border-radius: 8px;
            transition: background-color 0.2s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(245, 158, 11, 0.5);
        }
        .geo-btn:hover {
            background-color: #d97706; /* amber-700 */
            transform: scale(1.05);
        }

        .add-stop-btn {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            background-color: #10b981; /* emerald-500 */
            color: white;
            border-radius: 8px;
            transition: background-color 0.2s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(16, 185, 129, 0.5);
        }
        .add-stop-btn:hover {
            background-color: #059669; /* emerald-600 */
            transform: scale(1.05);
        }
        
        .remove-stop-btn {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            background-color: #ef4444; /* red-500 */
            color: white;
            border-radius: 8px;
            transition: background-color 0.2s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(239, 68, 68, 0.5);
        }
        .remove-stop-btn:hover {
            background-color: #dc2626; /* red-600 */
            transform: scale(1.05);
        }

        /* Dark Mode Overrides */
        .dark { 
            background-color: #111827; /* gray-900 */
            color: #f3f4f6; /* gray-100 */
        }
        .dark .header-bg { 
            background: linear-gradient(135deg, #4c1d95 0%, #10b981 100%); /* New darker header gradient */
        }
        .dark .main-card, 
        .dark .service-card, 
        .dark .auction-cta, 
        .dark .stroy-dom-cta, 
        .dark .modal, 
        .dark #faq-accordion > div,
        .dark .faq-item-content {
            background-color: #1f2937 !important; /* gray-800 */
            color: #e5e7eb !important; /* gray-200 */
        }
        
        /* Text color overrides for dark mode */
        .dark .text-gray-900, .dark .text-gray-800, .dark .text-gray-700 { color: #d1d5db !important; }
        .dark .text-gray-600 { color: #9ca3af !important; } /* gray-400 */
        .dark .text-gray-500 { color: #6b7280 !important; } /* gray-500 */
        .dark .text-blue-900 { color: #93c5fd !important; } /* blue-300 */
        .dark .text-emerald-800 { color: #a7f3d0 !important; }
        .dark .text-blue-600 { color: #60a5fa !important; }

        /* Border adjustments for dark mode */
        .dark .border-t { border-color: #374151 !important; } /* gray-700 */
        .dark .border { border-color: #374151 !important; }
        .dark .border-b { border-color: #374151 !important; }
        
        /* Specific Card adjustments for dark mode */
        .dark .main-card { border-color: #059669 !important; } /* green-600 */
        .dark .stroy-dom-cta { 
            border-color: #34d399 !important; /* emerald-400 */
            background-color: #064e3b !important; /* emerald-900 */
            color: #d1fae5 !important; /* emerald-100 */
            animation: pulse-dark-green 4s infinite;
        }
        .dark .auction-cta { border-color: #fbbf24 !important; } /* amber-400 */

        /* –ö–ª—é—á–µ–≤—ã–µ –∫–∞–¥—Ä—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ Dark Mode */
        @keyframes pulse-dark-green {
            0%, 100% { border-color: #34d399; } /* emerald-400 */
            50% { border-color: #059669; } /* emerald-600 */
        }

        /* Dark Mode Form Inputs */
        .dark .form-input-control {
            background-color: #374151; /* gray-700 */
            border-color: #4b5563; /* gray-600 */
            color: #f3f4f6; /* gray-100 */
        }
        .dark .form-input-control:focus {
            border-color: #60a5fa; /* blue-400 */
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.5);
        }
        /* Dark Mode Geo/Plus/Minus buttons */
        .dark .geo-btn { background-color: #b45309; } 
        .dark .geo-btn:hover { background-color: #92400e; } 
        .dark .add-stop-btn { background-color: #047857; } 
        .dark .add-stop-btn:hover { background-color: #065f46; }
        .dark .remove-stop-btn { background-color: #b91c1c; }
        .dark .remove-stop-btn:hover { background-color: #991b1b; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤–æ–π –¥–≤–æ–π–Ω–æ–π –∫–Ω–æ–ø–∫–∏ */
        .split-btn {
            display: flex;
            width: 100%;
            border-radius: 12px; 
            overflow: hidden; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .split-btn-part {
            flex: 1;
            padding: 0.75rem 0; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem; /* text-lg */
            transition: background-color 0.2s, transform 0.2s;
            text-align: center;
            line-height: 1.3;
            /* –í–∞–∂–Ω–æ –¥–ª—è –∫–Ω–æ–ø–æ–∫: –∫—É—Ä—Å–æ—Ä */
            cursor: pointer; 
        }
        .split-btn-part:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .split-btn-taxi {
            background-color: #10b981; /* emerald-500 */
            color: white;
            border-right: 1px solid rgba(255, 255, 255, 0.3); 
        }
        .split-btn-taxi:hover {
            background-color: #059669; /* emerald-600 */
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –õ–û–¢–ï–†–ï–Ø (–§–∏–æ–ª–µ—Ç–æ–≤—ã–π) */
        .split-btn-lottery {
            background-color: #8b5cf6; /* violet-500 */
            color: white;
        }
        .split-btn-lottery:hover {
            background-color: #7c3aed; /* violet-600 */
        }

        /* Dark Mode Overrides for Split Button */
        .dark .split-btn-taxi {
            background-color: #047857; /* emerald-700 dark */
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        .dark .split-btn-taxi:hover {
            background-color: #065f46; /* emerald-800 dark */
        }
        .dark .split-btn-lottery {
            background-color: #6d28d9; /* violet-700 dark */
        }
        .dark .split-btn-lottery:hover {
            background-color: #5b21b6; /* violet-800 dark */
        }

    </style>
</head>

<body class="text-gray-900 min-h-screen flex flex-col">

    <!-- HEADER -->
    <header class="header-bg text-white py-10 rounded-b-xl shadow-xl relative">
        
        <!-- –ö–ù–û–ü–ö–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –¢–ï–ú–´ -->
        <div class="absolute top-4 right-4">
            <button id="themeToggle" onclick="toggleTheme()" class="text-white p-2 rounded-full bg-black bg-opacity-10 hover:bg-opacity-30 transition-all focus:outline-none z-50">
                <i id="themeIcon" class="fas fa-moon text-xl"></i>
            </button>
        </div>
        
        <div class="max-w-md mx-auto px-4 text-center">
            <i class="fas fa-taxi text-4xl text-yellow-300 mb-2"></i>
            <h1 class="text-4xl font-extrabold tracking-tight mb-1">–¢–∞–∫—Å–∏ ¬´–£—Å–ø–µ—Ö¬ª</h1>
            <p class="text-white text-lg">–í–∞—à –∫–æ–º—Ñ–æ—Ä—Ç –≤ –ø–æ—Å—ë–ª–∫–µ –ë–µ–ª–æ—É—Å–æ–≤–∫–∞.</p>
        </div>
    </header>

    <!-- –ë–ê–ù–ù–ï–†: –û–ë–™–Ø–í–õ–ï–ù–ò–ï -->
    <div id="announcementBar" class="bg-red-500 text-white p-3 shadow-lg lg:hidden">
        <div class="max-w-3xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <i class="fas fa-exclamation-triangle text-xl"></i>
                <p id="announcementText" class="text-sm font-semibold">
                    –í–Ω–∏–º–∞–Ω–∏–µ! –ò–∑-–∑–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Å–ø—Ä–æ—Å–∞ –Ω–∞ —Ç–∞–∫—Å–∏ –∏–ª–∏ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –≤—Ä–µ–º—è –ø–æ–¥–∞—á–∏ –æ—Ç 15-20 –º–∏–Ω—É—Ç.
                </p>
            </div>
            <button onclick="dismissAnnouncement()" class="text-sm opacity-80 hover:opacity-100 transition">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    
    <!-- MAIN -->
    <main class="max-w-3xl mx-auto px-4 py-8 flex-grow">
        
        <!-- –ë–õ–û–ö 1: –û–°–ù–û–í–ù–û–ô –ó–ê–ö–ê–ó (–°—É–ø–µ—Ä CTA) -->
        <h2 class="text-2xl font-bold text-center mb-6 text-gray-700">–ë—ã—Å—Ç—Ä—ã–π –ó–∞–∫–∞–∑ –¢–∞–∫—Å–∏</h2>
        
        <div class="max-w-md mx-auto p-4 bg-white rounded-xl shadow-xl border-t-4 border-green-500 mb-6 main-card">
            
            <!-- –ö–ù–û–¢–ö–ê: –ó–ê–ö–ê–ó –ß–ï–†–ï–ó –§–û–†–ú–£ (–û–¢–ö–†–´–í–ê–ï–¢ –ú–û–î–ê–õ TAXI) -->
            <button data-service="taxi"
                class="service-btn btn-hover bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-bold transition-all shadow-lg flex items-center justify-center space-x-2 w-full py-3 text-lg mb-3">
                <i class="fas fa-car-side text-lg"></i><span>–ó–∞–∫–∞–∑ –¢–∞–∫—Å–∏</span>
            </button>
            
            <!-- 1. –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–¢–ö–ê –ó–ê–ö–ê–ó–ê (–†–ê–ó–î–ï–õ–ï–ù–ù–ê–Ø: –¢–ê–ö–°–ò + –õ–û–¢–ï–†–ï–Ø) -->
            <div class="split-btn mb-3">
                <!-- 1.1. –ó–ê–ö–ê–ó –¢–ê–ö–°–ò (WhatsApp) -->
                <a id="whatsappLink" href="https://wa.me/77770649648?text=%5B–ê–¥—Ä–µ—Å%20–û–¢–ö–£–î–ê%5D%20-%20%5B–ê–¥—Ä–µ—Å%20–ö–£–î–ê%5D." target="_blank"
                    class="btn-hover split-btn-part split-btn-taxi">
                    <span>–ó–∞–∫–∞–∑–∞—Ç—å –¢–∞–∫—Å–∏</span>
                </a>
                
                <!-- 1.2. –õ–û–¢–ï–†–ï–Ø (–í–º–µ—Å—Ç–æ –µ–¥—ã) -->
                <button onclick="showLotteryPrize()"
                    class="btn-hover split-btn-part split-btn-lottery">
                    <span>üé∞ –õ–æ—Ç–µ—Ä–µ—è</span>
                </button>
            </div>
            
            <!-- 2. –ë–õ–û–ö –ë–´–°–¢–†–´–• –î–ï–ô–°–¢–í–ò–ô (3 –∫–æ–ª–æ–Ω–∫–∏ - –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è —à–∏—Ä–∏–Ω–∞) -->
            <div class="grid grid-cols-3 gap-2 mb-4">
                <!-- –ü–æ–∑–≤–æ–Ω–∏—Ç—å (–û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä) -->
                <a href="tel:+77770649648"
                    class="btn-hover bg-red-600 hover:bg-red-700 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fas fa-phone-alt mb-0.5"></i><span>–ó–≤–æ–Ω–æ–∫</span>
                </a>
                <!-- Telegram (–û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä) -->
                <a href="https://t.me/TaxiUspehk" target="_blank"
                    class="btn-hover bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fab fa-telegram-plane mb-0.5"></i><span>Telegram</span>
                </a>
                <!-- –ê—É–∫—Ü–∏–æ–Ω (–û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä) -->
                <button data-service="auction"
                    class="service-btn btn-hover bg-yellow-500 hover:bg-yellow-600 text-white rounded-xl transition-all shadow-md quick-order-btn">
                    <i class="fas fa-gavel mb-0.5"></i><span>–ê—É–∫—Ü–∏–æ–Ω</span>
                </button>
            </div>
            
            <!-- –ë–õ–û–ö –ì–ï–û–õ–û–ö–ê–¶–ò–ò (–í–°–¢–†–û–ï–ù–ù–´–ô) -->
            <button type="button" onclick="getCurrentLocation('main')" id="locationBtn"
                class="w-full text-gray-700 font-semibold transition flex items-center justify-center space-x-3 shadow-inner">
                <i class="fas fa-location-arrow"></i>
                <span id="locationBtnText">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</span>
            </button>
            <p id="locationResult" class="text-xs text-center text-gray-500 mt-2 hidden">
                <a id="locationAddress" href="#" target="_blank" class="coord-link"></a>
            </p>
            
            <!-- –°–ü–û–°–û–ë–´ –û–ü–õ–ê–¢–´ (–ö–û–ú–ü–ê–ö–¢–ù–´–ô –ò–ù–§–û–ë–õ–û–ö) -->
            <div class="mt-4 pt-3 border-t border-gray-100 flex justify-center space-x-6 text-gray-600">
                <div class="flex items-center space-x-1">
                    <i class="fas fa-money-bill-wave text-xl text-green-500"></i>
                    <span class="font-semibold text-xs">–ù–∞–ª–∏—á–Ω—ã–µ</span>
                </div>
                <div class="flex items-center space-x-1">
                    <i class="fas fa-exchange-alt text-xl text-blue-500"></i>
                    <span class="font-semibold text-xs">–ü–µ—Ä–µ–≤–æ–¥ (Kaspi)</span>
                </div>
            </div>
            
        </div>
        
        <!-- –ù–û–í–´–ô –ë–õ–û–ö 2: –ú–ê–ì–ê–ó–ò–ù "–°–¢–†–û–ô –î–û–ú" (–ü–†–û–î–í–ò–ù–£–¢–´–ô –ü–ê–†–¢–ù–ï–†) -->
        <div class="mt-8 pt-4">
            <h3 class="text-2xl font-extrabold text-center mb-4 text-green-700">
                üõ†Ô∏è –°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã –ë–µ–ª–æ—É—Å–æ–≤–∫–∞
            </h3>
            <div class="stroy-dom-cta p-5 rounded-2xl flex flex-col sm:flex-row items-center justify-between text-blue-900 font-extrabold transition-all duration-300">
                <div class="flex flex-col items-center sm:items-start text-center sm:text-left mb-3 sm:mb-0">
                    <i class="fas fa-building text-4xl mb-1 text-emerald-600"></i>
                    <span class="text-2xl block leading-tight font-black text-emerald-800">–°–¢–†–û–ô –î–û–ú</span>
                    <span class="text-base text-gray-700 block mt-1">
                        –ú–∞–≥–∞–∑–∏–Ω —Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: <span class="font-bold">—É–ª. –Æ–±–∏–ª–µ–π–Ω–∞—è, 10</span>
                    </span>
                    <span class="text-sm text-gray-700 block mt-1">
                        –¢–µ–ª–µ—Ñ–æ–Ω: <a href="tel:+77764764606" class="text-blue-600 hover:text-blue-800 font-bold">+7 776 476 4606</a>
                    </span>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0">
                    <!-- WhatsApp (–ó–∞–ø—Ä–æ—Å –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã) -->
                    <a href="https://wa.me/77764764606?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–ò–Ω—Ç–µ—Ä–µ—Å—É—é—Ç%20—Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã%20–≤%20–º–∞–≥–∞–∑–∏–Ω–µ%20%22–°—Ç—Ä–æ–π%20–î–æ–º%22%20–ø–æ%20–∞–¥—Ä–µ—Å—É%20–Æ–±–∏–ª–µ–π–Ω–∞—è%2010." target="_blank"
                       class="bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fab fa-whatsapp mr-2"></i> WhatsApp
                    </a>
                    <!-- –ù–∞–≤–∏–≥–∞—Ç–æ—Ä -->
                    <a href="https://yandex.kz/maps/-/CLgm7KK9" target="_blank"
                       class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fas fa-map-marked-alt mr-2"></i> –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
                    </a>
                    <!-- Instagram -->
                    <a href="https://www.instagram.com/stroy_dom_bk" target="_blank"
                       class="bg-pink-600 hover:bg-pink-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fab fa-instagram mr-2"></i> Instagram
                    </a>
                </div>
            </div>
        </div>
        <!-- –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ë–õ–û–ö–ê "–°–¢–†–û–ô –î–û–ú" -->
        
        
        <!-- –ë–õ–û–ö 3 (–ë–´–í–®–ò–ô 2): –ù–ê–®–ò –£–°–õ–£–ì–ò - –û–ë–ù–û–í–õ–ï–ù–û –î–õ–Ø –ú–û–î–ê–õ–û–í -->
        <h3 class="text-2xl font-bold text-center mb-6 text-gray-700 border-t pt-8 mt-8">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –£—Å–ª—É–≥–∏ (–§–æ—Ä–º–∞)</h3>
        
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 max-w-md mx-auto mb-8">
            <!-- –î–æ—Å—Ç–∞–≤–∫–∞ (MODAL TRIGGER) -->
            <button data-service="delivery"
                class="service-btn service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-green-500">
                <i class="fas fa-box-open text-2xl mb-1 text-green-600"></i><span class="text-sm">–î–æ—Å—Ç–∞–≤–∫–∞</span>
            </button>
            <!-- –ì—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∏ (MODAL TRIGGER) -->
            <button data-service="cargo"
                class="service-btn service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-yellow-500">
                <i class="fas fa-truck-loading text-2xl mb-1 text-yellow-600"></i><span class="text-sm">–ì—Ä—É–∑–æ–≤–æ–π</span>
            </button>
            <!-- –¢—Ä–µ–∑–≤—ã–π –≤–æ–¥–∏—Ç–µ–ª—å (MODAL TRIGGER) -->
            <button data-service="soberDriver"
                class="service-btn service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-red-500">
                <i class="fas fa-cocktail text-2xl mb-1 text-red-600"></i><span class="text-sm">–¢—Ä–µ–∑–≤—ã–π –≤–æ–¥–∏—Ç–µ–ª—å</span>
            </button>
            <!-- –ü–æ–º–æ—â—å –Ω–∞ –¥–æ—Ä–æ–≥–µ (MODAL TRIGGER) -->
            <button data-service="assistance"
                class="service-btn service-card bg-white p-3 rounded-xl shadow-md flex flex-col items-center justify-center text-blue-900 font-semibold border-b-4 border-indigo-500">
                <i class="fas fa-life-ring text-2xl mb-1 text-indigo-600"></i><span class="text-sm">–ü–æ–º–æ—â—å</span>
            </button>
        </div>


        <!-- –ë–õ–û–ö 4 (–ë–´–í–®–ò–ô 3): –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø (–ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –°–ï–¢–ö–ê) -->
        <h3 class="text-xl font-bold text-center mb-4 text-gray-700 border-t pt-4">–ë—ã—Å—Ç—Ä—ã–µ –î–µ–π—Å—Ç–≤–∏—è</h3>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 max-w-md mx-auto mb-8">
            
            <!-- 1. –û—Ü–µ–Ω–∫–∞ –°–µ—Ä–≤–∏—Å–∞ -->
            <a href="https://wa.me/77770649648?text=–û—Ü–µ–Ω–∏—Ç–µ%20—Ä–∞–±–æ—Ç—É%20—Ç–∞–∫—Å–∏%20%C2%AB–£—Å–ø–µ—Ö%C2%BB%20–ø–æ%20—à–∫–∞–ª–µ%20–æ—Ç%201%20(–ü–ª–æ—Ö–æ)%20–¥–æ%205%20(–û—Ç–ª–∏—á–Ω–æ)." target="_blank"
                class="btn-hover bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-star text-xl mb-1"></i><span>–û—Ü–µ–Ω–∫–∞</span>
            </a>
            
            <!-- 2. –û–±—Ä–∞—Ç–Ω—ã–π –ó–≤–æ–Ω–æ–∫ -->
            <a href="https://wa.me/77770649648?text=–ü—Ä–æ—à—É%20–ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å%20–º–Ω–µ%20–∫–∞–∫%20–º–æ–∂–Ω–æ%20—Å–∫–æ—Ä–µ–µ!" target="_blank"
                class="btn-hover bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-headset text-xl mb-1"></i><span>–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å</span>
            </a>
            
            <!-- 3. PWA (–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –ì–ª–∞–≤–Ω—ã–π –≠–∫—Ä–∞–Ω) -->
            <button onclick="showPWAInstructions()" 
                class="btn-hover bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-mobile-alt text-xl mb-1"></i><span>–ù–∞ –ì–ª–∞–≤–Ω—ã–π –≠–∫—Ä–∞–Ω</span>
            </button>
            
            <!-- 4. –ü–∞—Ä—Ç–Ω–µ—Ä—ã (–†–µ–∫–ª–∞–º–∞) -->
            <button onclick="showPartnerModal()" 
                class="btn-hover bg-pink-600 hover:bg-pink-700 text-white rounded-xl shadow-lg transition-all compact-util-btn">
                <i class="fas fa-handshake text-xl mb-1"></i><span>–ü–∞—Ä—Ç–Ω–µ—Ä—ã</span>
            </button>
        </div>


        <!-- –ë–õ–û–ö 5 (–ë–´–í–®–ò–ô 4): –¢–µ—Ö–û—Å–º–æ—Ç—Ä (–ü–ê–†–¢–ù–ï–†–°–ö–ê–Ø –†–ï–ö–õ–ê–ú–ê) -->
        <div class="mt-8 border-t pt-6">
            <h3 class="text-xl font-bold text-center mb-4 text-gray-700">–ù–∞—à–∏–º –ü–∞—Ä—Ç–Ω–µ—Ä–∞–º: –¢–µ—Ö–û—Å–º–æ—Ç—Ä</h3>
            <div class="auction-cta p-5 rounded-2xl flex flex-col sm:flex-row items-center justify-between text-blue-900 font-extrabold transition-all duration-300 border-indigo-500 border-2">
                <div class="flex flex-col items-center sm:items-start text-center sm:text-left mb-3 sm:mb-0">
                    <i class="fas fa-wrench text-3xl mb-1 text-red-600"></i>
                    <span class="text-xl block leading-tight font-black text-red-600">–¢–ï–•–û–°–ú–û–¢–† –í –ë–ï–õ–û–£–°–û–í–ö–ï!</span>
                    <span class="text-sm text-gray-700 block mt-1">
                        –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¢–û: <span class="font-bold">—É–ª. –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è, 37</span>
                    </span>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0">
                    <a href="https://wa.me/77771383856?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20–∑–∞–ø–∏—Å–∞—Ç—å—Å—è%20–Ω–∞%20–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π%20–û—Å–º–æ—Ç—Ä%20–ø–æ%20–∞–¥—Ä–µ—Å—É%20–ú–æ–ª–æ–¥–µ–∂–Ω–∞—è%2037." target="_blank"
                       class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fab fa-whatsapp mr-2"></i> WhatsApp
                    </a>
                    <!-- –ù–û–í–ê–Ø –ö–ù–û–¢–ö–ê: –ù–ê–í–ò–ì–ê–¢–û–† -->
                    <a href="https://yandex.kz/navi/-/CLGK5Sli" target="_blank"
                       class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fas fa-map-marked-alt mr-2"></i> –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
                    </a>
                    <!-- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –ö–ù–û–¢–ö–ê: –ó–í–û–ù–û–ö -->
                    <a href="tel:+77771383856"
                       class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-xl shadow-md text-sm whitespace-nowrap transition-all flex items-center justify-center">
                        <i class="fas fa-phone-alt mr-2"></i> –ó–≤–æ–Ω–æ–∫
                    </a>
                </div>
            </div>
        </div>

        
        <!-- –ë–õ–û–ö 6 (–ë–´–í–®–ò–ô 5): FAQ –∏ –ü–†–ê–ô–°-–õ–ò–°–¢ (–ê–ö–ö–û–†–î–ï–û–ù) -->
        <div class="mt-10 border-t pt-6 max-w-lg mx-auto">
            <h3 class="text-2xl font-bold text-center text-gray-700 mb-6">–í–æ–ø—Ä–æ—Å—ã –∏ –¶–µ–Ω—ã</h3>
            
            <div id="faq-accordion" class="space-y-4">
                <!-- –í–æ–ø—Ä–æ—Å 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-1')">
                        <span>üí∞ –ö–∞–∫–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏?</span>
                        <i id="icon-faq-1" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-1" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏ –ø–æ –ë–µ–ª–æ—É—Å–æ–≤–∫–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç **700 —Ç–µ–Ω–≥–µ**. –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ —Ç–µ–∫—É—â–µ–π –¥–æ—Ä–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.</p>
                    </div>
                </div>
                
                <!-- –í–æ–ø—Ä–æ—Å 2: –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-4')">
                        <span>üì¶ –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —É—Å–ª—É–≥–∞ –î–æ—Å—Ç–∞–≤–∫–∏?</span>
                        <i id="icon-faq-4" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-4" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è **–æ—Ç 1200 KZT**.</p>
                        <p class="mt-2 text-sm italic">–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—â–µ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –æ–±—ä—ë–º–∞ –ø–æ–∫—É–ø–æ–∫.</p>
                    </div>
                </div>

                <!-- –í–æ–ø—Ä–æ—Å 3: –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-2')">
                        <span>‚è∞ –ö–∞–∫–æ–π —É –≤–∞—Å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã?</span>
                        <i id="icon-faq-2" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-2" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p>**–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ (24/7)**, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —É–µ—Ö–∞—Ç—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –¥–Ω—è –∏ –Ω–æ—á–∏.</p>
                    </div>
                </div>

                <!-- –í–æ–ø—Ä–æ—Å 4: –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (–û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö) -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden faq-item">
                    <button class="w-full text-left p-4 flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none" onclick="toggleAccordion('faq-3')">
                        <span>üìç –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ –ú–µ–∂–≥–æ—Ä–æ–¥ –∏ –ø—Ä–∏–≥–æ—Ä–æ–¥</span>
                        <i id="icon-faq-3" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div id="faq-3" class="hidden p-4 pt-0 text-gray-600 border-t border-gray-100 faq-item-content">
                        <p class="font-bold text-red-600 mb-2">
                            ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –¶–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ!
                        </p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>**–ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:** **230 ‚Ç∏** –∑–∞ 1 –∫–º.</li>
                            <li>–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫: **4800‚Äî6210 ‚Ç∏**</li>
                            <li>–ì–ª—É–±–æ–∫–æ–µ: **–æ—Ç 4200 ‚Ç∏**</li>
                            <li>–ù–æ–≤–∞—è –ë—É—Ö—Ç–∞—Ä–º–∞: **–æ—Ç 24150 ‚Ç∏**</li>
                            <li>–†–∏–¥–¥–µ—Ä: **–æ—Ç 25300 ‚Ç∏**</li>
                            <li>–®–µ–º–æ–Ω–∞–∏—Ö–∞: **–æ—Ç 20700 ‚Ç∏**</li>
                            <li>–ê–ª—Ç–∞–π (–ó—ã—Ä—è–Ω–æ–≤—Å–∫): **–æ—Ç 45540 ‚Ç∏**</li>
                            <li>–£—Å—Ç—å-–¢–∞–ª–æ–≤–∫–∞: **–æ—Ç 19780 ‚Ç∏**</li>
                            <li>–°–µ–∫–∏—Å–æ–≤–∫–∞: **–æ—Ç 6440 ‚Ç∏**</li>
                            <li>–ë–µ–ª–æ–∫–∞–º–µ–Ω–∫–∞: **–æ—Ç 3500 ‚Ç∏**</li>
                            <li>–ú–∏—Ö–∞–π–ª–æ–≤–∫–∞: **–æ—Ç 4000 ‚Ç∏**</li>
                            <li>–ü—Ä–æ–≥—Ä–µ—Å—Å: **2990‚Äî3500 ‚Ç∏**</li>
                            <li>–ß–µ—Ä–Ω–æ–≥–æ—Ä–∫–∞: **2100‚Äî3000 ‚Ç∏**</li>
                            <li>–ö—Ä–∞—Å–Ω—ã–π –ü–∞—Ä—Ç–∏–∑–∞–Ω: **1800‚Äî2500 ‚Ç∏**</li>
                            <li>–ü–ª–∞–Ω–∏–¥–æ–≤–∫–∞: **2100‚Äî2500 ‚Ç∏**</li>
                            <li>–¢–∞—Ä—Ö–∞–Ω–∫–∞: **11270‚Äî12200 ‚Ç∏**</li>
                            <li>–ü—Ä–µ–¥–≥–æ—Ä–Ω–æ–µ: **8500‚Äî10000 ‚Ç∏**</li>
                            <li>–ø–æ—Å—ë–ª–æ–∫ –ê–ª—Ç–∞–π—Å–∫–∏–π: **6000‚Äî8000 ‚Ç∏**</li>
                        </ul>
                        <p class="mt-4 font-bold text-gray-700">–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –∏–∑-–∑–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:</p>
                        <ul class="list-disc list-inside mt-2 space-y-1 text-sm text-gray-500">
                            <li>**‚è∞ –í—Ä–µ–º—è —Å—É—Ç–æ–∫:** –ù–æ—á–Ω—ã–µ —Å–º–µ–Ω—ã (–ø–æ—Å–ª–µ 00:00) –¥–æ—Ä–æ–∂–µ.</li>
                            <li>**üåßÔ∏è –ü–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:** –ì–æ–ª–æ–ª–µ–¥, –º–µ—Ç–µ–ª—å –∏–ª–∏ –ø–ª–æ—Ö–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å.</li>
                            <li>**üõ£Ô∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Ä–æ–≥–∏:** –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –±–µ–∑–¥–æ—Ä–æ–∂—å—è –∏–ª–∏ —Ä–µ–º–æ–Ω—Ç–∞.</li>
                            <li>**üÖøÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:** –ü—Ä–æ—Å—Ç–æ–π –≤ –ø—É—Ç–∏, –æ–∂–∏–¥–∞–Ω–∏–µ –∏–ª–∏ –∑–∞–µ–∑–¥ –≤ –¥—Ä—É–≥–æ–π –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π –ø—É–Ω–∫—Ç.</li>
                        </ul>
                        <p class="mt-2 text-sm italic text-gray-600">–¢–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏.</p>
                    </div>
                </div>
                
            </div>
        </div>
        
        <!-- –ë–õ–û–ö 7 (–ë–´–í–®–ò–ô 6): –†–ï–ö–õ–ê–ú–ê –î–õ–Ø –ü–ê–†–¢–ù–ï–†–û–í -->
        <div class="mt-10 border-t pt-6">
            <h3 class="text-xl font-bold text-pink-600 mb-6 text-center">üì¢ –†–µ–∫–ª–∞–º–∞ –¥–ª—è –í–∞—à–µ–≥–æ –ë–∏–∑–Ω–µ—Å–∞</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                
                <!-- –°–ª–æ—Ç 1: –ú–ê–ì–ê–ó–ò–ù/–¢–û–ß–ö–ê –ü–†–û–î–ê–ñ -->
                <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20—Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å%20—Ä–µ–∫–ª–∞–º—É%20—Å–≤–æ–µ–≥–æ%20–º–∞–≥–∞–∑–∏–Ω–∞%20(–ü—Ä–æ–¥—É–∫—Ç—ã/–û–¥–µ–∂–¥–∞)." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-pink-500 flex flex-col items-center text-center">
                    <i class="fas fa-store text-4xl text-pink-500 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–ú–∞–≥–∞–∑–∏–Ω –∏–ª–∏ –¢–æ—á–∫–∞ –ü—Ä–æ–¥–∞–∂</p>
                    <p class="text-sm text-gray-600">–ü—Ä–∏–≤–ª–µ–∫–∞–π—Ç–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∫ –≤–∞—à–µ–º—É —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É. **(WhatsApp)**</p>
                </a>
                
                <!-- –°–ª–æ—Ç 2: –£–°–õ–£–ì–ò/–°–ï–†–í–ò–° -->
                <a href="https://wa.me/77770649648?text=–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç%20—Ä–µ–∫–ª–∞–º–∞%20–º–æ–∏—Ö%20—É—Å–ª—É–≥%20(–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫/–†–µ–º–æ–Ω—Ç).%20–ü—Ä–∏—à–ª–∏—Ç–µ%20—É—Å–ª–æ–≤–∏—è." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-red-500 flex flex-col items-center text-center">
                    <i class="fas fa-tools text-4xl text-red-500 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–£—Å–ª—É–≥–∏, –°–µ—Ä–≤–∏—Å –∏–ª–∏ –ú–∞—Å—Ç–µ—Ä</p>
                    <p class="text-sm text-gray-600">–ù–∞–π–¥–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–µ–º–æ–Ω—Ç, –¥–æ—Å—Ç–∞–≤–∫—É –∏–ª–∏ –±—ã—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏. **(–£–∑–Ω–∞—Ç—å —Ü–µ–Ω—É)**</p>
                </a>

                <!-- –°–ª–æ—Ç 3: –°–ü–ï–¶–ò–ê–õ–¨–ù–ê–Ø –ê–ö–¶–ò–Ø -->
                <a href="https://wa.me/77770649648?text=–•–æ—á—É%20–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å%20–º–µ—Å—Ç–æ%20–¥–ª—è%20—Ä–µ–∫–ª–∞–º—ã%20–≥–æ—Ä—è—á–∏—Ö%20–∞–∫—Ü–∏–π." target="_blank"
                    class="partner-card service-card bg-white p-4 rounded-xl shadow-lg border-yellow-600 flex flex-col items-center text-center">
                    <i class="fas fa-bullhorn text-4xl text-yellow-600 mb-2"></i>
                    <p class="text-lg font-bold text-gray-800">–ì–æ—Ä—è—á–∞—è –ê–∫—Ü–∏—è / –û–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
                    <p class="text-sm text-gray-600">–ú–µ—Å—Ç–æ –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –∏–ª–∏ —Å–µ–∑–æ–Ω–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π. **(–°–≤—è–∑–∞—Ç—å—Å—è)**</p>
                </a>

            </div>
        </div>
        
        <!-- –ë–õ–û–ö 8 (–ë–´–í–®–ò–ô 7): –ü–†–ò–ì–õ–ê–®–ï–ù–ò–ï –í–û–î–ò–¢–ï–õ–ï–ô -->
        <div class="mt-10 border-t pt-6 text-center">
            <h3 class="text-2xl font-bold text-gray-700 mb-4">–ü—Ä–∏–≥–ª–∞—à–∞–µ–º –í–æ–¥–∏—Ç–µ–ª–µ–π –≤ –∫–æ–º–∞–Ω–¥—É!</h3>
            <p class="text-gray-600 mb-4 max-w-md mx-auto">
                –•–æ—Ç–∏—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –∏ –±—ã—Ç—å —á–∞—Å—Ç—å—é —É—Å–ø–µ—à–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ –ë–µ–ª–æ—É—Å–æ–≤–∫–µ?
            </p>
            <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20—Å—Ç–∞—Ç—å%20–≤–æ–¥–∏—Ç–µ–ª–µ–º%20—Ç–∞–∫—Å–∏%20%C2%AB–£—Å–ø–µ—Ö%C2%BB.%20–£–∫–∞–∂–∏—Ç–µ%2C%20–ø–æ–∂–∞–ª—É–π—Å—Ç–∞%2C%20—É—Å–ª–æ–≤–∏—è%20–∏%20—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è." target="_blank"
               class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-xl text-xl font-semibold shadow-lg transition-all btn-hover">
                <i class="fas fa-car-side mr-2"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ó–∞—è–≤–∫—É –í–æ–¥–∏—Ç–µ–ª—è
            </a>
            <p class="text-sm text-gray-500 mt-4">
                –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ WhatsApp, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –≤—Å–µ —É—Å–ª–æ–≤–∏—è.
            </p>
        </div>
        
        <!-- –ë–õ–û–ö 9 (–ë–´–í–®–ò–ô 8): –í—Ö–æ–¥ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è -->
        <div class="mt-6 border-t pt-6 text-center">
            <h3 class="text-xl font-bold text-gray-700 mb-4">–î–ª—è –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π</h3>
            <a href="https://chat.whatsapp.com/Ke2bt9sD8VfCFmZ1LeEcqe" target="_blank"
               class="inline-block bg-pink-600 hover:bg-pink-700 text-white px-8 py-3 rounded-xl text-lg font-semibold shadow-lg transition-all">
                <i class="fas fa-user-shield mr-2"></i> –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –í–æ–¥–∏—Ç–µ–ª—è
            </a>
            <p class="text-sm text-gray-500 mt-2">
                –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞–∫—Ä—ã—Ç—É—é –≥—Ä—É–ø–ø—É –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–∫–∞–∑–æ–≤.
            </p>
        </div>
        
    </main>

    <!-- –ù–∞–≤–∏–≥–∞—Ç–æ—Ä -->
    <section class="bg-blue-700 py-6 text-center mt-10 shadow-inner">
        <h3 class="text-xl font-bold text-white mb-3">üó∫ –û—Ç–∫—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å.–ù–∞–≤–∏–≥–∞—Ç–æ—Ä</h3>
        <a href="https://yandex.kz/navi" target="_blank"
            class="inline-block bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-3 rounded-xl text-lg font-semibold shadow-lg transition-all">
            <i class="fas fa-location-arrow mr-2"></i> –û—Ç–∫—Ä—ã—Ç—å –ù–∞–≤–∏–≥–∞—Ç–æ—Ä
        </a>
    </section>

    <!-- –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ô –ù–ò–ñ–ù–ò–ô –ë–ê–† (–î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–•) -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-2xl z-40 sm:hidden">
        <div class="flex justify-around items-center h-16">
            <!-- 1. –ó–∞–∫–∞–∑ (WhatsApp) -->
            <a href="https://wa.me/77770649648?text=%5B–ê–¥—Ä–µ—Å%20–û–¢–ö–£–î–ê%5D%20-%20%5B–ê–¥—Ä–µ—Å%20–ö–£–î–ê%5D." class="flex flex-col items-center text-green-600 hover:text-green-700">
                <i class="fab fa-whatsapp text-2xl"></i>
                <span class="text-xs mt-0.5">–ó–∞–∫–∞–∑</span>
            </a>
            <!-- 2. –ó–≤–æ–Ω–æ–∫ -->
            <a href="tel:+77770649648" class="flex flex-col items-center text-red-600 hover:text-red-700">
                <i class="fas fa-phone-alt text-2xl"></i>
                <span class="text-xs mt-0.5">–ó–≤–æ–Ω–æ–∫</span>
            </a>
            <!-- 3. –î–æ—Å—Ç–∞–≤–∫–∞ -->
            <a data-service="delivery" class="service-btn flex flex-col items-center text-yellow-600 hover:text-yellow-700">
                <i class="fas fa-box-open text-2xl"></i>
                <span class="text-xs mt-0.5">–î–æ—Å—Ç–∞–≤–∫–∞</span>
            </a>
            <!-- 4. –í–æ–¥–∏—Ç–µ–ª—å -->
            <a href="https://chat.whatsapp.com/Ke2bt9sD8VfCFmZ1LeEcqe" target="_blank" class="flex flex-col items-center text-pink-600 hover:text-pink-700">
                <i class="fas fa-user-shield text-2xl"></i>
                <span class="text-xs mt-0.5">–í–æ–¥–∏—Ç–µ–ª—å</span>
            </a>
        </div>
    </div>


    <!-- FOOTER -->
    <footer class="bg-gray-800 text-white text-center py-6 mt-10">
        <!-- –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –¢–ï–ö–°–¢ –§–£–¢–ï–†–ê -->
        <p class="text-sm px-4">
            <span class="font-bold">¬© 2025 ¬´–£—Å–ø–µ—Ö –¢–∞–∫—Å–∏¬ª</span>. 
            ¬´—Ç–∞–∫—Å–∏ –£—Å–ø–µ—Ö¬ª ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å. 
            –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∏ –∏–Ω—ã–µ —É—Å–ª—É–≥–∏ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞.
        </p>
        <p class="text-sm mt-2">
            –°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤–æ—Å—Ç—è–º–∏:
            <a href="https://whatsapp.com/channel/0029VajWGmEI1rcfICmXlJ01"
               class="text-green-400 hover:text-green-300 underline">WhatsApp-–∫–∞–Ω–∞–ª</a>
        </p>
    </footer>

    <!-- ========================================================= -->
    <!-- 1. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –¢–ê–ö–°–ò (TAXI) -->
    <!-- ========================================================= -->
    <div id="taxiModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üöï –ó–∞–∫–∞–∑–∞—Ç—å –¢–∞–∫—Å–∏</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="taxiModal">√ó</button>
                </div>
                
                <form id="taxiForm" class="space-y-4">
                    
                    <div id="addressInputsTaxi">
                        <!-- –ê–î–†–ï–° –û–¢–ö–£–î–ê (—Å –∫–Ω–æ–ø–∫–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏) -->
                        <div class="flex flex-col">
                            <label for="taxiFrom" class="text-sm font-medium text-gray-700 mb-1">–û—Ç–∫—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="taxiFrom" name="from" type="text" list="fromHistory" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required oninput="updateTaxiPrice()">
                                <datalist id="fromHistory"></datalist>
                                <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                                <button type="button" onclick="getCurrentLocation('taxi')" 
                                    class="geo-btn" 
                                    title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                    <i id="taxiGeoIcon" class="fas fa-compass"></i>
                                </button>
                            </div>
                        </div>
                        <!-- –ê–î–†–ï–° –ö–£–î–ê (—Å –∫–Ω–æ–ø–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è) -->
                        <div class="flex flex-col">
                            <label for="taxiTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="taxiTo" name="to" type="text" list="toHistory" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º/–æ–±—ä–µ–∫—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required oninput="updateTaxiPrice()">
                                <datalist id="toHistory"></datalist>
                                <!-- –ö–ù–û–ü–ö–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ê–î–†–ï–°–ê -->
                                <button type="button" onclick="addStop('additionalStops', 'taxi')" 
                                    class="add-stop-btn" 
                                    title="–î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –ø–æ –ø—É—Ç–∏">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤. oninput –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã -->
                            <div id="additionalStops" class="mt-2 space-y-2" oninput="updateTaxiPrice()"></div>
                        </div>
                    </div>
                    
                    <!-- –ë–õ–û–ö –ü–†–ï–î–ó–ê–ö–ê–ó–ê -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg space-y-3 dark:bg-gray-700 dark:border-gray-600">
                        <p class="text-sm font-bold text-blue-700 flex items-center dark:text-blue-300"><i class="fas fa-calendar-alt mr-2"></i> –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å (–ü—Ä–µ–¥–∑–∞–∫–∞–∑)</p>
                        <!-- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è -->
                        <div class="flex flex-col">
                            <label for="taxiDateTime" class="text-xs font-medium text-gray-600 mb-1">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏</label>
                            <input id="taxiDateTime" name="dateTime" type="datetime-local" class="form-input-control">
                        </div>
                        <!-- –ü–æ–∂–µ–ª–∞–Ω–∏—è -->
                        <div class="flex flex-col">
                            <label for="taxiWishes" class="text-xs font-medium text-gray-600 mb-1">–ü–æ–∂–µ–ª–∞–Ω–∏—è (–¥–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ, –±–æ–ª—å—à–æ–π –±–∞–≥–∞–∂–Ω–∏–∫)</label>
                            <textarea id="taxiWishes" name="wishes" rows="2" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù—É–∂–Ω–æ –¥–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ, –º–∞—à–∏–Ω–∞ –ø–æ–±–æ–ª—å—à–µ."></textarea>
                        </div>
                    </div>
                    <!-- –ö–û–ù–ï–¶ –ë–õ–û–ö–ê –ü–†–ï–î–ó–ê–ö–ê–ó–ê -->

                    <!-- –ù–û–í–û–ï –ü–û–õ–ï: –ù–æ–º–µ—Ä –ü–∞—Å—Å–∞–∂–∏—Ä–∞ (–µ–¥–∏–Ω–æ–µ –ø–æ–ª–µ) -->
                    <div class="flex flex-col">
                        <label for="passengerPhone" class="text-sm font-medium text-gray-700 mb-1">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏ (–ø–∞—Å—Å–∞–∂–∏—Ä–∞, –µ—Å–ª–∏ –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç–µ –¥—Ä—É–≥–æ–º—É)</label>
                        <input id="passengerPhone" name="passengerPhone" type="tel" class="form-input-control" placeholder="+7...">
                    </div>


                    <div id="taxiStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-gray-500">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <!-- –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã -->
                            <div id="taxiPriceEstimate" class="price-estimate text-xl font-bold text-green-600">–æ—Ç 700‚Äì900 —Ç–≥</div>
                            <div class="price-note text-xs text-red-600 font-semibold">–í–Ω–∏–º–∞–Ω–∏–µ: —Ç–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–æ–¥–∏—Ç–µ–ª–µ–º.</div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –ó–∞–∫–∞–∑–∞—Ç—å
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- 2. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –î–û–°–¢–ê–í–ö–ê (DELIVERY) -->
    <!-- ========================================================= -->
    <div id="deliveryModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üõçÔ∏è –î–æ—Å—Ç–∞–≤–∫–∞ –¢–æ–≤–∞—Ä–æ–≤</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="deliveryModal">√ó</button>
                </div>
                <form id="deliveryForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="deliveryItems" class="text-sm font-medium text-gray-700 mb-1">–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ *</label>
                        <textarea id="deliveryItems" name="items" rows="3" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Ö–ª–µ–±, –ø–∏–≤–æ, –æ–≥—É—Ä—Ü—ã 1 –∫–≥" required></textarea>
                    </div>
                    <div class="flex flex-col">
                        <label for="deliveryStore" class="text-sm font-medium text-gray-700 mb-1">–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –º–∞–≥–∞–∑–∏–Ω—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input id="deliveryStore" name="store" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞–≥–∞–∑–∏–Ω ‚Ññ1, –°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç" />
                    </div>
                    <!-- –ê–î–†–ï–° –î–û–°–¢–ê–í–ö–ò (—Å –∫–Ω–æ–ø–∫–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏) -->
                    <div class="flex flex-col">
                        <label for="deliveryAddress" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                        <div class="input-with-plus-btn">
                            <input id="deliveryAddress" name="address" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –õ–µ–Ω–∏–Ω–∞ 12)" required />
                            <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                            <button type="button" onclick="getCurrentLocation('delivery')" 
                                class="geo-btn" 
                                title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                <i id="deliveryGeoIcon" class="fas fa-compass"></i>
                            </button>
                        </div>
                    </div>

                    <div id="deliveryStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-gray-500">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate text-xl font-bold text-green-600">–æ—Ç 1200 —Ç–≥</div>
                            <div class="price-note text-xs font-semibold text-gray-600">–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –æ–±—ä—ë–º–∞ –ø–æ–∫—É–ø–æ–∫.</div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ========================================================= -->
    <!-- 3. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ì–†–£–ó–û–í–û–ô (CARGO) -->
    <!-- ========================================================= -->
    <div id="cargoModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üöö –ì—Ä—É–∑–æ–≤—ã–µ –ü–µ—Ä–µ–≤–æ–∑–∫–∏</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="cargoModal">√ó</button>
                </div>
                <form id="cargoForm" class="space-y-4">
                    <!-- –ê–î–†–ï–° –ü–û–ì–†–£–ó–ö–ò (—Å –∫–Ω–æ–ø–∫–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏) -->
                    <div class="flex flex-col">
                        <label for="cargoFrom" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏ *</label>
                        <div class="input-with-plus-btn">
                            <input id="cargoFrom" name="from" type="text" class="form-input-control" placeholder="–û—Ç–∫—É–¥–∞ –∑–∞–±—Ä–∞—Ç—å –≥—Ä—É–∑" required>
                            <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                            <button type="button" onclick="getCurrentLocation('cargo')" 
                                class="geo-btn" 
                                title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                <i id="cargoGeoIcon" class="fas fa-compass"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <label for="cargoTo" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å –≤—ã–≥—Ä—É–∑–∫–∏ *</label>
                        <input id="cargoTo" name="to" type="text" class="form-input-control" placeholder="–ö—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä—É–∑" required>
                    </div>
                    <div class="flex flex-col">
                        <label for="cargoDescription" class="text-sm font-medium text-gray-700 mb-1">–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–∑–∞ *</label>
                        <textarea id="cargoDescription" name="description" rows="2" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1 —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ –∏ 5 –∫–æ—Ä–æ–±–æ–∫" required></textarea>
                    </div>
                    
                    <!-- –ë–õ–û–ö –ü–†–ï–î–ó–ê–ö–ê–ó–ê (–ù–û–í–´–ô –¥–ª—è CARGO) -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg space-y-3 dark:bg-gray-700 dark:border-gray-600">
                        <p class="text-sm font-bold text-blue-700 flex items-center dark:text-blue-300"><i class="fas fa-calendar-alt mr-2"></i> –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å (–ü—Ä–µ–¥–∑–∞–∫–∞–∑)</p>
                        <!-- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è -->
                        <div class="flex flex-col">
                            <label for="cargoDateTime" class="text-xs font-medium text-gray-600 mb-1">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–≥—Ä—É–∑–∫–∏</label>
                            <input id="cargoDateTime" name="dateTime" type="datetime-local" class="form-input-control">
                        </div>
                    </div>
                    <!-- –ö–û–ù–ï–¶ –ë–õ–û–ö–ê –ü–†–ï–î–ó–ê–ö–ê–ó–ê -->
                    
                    <!-- –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö: –ö–û–õ–ò–ß–ï–°–¢–í–û –ì–†–£–ó–ß–ò–ö–û–í (Select) -->
                    <div class="flex flex-col">
                        <label for="cargoMovers" class="text-sm font-medium text-gray-700 mb-1">–ì—Ä—É–∑—á–∏–∫–∏</label>
                        <div class="input-with-plus-btn flex-col items-start sm:flex-row sm:items-center">
                            <select id="cargoMovers" name="movers" class="form-input-control sm:flex-grow" required onchange="updateCargoPrice()">
                                <option value="0">–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è (0 —á–µ–ª–æ–≤–µ–∫)</option>
                                <option value="1">1 —á–µ–ª–æ–≤–µ–∫</option>
                                <option value="2">2 —á–µ–ª–æ–≤–µ–∫–∞</option>
                                <option value="3">3 —á–µ–ª–æ–≤–µ–∫–∞</option>
                                <option value="4">4 —á–µ–ª–æ–≤–µ–∫–∞ (–ú–∞–∫—Å–∏–º—É–º)</option>
                            </select>
                            <span class="text-sm font-bold text-red-600 mt-2 sm:mt-0">(–î–æ–ø–ª–∞—Ç–∞: +3000 —Ç–≥/—á–∞—Å –∑–∞ –∫–∞–∂–¥–æ–≥–æ)</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.</p>
                    </div>
                    <!-- –ö–û–ù–ï–¶ –û–ë–ù–û–í–õ–ï–ù–ù–û–ì–û –ë–õ–û–ö–ê -->

                    <div id="cargoStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-gray-500">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (–∑–∞ 1 —á–∞—Å):</div>
                            <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                            <div id="cargoTotalPrice" class="price-estimate text-xl font-bold text-green-600">6000 —Ç–≥</div>
                            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                            <div id="cargoPriceNote" class="price-note text-xs font-semibold text-gray-600">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ - 1 —á–∞—Å.</div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –ó–∞–∫–∞–∑–∞—Ç—å –≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫—É
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- 4. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨ (SOBER DRIVER) -->
    <!-- ========================================================= -->
    <div id="soberDriverModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üîë –¢—Ä–µ–∑–≤—ã–π –í–æ–¥–∏—Ç–µ–ª—å</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="soberDriverModal">√ó</button>
                </div>
                <form id="soberDriverForm" class="space-y-4">
                    <!-- –í–ê–® –¢–ï–ö–£–©–ò–ô –ê–î–†–ï–° (—Å –∫–Ω–æ–ø–∫–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏) -->
                    <div class="flex flex-col">
                        <label for="soberDriverFrom" class="text-sm font-medium text-gray-700 mb-1">–í–∞—à —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å *</label>
                        <div class="input-with-plus-btn">
                            <input id="soberDriverFrom" name="from" type="text" class="form-input-control" placeholder="–ê–¥—Ä–µ—Å, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–≤—Ç–æ" required>
                            <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                            <button type="button" onclick="getCurrentLocation('soberDriver')" 
                                class="geo-btn" 
                                title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                <i id="soberDriverGeoIcon" class="fas fa-compass"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- –ù–û–í–û–ï –ü–û–õ–ï: –ú–∞—Ä–∫–∞ –∏ –ú–æ–¥–µ–ª—å –ê–≤—Ç–æ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û) -->
                    <div class="flex flex-col">
                        <label for="soberDriverCarModel" class="text-sm font-medium text-gray-700 mb-1">–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ *</label>
                        <input id="soberDriverCarModel" name="carModel" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota Camry, Lexus 570" required>
                    </div>
                    <!-- –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ü–û–õ–Ø -->
                    
                    <div class="flex flex-col">
                        <label for="soberDriverTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å *</label>
                        <input id="soberDriverTo" name="to" type="text" class="form-input-control" placeholder="–ö–æ–Ω–µ—á–Ω—ã–π –∞–¥—Ä–µ—Å" required>
                    </div>

                    <div id="soberDriverStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-gray-500">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate text-xl font-bold text-green-600">–æ—Ç 3800 —Ç–≥</div>
                            <div class="price-note text-xs font-semibold text-gray-600">–¶–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è.</div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –í—ã–∑–≤–∞—Ç—å –≤–æ–¥–∏—Ç–µ–ª—è
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ========================================================= -->
    <!-- 5. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ü–û–ú–û–©–¨ / –ü–û–†–£–ß–ï–ù–ò–Ø (ASSISTANCE) -->
    <!-- ========================================================= -->
    <div id="assistanceModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üôã –ü–æ–º–æ—â—å / –ü–æ–º–æ—â—å –Ω–∞ –¥–æ—Ä–æ–≥–µ</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="assistanceModal">√ó</button>
                </div>
                <form id="assistanceForm" class="space-y-4">
                    <div class="flex flex-col">
                        <label for="assistanceType" class="text-sm font-medium text-gray-700 mb-1">–¢–∏–ø —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏ *</label>
                        <select id="assistanceType" name="type" class="form-input-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–º–æ—â–∏...</option>
                            <option value="–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ">–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ</option>
                            <option value="–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å">–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                            <option value="–ü—Ä–æ—á–µ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ/–ø–æ–º–æ—â—å">–ü—Ä–æ—á–µ–µ –ø–æ—Ä—É—á–µ–Ω–∏–µ/–ø–æ–º–æ—â—å</option>
                        </select>
                    </div>
                    
                    <!-- –î–µ—Ç–∞–ª–∏ –∞–≤—Ç–æ: –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–º–æ—â–∏ –Ω–∞ –¥–æ—Ä–æ–≥–µ -->
                    <div id="carDetails" class="space-y-4 p-3 bg-teal-50 rounded-lg border border-dashed border-teal-300 hidden dark:bg-teal-900 dark:border-teal-700">
                        <p class="font-semibold text-sm text-teal-700 dark:text-teal-300">–î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–º–æ—â–∏ –Ω–∞ –¥–æ—Ä–æ–≥–µ</p>
                        <div class="flex flex-col">
                            <label for="carModel" class="text-sm font-medium text-gray-700 mb-1">–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ</label>
                            <input id="carModel" name="carModel" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota Camry">
                        </div>
                        <div class="flex flex-col">
                            <label for="licencePlate" class="text-sm font-medium text-gray-700 mb-1">–ì–æ—Å. –Ω–æ–º–µ—Ä (—á–∞—Å—Ç—å –Ω–æ–º–µ—Ä–∞)</label>
                            <input id="licencePlate" name="licencePlate" type="text" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123ABC">
                        </div>
                    </div>
                    
                    <div class="flex flex-col">
                        <label for="assistanceTask" class="text-sm font-medium text-gray-700 mb-1">–î–µ—Ç–∞–ª–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è</label>
                        <textarea id="assistanceTask" name="task" rows="3" class="form-input-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫–æ–µ –∫–æ–ª–µ—Å–æ —Å–ø—É—Å—Ç–∏–ª–æ, –∏–ª–∏ —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å/–ø–µ—Ä–µ–¥–∞—Ç—å"></textarea>
                    </div>
                    <!-- –ê–î–†–ï–° –ü–û–ú–û–©–ò (—Å –∫–Ω–æ–ø–∫–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏) -->
                    <div class="flex flex-col">
                        <label for="assistanceAddress" class="text-sm font-medium text-gray-700 mb-1">–ê–¥—Ä–µ—Å (–≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å) *</label>
                        <div class="input-with-plus-btn">
                            <input id="assistanceAddress" name="address" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º –∏–ª–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ" required />
                            <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                            <button type="button" onclick="getCurrentLocation('assistance')" 
                                class="geo-btn" 
                                title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                <i id="assistanceGeoIcon" class="fas fa-compass"></i>
                            </button>
                        </div>
                    </div>

                    <div id="assistanceStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-gray-500">–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</div>
                            <div class="price-estimate text-xl font-bold text-green-600">–æ—Ç 1500 —Ç–≥</div>
                            <div class="price-note text-xs font-semibold text-gray-600">–¶–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏.</div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ========================================================= -->
    <!-- 6. –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ê–£–ö–¶–ò–û–ù (AUCTION) -->
    <!-- ========================================================= -->
    <div id="auctionModal" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal">
            <div class="p-6">
                <div class="flex justify-between items-center border-b pb-4 mb-4">
                    <h3 class="text-xl font-bold text-gray-800">üî® –ó–∞–∫–∞–∑-–ê—É–∫—Ü–∏–æ–Ω</h3>
                    <button class="close-btn text-2xl text-gray-500 hover:text-gray-700" data-modal="auctionModal">√ó</button>
                </div>
                
                <form id="auctionForm" class="space-y-4">
                    
                    <div id="addressInputsAuction">
                        <div class="flex flex-col">
                            <label for="auctionFrom" class="text-sm font-medium text-gray-700 mb-1">–û—Ç–∫—É–¥–∞ (–∞–¥—Ä–µ—Å)</label>
                            <div class="input-with-plus-btn">
                                <input id="auctionFrom" name="from" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required>
                                <!-- –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò -->
                                <button type="button" onclick="getCurrentLocation('auction')" 
                                    class="geo-btn" 
                                    title="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
                                    <i id="auctionGeoIcon" class="fas fa-compass"></i>
                                </button>
                            </div>
                        </div>
                        <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "+" –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ -->
                        <div class="flex flex-col">
                            <label for="auctionTo" class="text-sm font-medium text-gray-700 mb-1">–ö—É–¥–∞ (–∞–¥—Ä–µ—Å) *</label>
                            <div class="input-with-plus-btn">
                                <input id="auctionTo" name="to" type="text" class="form-input-control" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º/–æ–±—ä–µ–∫—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required>
                                <!-- –ö–ù–û–ü–ö–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ê–î–†–ï–°–ê -->
                                <button type="button" onclick="addStop('additionalStopsAuction', 'auction')" 
                                    class="add-stop-btn" 
                                    title="–î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –ø–æ –ø—É—Ç–∏">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ -->
                            <div id="additionalStopsAuction" class="mt-2 space-y-2">
                            </div>
                        </div>
                    </div>
                    
                    
                    <div class="flex flex-col">
                        <label for="auctionPrice" class="text-sm font-medium text-gray-700 mb-1">–í–∞—à–∞ —Ü–µ–Ω–∞ –≤ —Ç–µ–Ω–≥–µ</label>
                        <input id="auctionPrice" name="price" type="number" inputmode="numeric" pattern="[0-9]*" min="500" class="form-input-control" placeholder="–ú–∏–Ω–∏–º—É–º 500 KZT (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required>
                        <p class="text-xs text-gray-500 mt-1">
                            ‚ö†Ô∏è –ê—É–∫—Ü–∏–æ–Ω: –í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ —Å–≤–æ—é —Ü–µ–Ω—É, –∞ –≤–æ–¥–∏—Ç–µ–ª—å —Ä–µ—à–∞–µ—Ç, –±—Ä–∞—Ç—å –∑–∞–∫–∞–∑ –∏–ª–∏ –Ω–µ—Ç.
                        </p>
                    </div>

                    <div id="auctionStatus" class="status-message p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden" role="alert"></div>

                    <div class="pt-4 border-t mt-6 flex justify-between items-center">
                        <div>
                            <div class="price-note text-sm text-yellow-600 font-bold">–û–ø–ª–∞—Ç–∞ –ø–æ –í–∞—à–µ–π —Å—Ç–∞–≤–∫–µ.</div>
                            <div class="price-estimate text-xl font-bold text-yellow-600">–ù–∞—á–Ω–∏—Ç–µ –æ—Ç 500 —Ç–≥</div>
                        </div>
                        <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                            –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ü–µ–Ω—É
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ PWA –∏ –ü–∞—Ä—Ç–Ω–µ—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    <div id="pwaModal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center hidden p-4">
        <div class="modal dark:bg-gray-800">
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ¬´–¢–∞–∫—Å–∏ –£—Å–ø–µ—Ö¬ª –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!</h3>
                
                <p class="mb-4 text-gray-700 dark:text-gray-300">–ß—Ç–æ–±—ã –≤–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∏—Å–∫–∞—Ç—å —Å—Å—ã–ª–∫—É, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—à—É –ø—Ä–æ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä—è–º–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.</p>
                
                <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è iPhone/iOS -->
                <div class="border p-4 rounded-lg mb-4 bg-gray-50 dark:bg-gray-700 dark:border-gray-600">
                    <h4 class="text-lg font-bold text-blue-600 mb-2 flex items-center"><i class="fab fa-apple mr-2"></i> –î–ª—è iPhone (iOS)</h4>
                    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300">
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ **Safari**.</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª** (<i class="fas fa-share-square"></i>) –≤ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞.</li>
                        <li>–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –º–µ–Ω—é –∏ –≤—ã–±–µ—Ä–∏—Ç–µ **¬´–ù–∞ —ç–∫—Ä–∞–Ω "–î–æ–º–æ–π"¬ª**.</li>
                        <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ.</li>
                    </ol>
                </div>
                
                <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Android/Chrome -->
                <div class="border p-4 rounded-lg bg-gray-50 dark:bg-gray-700 dark:border-gray-600">
                    <h4 class="text-lg font-bold text-green-600 mb-2 flex items-center"><i class="fab fa-android mr-2"></i> –î–ª—è Android (Chrome)</h4>
                    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300">
                        <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ **—Ç—Ä–∏ —Ç–æ—á–∫–∏** (<i class="fas fa-ellipsis-v"></i>) –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É.</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ **¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª**.</li>
                        <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ.</li>
                    </ol>
                </div>
                
                <button onclick="document.getElementById('pwaModal').classList.add('hidden')" 
                    class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg">
                    –ü–æ–Ω—è—Ç–Ω–æ
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞) -->
    <div id="partnerModal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center hidden p-4">
        <div class="modal dark:bg-gray-800">
            <div class="p-6">
                <div class="flex flex-col items-center justify-center border-b pb-4 mb-4">
                    <h3 class="text-2xl font-bold text-pink-600 flex items-center">
                        <i class="fas fa-handshake mr-2"></i> –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –£—Å–ª—É–≥–∏
                    </h3>
                </div>
                
                <p class="mb-4 text-gray-800 dark:text-gray-300 font-semibold">
                    –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è —Ä–µ–∫–ª–∞–º–∞ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞—à–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤!
                </p>
                <div class="border border-gray-200 p-4 rounded-lg mb-4 bg-gray-50 dark:bg-gray-700 dark:border-gray-600">
                    <h4 class="text-lg font-bold text-gray-700 dark:text-gray-200">–•–æ—Ç–∏—Ç–µ —Å—Ç–∞—Ç—å –Ω–∞—à–∏–º –ü–∞—Ä—Ç–Ω–µ—Ä–æ–º?</h4>
                    <a href="https://wa.me/77770649648?text=–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!%20–•–æ—á—É%20–æ–±—Å—É–¥–∏—Ç—å%20—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ%20—Ä–µ–∫–ª–∞–º—ã%20–Ω–∞%20–≤–∞—à–µ–π%20–ø—Ä–æ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–µ%20—Ç–∞–∫—Å–∏." 
                        target="_blank" class="w-full inline-block bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg transition text-center mt-2">
                        –°–≤—è–∑–∞—Ç—å—Å—è –ø–æ —Ä–µ–∫–ª–∞–º–µ
                    </a>
                </div>
                <button onclick="document.getElementById('partnerModal').classList.add('hidden')" 
                    class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- FIREBASE –∏ JAVASCRIPT –õ–û–ì–ò–ö–ê -->
    <!-- ========================================================= -->
    <script type="module">
        // --- FIREBASE –ò–ú–ü–û–†–¢–´ ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, setPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Firebase
        let app = null;
        let db = null;
        let auth = null;
        let userId = null;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ Canvas
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null; 

        // --- –ö–û–ù–°–¢–ê–ù–¢–´ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ---
        const ADDRESS_HISTORY_DOC_PATH = "settings";
        const ADDRESS_HISTORY_FIELD = "addressHistory";
        const PHONE_NUMBER = '77770649648'; 
        const CARGO_BASE_PRICE = 6000; 
        const MOVER_PRICE_PER_HOUR = 3000; 
        
        // --- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –†–ê–ó–î–ï–õ–ï–ù–ò–ï –°–ß–ï–¢–ß–ò–ö–û–í ---
        // activeStopCount: —Å–ª–µ–¥–∏—Ç –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–µ–∫—É—â–∏—Ö –ø–æ–ª–µ–π (–º–∞–∫—Å 3)
        // uniqueStopId: –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç–µ—Ç –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        let activeStopCount = 0; 
        let uniqueStopId = 0; 

        const INTERCITY_PRICES = {
            "—É—Å—Ç—å-–∫–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫": "–æ—Ç 4800‚Äì6210 —Ç–≥",
            "–≥–ª—É–±–æ–∫–æ–µ": "–æ—Ç 4200 —Ç–≥",
            "–Ω–æ–≤–∞—è –±—É—Ö—Ç–∞—Ä–º–∞": "–æ—Ç 24150 —Ç–≥",
            "—Ä–∏–¥–¥–µ—Ä": "–æ—Ç 25300 —Ç–≥",
            "—à–µ–º–æ–Ω–∞–∏—Ö–∞": "–æ—Ç 20700 —Ç–≥",
            "–∞–ª—Ç–∞–π": "–æ—Ç 45540 —Ç–≥", 
            "—É—Å—Ç—å-—Ç–∞–ª–æ–≤–∫–∞": "–æ—Ç 19780 —Ç–≥",
            "—Å–µ–∫–∏—Å–æ–≤–∫–∞": "–æ—Ç 6440 —Ç–≥",
            "–±–µ–ª–æ–∫–∞–º–µ–Ω–∫–∞": "–æ—Ç 3500 —Ç–≥",
            "–º–∏—Ö–∞–π–ª–æ–≤–∫–∞": "–æ—Ç 4000 —Ç–≥",
            "–ø—Ä–æ–≥—Ä–µ—Å—Å": "–æ—Ç 2990‚Äì3500 —Ç–≥",
            "—á–µ—Ä–Ω–æ–≥–æ—Ä–∫–∞": "–æ—Ç 2100‚Äì3000 —Ç–≥",
            "–∫—Ä–∞—Å–Ω—ã–π –ø–∞—Ä—Ç–∏–∑–∞–Ω": "–æ—Ç 1800‚Äì2500 —Ç–≥",
            "–ø–ª–∞–Ω–∏–¥–æ–≤–∫–∞": "–æ—Ç 2100‚Äì2500 —Ç–≥",
            "—Ç–∞—Ä—Ö–∞–Ω–∫–∞": "–æ—Ç 11270‚Äì12200 —Ç–≥",
            "–ø—Ä–µ–¥–≥–æ—Ä–Ω–æ–µ": "–æ—Ç 8500‚Äì10000 —Ç–≥",
            "–∞–ª—Ç–∞–π—Å–∫–∏–π": "–æ—Ç 6000‚Äì8000 —Ç–≥"
        };
        const MODALS = {
            'taxi': { id: 'taxiModal', formId: 'taxiForm', title: '–¢–ê–ö–°–ò', prefix: 'üöï –ù–û–í–´–ô –ó–ê–ö–ê–ó: –¢–ê–ö–°–ò' },
            'delivery': { id: 'deliveryModal', formId: 'deliveryForm', title: '–î–û–°–¢–ê–í–ö–ê', prefix: 'üõçÔ∏è –ù–û–í–´–ô –ó–ê–ö–ê–ó: –î–û–°–¢–ê–í–ö–ê' },
            'cargo': { id: 'cargoModal', formId: 'cargoForm', title: '–ì–†–£–ó–û–í–û–ô', prefix: 'üöö –ù–û–í–´–ô –ó–ê–ö–ê–ó: –ì–†–£–ó–û–í–û–ô' },
            'soberDriver': { id: 'soberDriverModal', formId: 'soberDriverForm', title: '–¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨', prefix: 'üîë –ù–û–í–´–ô –ó–ê–ö–ê–ó: –¢–†–ï–ó–í–´–ô –í–û–î–ò–¢–ï–õ–¨' },
            'assistance': { id: 'assistanceModal', formId: 'assistanceForm', title: '–ü–û–ú–û–©–¨', prefix: 'üôã –ù–û–í–´–ô –ó–ê–ö–ê–ó: –ü–û–ú–û–©–¨' },
            'auction': { id: 'auctionModal', formId: 'auctionForm', title: '–ê–£–ö–¶–ò–û–ù', prefix: 'üî® –ó–ê–ö–ê–ó: –ê–£–ö–¶–ò–û–ù (–¶–ï–ù–ê –ö–õ–ò–ï–ù–¢–ê)' },
        };
        // ------------------------------------

        /**
         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Firebase –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.
         */
        async function initFirebaseAndAuth() {
            if (!firebaseConfig) {
                console.error("Firebase configuration is missing.");
                return;
            }

            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Å—Å–∏–æ–Ω–Ω–∞—è)
                await setPersistence(auth, browserSessionPersistence);

                // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("User authenticated. UID:", userId);
                        // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
                        setAddressHistory();
                    } else {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–Ω–æ–Ω–∏–º–Ω—ã–π UUID, –µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞
                        userId = crypto.randomUUID(); 
                        console.log("User not authenticated, using random UUID:", userId);
                        setAddressHistory();
                    }
                });
            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
            }
        }
        
        // --- –õ–û–ì–ò–ö–ê –ò–°–¢–û–†–ò–ò –ê–î–†–ï–°–û–í (Firestore) ---

        /**
         * –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∞–¥—Ä–µ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Firestore.
         */
        async function loadAddresses() {
            if (!db || !userId) {
                return [];
            }
            try {
                // –ü–£–¢–¨: /artifacts/{appId}/users/{userId}/data/settings
                const docRef = doc(db, "artifacts", appId, "users", userId, "data", ADDRESS_HISTORY_DOC_PATH);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    // –§–∏–ª—å—Ç—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ datalist
                    return (data[ADDRESS_HISTORY_FIELD] || []).filter(addr => !addr.includes('[–ö–û–û–†–î–ò–ù–ê–¢–´]'));
                } else {
                    return [];
                }
            } catch (e) {
                console.error("Error loading address history from Firestore:", e);
                return [];
            }
        }

        /**
         * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤ –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore.
         */
        async function saveAddress(address) {
            if (!db || !userId) {
                console.warn("Firestore not ready. Cannot save address.");
                return;
            }
            // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–æ–∫–∏
            if (!address || address.includes('[–ö–û–û–†–î–ò–ù–ê–¢–´]') || address.length < 5) return; 

            try {
                let history = await loadAddresses();
                history = history.filter(item => item.toLowerCase() !== address.toLowerCase());
                history.unshift(address);
                history = history.slice(0, 10);
                
                const docRef = doc(db, "artifacts", appId, "users", userId, "data", ADDRESS_HISTORY_DOC_PATH);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º setDoc —Å merge: true
                await setDoc(docRef, { [ADDRESS_HISTORY_FIELD]: history }, { merge: true });
            } catch (e) {
                console.error("Error saving address history to Firestore:", e);
            }
        }

        /**
         * –ó–∞–ø–æ–ª–Ω—è–µ—Ç datalist'—ã –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∞–¥—Ä–µ—Å–æ–≤.
         */
        async function populateDatalist(datalistId) {
            const historyArray = await loadAddresses();
            const datalist = document.getElementById(datalistId);
            if (!datalist) return;
            
            datalist.innerHTML = ''; 
            
            historyArray.forEach(address => {
                const option = document.createElement('option');
                option.value = address;
                datalist.appendChild(option);
            });
        }
        
        /**
         * –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö datalist.
         */
        window.setAddressHistory = async function() {
            if (db) { // –í—ã–ø–æ–ª–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
                await populateDatalist('fromHistory');
                await populateDatalist('toHistory');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–ø—Ç–∞
        initFirebaseAndAuth();

        // –ö–û–ù–ï–¶ –ë–õ–û–ö–ê FIREBASE
        // =========================================================

        
        // --- –õ–û–ì–ò–ö–ê –ê–ö–ö–û–†–î–ï–û–ù–ê (FAQ) ---
        window.toggleAccordion = function(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);

            if (!content) return;

            if (content.classList.contains('hidden')) {
                // Show content
                content.classList.remove('hidden');
                content.style.maxHeight = content.scrollHeight + 'px';
                if (icon) icon.classList.add('rotate-180');
            } else {
                // Hide content
                content.classList.add('hidden');
                content.style.maxHeight = '0';
                if (icon) icon.classList.remove('rotate-180');
            }
        }
        // --- –ö–û–ù–ï–¶ –õ–û–ì–ò–ö–ò –ê–ö–ö–û–†–î–ï–û–ù–ê ---

        
        const whatsappLinkEl = document.getElementById('whatsappLink');
        const locationBtnTextEl = document.getElementById('locationBtnText');
        const locationResultEl = document.getElementById('locationResult');
        const locationAddressEl = document.getElementById('locationAddress');
        const announcementBar = document.getElementById('announcementBar');
        
        const originalWhatsappText = 'https://wa.me/77770649648?text=%5B–ê–¥—Ä–µ—Å%20–û–¢–ö–£–î–ê%5D%20-%20%5B–ê–¥—Ä–µ—Å%20–ö–£–î–ê%5D.';
        
        let currentGeolocatedAddress = '';
        
        // =========================================================
        // === –õ–û–ì–ò–ö–ê –î–ï–ù–¨/–ù–û–ß–¨ (THEME TOGGLE) ===
        // =========================================================
        const THEME_KEY = 'taxi_theme_preference';
        const body = document.body;
        const themeIcon = document.getElementById('themeIcon');
        
        function updateThemeIcon(theme) {
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    themeIcon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É';
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    themeIcon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
                }
            }
        }

        function applyTheme(theme) {
            if (theme === 'dark') {
                body.classList.add('dark');
            } else {
                body.classList.remove('dark');
            }
            updateThemeIcon(theme);
        }

        window.toggleTheme = function() {
            const isDark = body.classList.contains('dark');
            const newTheme = isDark ? 'light' : 'dark';
            
            applyTheme(newTheme);
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –≤ localStorage
            localStorage.setItem(THEME_KEY, newTheme);
        }
        
        function loadTheme() {
            const savedTheme = localStorage.getItem(THEME_KEY);
            
            if (savedTheme) {
                applyTheme(savedTheme);
            } else {
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const defaultTheme = prefersDark ? 'dark' : 'light';
                applyTheme(defaultTheme);
            }
        }
        // =========================================================

        // --- –õ–û–ì–ò–ö–ê –î–õ–Ø –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ì–û –ë–ê–ù–ù–ï–†–ê-–û–ë–™–Ø–í–õ–ï–ù–ò–Ø ---
        function checkAndShowAnnouncement() {
            const dismissKey = 'announcement_dismissed_v1';
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –±–∞–Ω–Ω–µ—Ä –∑–∞–∫—Ä—ã—Ç.
            if (localStorage.getItem(dismissKey) === 'true') {
                announcementBar.classList.add('hidden');
            } else {
                announcementBar.classList.remove('hidden');
            }
        }

        window.dismissAnnouncement = function() {
            announcementBar.classList.add('hidden');
            localStorage.setItem('announcement_dismissed_v1', 'true');
        }

        // –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ + 5 –º–∏–Ω—É—Ç
        function getFormattedCurrentTime() {
            const now = new Date();
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è —Å —É—á–µ—Ç–æ–º —Å–¥–≤–∏–≥–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è,
            // –∞ –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º 5 –º–∏–Ω—É—Ç.
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset() + 5); 
            return now.toISOString().slice(0, 16);
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadTheme(); // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–º—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            checkAndShowAnnouncement();
            
            const formattedNow = getFormattedCurrentTime();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–ª–µ–π –ø—Ä–µ–¥–∑–∞–∫–∞–∑–∞
            document.getElementById('taxiDateTime').value = formattedNow;
            document.getElementById('cargoDateTime').value = formattedNow;
            
            updateCargoPrice(); 
            updateTaxiPrice(); 
        });
        
        // =========================================================
        // === –õ–û–ì–ò–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò ===
        // =========================================================

        /**
         * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏.
         */
        function setGeoButtonLoading(mode, isLoading, isError = false) {
            let buttonEl, iconEl, textEl;

            // –î–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            if (mode === 'main') {
                buttonEl = document.getElementById('locationBtn');
                textEl = document.getElementById('locationBtnText');
                if (isLoading) {
                    textEl.innerHTML = '<i class="fas fa-spinner animate-spin"></i> –û–ø—Ä–µ–¥–µ–ª—è–µ–º...';
                    buttonEl.disabled = true;
                    buttonEl.classList.remove('bg-red-500/50', 'bg-green-500/50');
                } else {
                    buttonEl.disabled = false;
                    textEl.innerHTML = isError ? '<i class="fas fa-times"></i> –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è' : '<i class="fas fa-check"></i> –ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
                    buttonEl.classList.add(isError ? 'bg-red-500/50' : 'bg-green-500/50');
                    buttonEl.classList.remove(isError ? 'bg-green-500/50' : 'bg-red-500/50');
                }
                return;
            } 

            // –î–ª—è –∫–Ω–æ–ø–æ–∫ –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
            let iconId = `${mode}GeoIcon`;
            iconEl = document.getElementById(iconId);
            buttonEl = iconEl ? iconEl.closest('button') : null;

            if (buttonEl && iconEl) {
                buttonEl.disabled = isLoading;
                if (isLoading) {
                    iconEl.className = 'fas fa-spinner animate-spin';
                    buttonEl.title = '–û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ...';
                } else {
                    iconEl.className = isError ? 'fas fa-exclamation-triangle' : 'fas fa-compass';
                    buttonEl.title = '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ';
                }
            }
        }


        /**
         * –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.
         */
        window.getCurrentLocation = function(trigger) {
            if (!navigator.geolocation) {
                displayMessageModal('–û—à–∏–±–∫–∞', '–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º.', true);
                setGeoButtonLoading(trigger, false, true);
                return;
            }

            setGeoButtonLoading(trigger, true);

            navigator.geolocation.getCurrentPosition(
                (position) => {
                    setGeoButtonLoading(trigger, false, false);
                    const lat = position.coords.latitude.toFixed(5);
                    const lon = position.coords.longitude.toFixed(5);
                    
                    const yandexMapUrl = `https://yandex.kz/maps/?pt=${lon},${lat}&z=16&l=map`;

                    currentGeolocatedAddress = `[–ö–û–û–†–î–ò–ù–ê–¢–´] ${lat}, ${lon}. –°—Å—ã–ª–∫–∞: ${yandexMapUrl}`; 
                    
                    let inputId;
                    let successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–û—Ç–∫—É–¥–∞".';

                    switch (trigger) {
                        case 'main':
                            locationResultEl.classList.remove('hidden');
                            locationAddressEl.textContent = `–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${lat}, ${lon} (–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É)`;
                            locationAddressEl.href = yandexMapUrl; 
                            locationAddressEl.title = '–û—Ç–∫—Ä—ã—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ';

                            setAllLocationFields(currentGeolocatedAddress);
                            
                            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π WhatsApp —Å—Å—ã–ª–∫–∏
                            let whatsappMessage = `${currentGeolocatedAddress} - [–ê–¥—Ä–µ—Å –ö–£–î–ê]`;
                            const encodedText = encodeURIComponent(whatsappMessage);
                            whatsappLinkEl.href = `https://wa.me/${PHONE_NUMBER}?text=${encodedText}`;

                            openOrUpdateMessageModal('–ì–æ—Ç–æ–≤–æ!', '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç—É) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ –≤—Å–µ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞!', false);
                            return;

                        case 'taxi': inputId = 'taxiFrom'; break;
                        case 'auction': inputId = 'auctionFrom'; break;
                        case 'delivery': inputId = 'deliveryAddress'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏".'; break;
                        case 'cargo': inputId = 'cargoFrom'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏".'; break; 
                        case 'soberDriver': inputId = 'soberDriverFrom'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–í–∞—à —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å".'; break; 
                        case 'assistance': inputId = 'assistanceAddress'; successMessage = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å (–≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å)".'; break; 
                        default: return;
                    }

                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                    const input = document.getElementById(inputId);
                    if (input) {
                        input.value = currentGeolocatedAddress;
                    }
                    openOrUpdateMessageModal('–ê–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω', successMessage, false);
                    
                    if (trigger === 'taxi') {
                        updateTaxiPrice();
                    }

                },
                (error) => {
                    setGeoButtonLoading(trigger, false, true);
                    let errorMessage = '–û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.';
                    if (error.code === error.PERMISSION_DENIED) {
                        errorMessage = '–î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.';
                    }
                    
                    if (trigger === 'main') {
                        locationResultEl.classList.add('hidden');
                        whatsappLinkEl.href = originalWhatsappText; // –°–±—Ä–æ—Å
                    }
                    
                    openOrUpdateMessageModal('–û—à–∏–±–∫–∞', errorMessage, true);
                    
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
            );
        }
        
        // --- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π —Ñ–æ—Ä–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ ---
        function setAllLocationFields(locationText) {
            const fieldsToFill = [
                'taxiFrom', 'deliveryAddress', 'cargoFrom', 'soberDriverFrom', 'assistanceAddress', 'auctionFrom'
            ];
            
            fieldsToFill.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.value = locationText;
                }
            });
            updateTaxiPrice();
        }

        // =========================================================
        // === –õ–û–ì–ò–ö–ê –¶–ï–ù–´ –¢–ê–ö–°–ò ===
        // =========================================================
        
        /**
         * –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –∞–¥—Ä–µ—Å–æ–≤ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –¢–∞–∫—Å–∏
         */
        function countFilledAddresses() {
            let count = 0;
            
            const fromInput = document.getElementById('taxiFrom');
            const toInput = document.getElementById('taxiTo');
            const stopsContainer = document.getElementById('additionalStops');

            if (fromInput && fromInput.value.trim().length > 0) {
                count++;
            }
            if (toInput && toInput.value.trim().length > 0) {
                count++;
            }

            if (stopsContainer) {
                stopsContainer.querySelectorAll('input.form-input-control').forEach(input => {
                    if (input.value.trim().length > 0) {
                        count++; 
                    }
                });
            }
            return count;
        }
        
        /**
         * –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω—É—é —Ü–µ–Ω—É –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –¢–∞–∫—Å–∏.
         */
        window.updateTaxiPrice = function() {
            const priceEl = document.getElementById('taxiPriceEstimate');
            if (!priceEl) return;

            const toInput = document.getElementById('taxiTo');
            const destination = toInput ? toInput.value.trim().toLowerCase() : '';
            let priceText;

            // 1. –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ú–µ–∂–≥–æ—Ä–æ–¥ / –ü—Ä–∏–≥–æ—Ä–æ–¥
            let isIntercity = false;
            for (const location in INTERCITY_PRICES) {
                if (destination.startsWith(location)) {
                    priceText = INTERCITY_PRICES[location];
                    isIntercity = true;
                    break;
                }
            }

            if (isIntercity) {
                priceEl.textContent = priceText;
                return; 
            }

            // 2. –í–¢–û–†–ò–ß–ù–´–ô –ü–†–ò–û–†–ò–¢–ï–¢: –õ–æ–∫–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
            const addressCount = countFilledAddresses();
            
            if (addressCount <= 2) { 
                priceText = '–æ—Ç 700‚Äì900 —Ç–≥';
            } 
            else if (addressCount >= 3) { 
                // 3 –∏–ª–∏ –±–æ–ª–µ–µ –∞–¥—Ä–µ—Å–æ–≤
                priceText = '–æ—Ç 1500‚Äì2000 —Ç–≥';
            } 
            else {
                priceText = '–æ—Ç 700‚Äì900 —Ç–≥';
            }
            
            priceEl.textContent = priceText;
        }


        // =========================================================
        // === –õ–û–ì–ò–ö–ê –ö–ê–õ–¨–ö–£–õ–Ø–¶–ò–ò –î–õ–Ø –ì–†–£–ó–û–í–û–ì–û ===
        // =========================================================
        window.updateCargoPrice = function() {
            const cargoMoversSelect = document.getElementById('cargoMovers');
            const cargoTotalPriceEl = document.getElementById('cargoTotalPrice');
            const cargoPriceNoteEl = document.getElementById('cargoPriceNote');
            
            if (!cargoMoversSelect || !cargoTotalPriceEl || !cargoPriceNoteEl) return;
            
            const moversCount = parseInt(cargoMoversSelect.value) || 0;
            const totalPrice = CARGO_BASE_PRICE + (moversCount * MOVER_PRICE_PER_HOUR);
            const formattedPrice = totalPrice.toLocaleString('ru-RU');

            cargoTotalPriceEl.textContent = `${formattedPrice} —Ç–≥`;
            
            if (moversCount > 0) {
                cargoPriceNoteEl.innerHTML = `–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ${CARGO_BASE_PRICE.toLocaleString('ru-RU')} —Ç–≥/—á–∞—Å + –¥–æ–ø–ª–∞—Ç–∞ –∑–∞ ${moversCount} —á–µ–ª.`;
                cargoPriceNoteEl.classList.remove('text-gray-600');
                cargoPriceNoteEl.classList.add('text-blue-500');
            } else {
                cargoPriceNoteEl.textContent = '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ - 1 —á–∞—Å.';
                cargoPriceNoteEl.classList.remove('text-blue-500');
                cargoPriceNoteEl.classList.add('text-gray-600');
            }
        }
        
        // =========================================================
        // === –õ–û–ì–ò–ö–ê –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù –ò –§–û–†–ú (–û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –õ–û–ì–ò–ö–ê) ===
        // =========================================================
        
        /**
         * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º.
         * @param {string} title - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞.
         * @param {string} message - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTML).
         * @param {boolean} isError - –§–ª–∞–≥ –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç).
         * @param {boolean} showButton - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –∫–Ω–æ–ø–∫—É "OK".
         */
        function openOrUpdateMessageModal(title, message, isError = false, showButton = true) {
            let modal = document.getElementById('alertModal');
            
            // 1. –ï—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ
            if (!modal) {
                const modalHtml = `
                    <div id="alertModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                        <div id="alertModalContent" class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm text-center dark:bg-gray-800 dark:text-gray-100">
                            <h3 id="alertModalTitle" class="text-xl font-bold mb-4"></h3>
                            <p id="alertModalMessage" class="mb-6 whitespace-pre-line"></p>
                            <button id="alertModalButton" onclick="document.getElementById('alertModal').remove()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg">
                                OK
                            </button>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHtml);
                modal = document.getElementById('alertModal');
            }

            // 2. –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            const titleEl = document.getElementById('alertModalTitle');
            const messageEl = document.getElementById('alertModalMessage');
            const buttonEl = document.getElementById('alertModalButton');
            
            if (titleEl) {
                titleEl.textContent = title;
                titleEl.className = `text-xl font-bold mb-4 ${isError ? 'text-red-600' : 'text-indigo-600'}`;
            }
            if (messageEl) {
                messageEl.innerHTML = message;
            }
            if (buttonEl) {
                if (showButton) {
                    buttonEl.classList.remove('hidden');
                } else {
                    buttonEl.classList.add('hidden');
                }
            }
        }
        
        // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Å—Ç–∞—Ä—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
        window.displayMessageModal = function(title, message, isError = false) {
             openOrUpdateMessageModal(title, message, isError, true);
        }

        /**
         * –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é —Ä–æ–∑—ã–≥—Ä—ã—à–∞ –ª–æ—Ç–µ—Ä–µ–∏.
         */
        window.startLotterySimulation = function() {
            // 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ "–†–æ–∑—ã–≥—Ä—ã—à" —Å–æ —Å–ø–∏–Ω–Ω–µ—Ä–æ–º
            openOrUpdateMessageModal(
                'üé∞ –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à...', 
                '–ü–æ–¥–æ–∂–¥–∏—Ç–µ, –±–∞—Ä–∞–±–∞–Ω –∫—Ä—É—Ç–∏—Ç—Å—è...<br><i class="fas fa-spinner fa-spin text-4xl mt-3 text-violet-500"></i>', 
                false, 
                false // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É OK –≤–æ –≤—Ä–µ–º—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞
            ); 

            // 2. –û–∂–∏–¥–∞–µ–º 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                // 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                openOrUpdateMessageModal(
                    'üò¢ –°–µ–≥–æ–¥–Ω—è –Ω–µ –í–∞—à –¥–µ–Ω—å!', 
                    '–≠—Ö, —Å–µ–≥–æ–¥–Ω—è –Ω–µ –ø–æ–≤–µ–∑–ª–æ! üé≤\n–ü—Ä–∏–∑ —É–∂–µ —Ä–∞–∑—ã–≥—Ä–∞–Ω –∏–ª–∏ –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—ã—Ç–∞–π—Ç–µ —É–¥–∞—á—É –∑–∞–≤—Ç—Ä–∞!', 
                    true, // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç (isError=true) –¥–ª—è "–Ω–µ –ø–æ–≤–µ–∑–ª–æ"
                    true // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É OK
                );
            }, 2000); // 2000 –º—Å = 2 —Å–µ–∫—É–Ω–¥—ã
        }

        /**
         * –í—ã–∑—ã–≤–∞–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–õ–æ—Ç–µ—Ä–µ—è".
         */
        window.showLotteryPrize = function() {
            startLotterySimulation(); 
        }

        // =========================================================
        // === –ö–û–ù–ï–¶ –õ–û–ì–ò–ö–ò –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù (–û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –õ–û–ì–ò–ö–ê) ===
        // =========================================================


        // =========================================================
        // === –õ–û–ì–ò–ö–ê –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù –ò –§–û–†–ú (–û–°–¢–ê–õ–¨–ù–û–ï) ===
        // =========================================================

        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                document.querySelectorAll('.status-message').forEach(el => el.classList.add('hidden'));
                
                if (modalId === 'taxiModal' || modalId === 'auctionModal') {
                    setAddressHistory();
                }
                
                modal.classList.add('active');
                modal.setAttribute('aria-hidden', 'false');
                
                const formattedNow = getFormattedCurrentTime();
                if (modalId === 'taxiModal') {
                    document.getElementById('taxiDateTime').value = formattedNow;
                    updateTaxiPrice(); 
                }
                if (modalId === 'cargoModal') {
                    document.getElementById('cargoDateTime').value = formattedNow;
                    document.getElementById('cargoMovers').value = '0'; 
                    updateCargoPrice(); 
                }
                
                const firstInput = modal.querySelector('input, textarea, select');
                if (firstInput) firstInput.focus();
            }
        }

        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                modal.setAttribute('aria-hidden', 'true');
                
                // –û—á–∏—Å—Ç–∫–∞ –∏ —Å–±—Ä–æ—Å —Ñ–æ—Ä–º/—Å—á–µ—Ç—á–∏–∫–æ–≤
                if (modalId === 'taxiModal' || modalId === 'auctionModal') {
                    const stopsContainerTaxi = document.getElementById('additionalStops');
                    const stopsContainerAuction = document.getElementById('additionalStopsAuction');
                    
                    if (stopsContainerTaxi) stopsContainerTaxi.innerHTML = '';
                    if (stopsContainerAuction) stopsContainerAuction.innerHTML = '';
                    
                    activeStopCount = 0; // –°–ë–†–û–° –ê–ö–¢–ò–í–ù–´–• –û–°–¢–ê–ù–û–í–û–ö (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
                }
                
                const form = document.getElementById(modalId.replace('Modal', 'Form'));
                if (form) form.reset();
                
                if (modalId === 'assistanceModal') {
                    document.getElementById('carDetails').classList.add('hidden');
                    document.getElementById('assistanceType').value = '';
                }
                
                // –°–±—Ä–æ—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π
                const formattedNow = getFormattedCurrentTime();
                if (modalId === 'taxiModal') {
                    document.getElementById('taxiDateTime').value = formattedNow;
                    updateTaxiPrice(); 
                }
                if (modalId === 'cargoModal') {
                    document.getElementById('cargoDateTime').value = formattedNow;
                    document.getElementById('cargoMovers').value = '0'; 
                    updateCargoPrice(); 
                }
            }
        }

        /**
         * –î–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –∞–¥—Ä–µ—Å–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–û)
         */
        window.addStop = function(containerId, mode) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –õ–ò–ú–ò–¢ –ø–æ activeStopCount
            if (activeStopCount >= 3) {
                openOrUpdateMessageModal('–õ–∏–º–∏—Ç', '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ (3) –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ.', false);
                return;
            }
            
            activeStopCount++; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª–µ–π
            uniqueStopId++; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (–≤—Å–µ–≥–¥–∞ —Ä–∞—Å—Ç–µ—Ç)
            
            const stopsContainer = document.getElementById(containerId);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º uniqueStopId –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
            const stopId = `${containerId}Input${uniqueStopId}`; 
            const stopLabel = `–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å`; 
            
            const stopDiv = document.createElement('div');
            stopDiv.className = "flex space-x-2 additional-stop-item input-with-plus-btn"; 
            const divId = `stopDiv${containerId}${uniqueStopId}`;
            stopDiv.id = divId;
            
            const inputEvents = (mode === 'taxi') ? 'oninput="updateTaxiPrice()"' : '';

            stopDiv.innerHTML = `
                <input id="${stopId}" name="${stopId}" type="text" list="toHistory" class="form-input-control" placeholder="${stopLabel} (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" required ${inputEvents}>
                <button type="button" onclick="removeStop('${divId}', '${mode}')" class="remove-stop-btn" title="–£–¥–∞–ª–∏—Ç—å –∞–¥—Ä–µ—Å">
                    <i class="fas fa-minus"></i>
                </button>
            `;
            
            stopsContainer.appendChild(stopDiv);
            setAddressHistory(); 
            if (mode === 'taxi') updateTaxiPrice();
        }
        
        /**
         * –£–¥–∞–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –∞–¥—Ä–µ—Å–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–û)
         */
        window.removeStop = function(divId, mode) {
            const elementToRemove = document.getElementById(divId);
            if (elementToRemove) {
                elementToRemove.remove();
                activeStopCount--; // –£–º–µ–Ω—å—à–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—á–µ—Ç—á–∏–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª–µ–π
                if (activeStopCount < 0) activeStopCount = 0;
            }
            if (mode === 'taxi') updateTaxiPrice();
        }

        window.showPWAInstructions = function() {
            document.getElementById('pwaModal').classList.remove('hidden');
        }
        window.showPartnerModal = function() {
            document.getElementById('partnerModal').classList.remove('hidden');
        }


        // --- Event Listeners for Opening/Closing ---
        document.querySelectorAll('.service-btn').forEach(button => {
            button.addEventListener('click', () => {
                const service = button.getAttribute('data-service');
                if (MODALS[service]) {
                    window.openModal(MODALS[service].id);
                }
            });
        });

        document.querySelectorAll('.close-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                window.closeModal(e.target.closest('button').getAttribute('data-modal'));
            });
        });

        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    window.closeModal(overlay.id);
                }
            });
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const openModal = document.querySelector('.modal-overlay.active');
                if (openModal) {
                    window.closeModal(openModal.id);
                }
            }
        });
        
        // --- Specific Assistance Modal Logic (for –ü–æ–¥–∫–∞—á–∞—Ç—å/–ü—Ä–∏–∫—É—Ä–∏—Ç—å) ---
        const assistanceTypeSelect = document.getElementById('assistanceType');
        const carDetailsDiv = document.getElementById('carDetails');

        if (assistanceTypeSelect && carDetailsDiv) {
            assistanceTypeSelect.addEventListener('change', (e) => {
                const selectedType = e.target.value;
                if (selectedType === '–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ' || selectedType === '–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å') {
                    carDetailsDiv.classList.remove('hidden');
                } else {
                    carDetailsDiv.classList.add('hidden');
                }
            });
        }


        // --- Form Submission Handlers ---
        const forms = document.querySelectorAll('form');
        
        forms.forEach(form => {
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formId = this.id;
                const modalKey = Object.keys(MODALS).find(key => MODALS[key].formId === formId);
                const modalConfig = MODALS[modalKey];
                
                if (!modalConfig) return;

                const modalId = modalConfig.id;
                const statusEl = document.getElementById(modalId.replace('Modal', 'Status'));
                if (statusEl) statusEl.classList.add('hidden'); // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
                
                let message = `${modalConfig.prefix}\n\n`;
                let requiredFieldsMissing = false;

                const getVal = (id, label, isRequired = false) => {
                    const input = document.getElementById(id);
                    let value = input ? input.value.trim() : '';

                    if (isRequired && !value) {
                        requiredFieldsMissing = true;
                    }

                    return `*${label}*:\n${value || '‚Äî'}\n\n`;
                };

                const collectStops = (containerId) => {
                    let stops = '';
                    const container = document.getElementById(containerId);
                    if (container) {
                        container.querySelectorAll('input').forEach((input, index) => {
                            if (input.value.trim()) {
                                const stopLabel = `–î–æ–ø. –∞–¥—Ä–µ—Å ${index + 1}`;
                                stops += `*${stopLabel}*:\n${input.value.trim()}\n\n`;
                            }
                        });
                    }
                    return stops;
                };
                
                const handlePreorder = (dateTimeId, basePrefix) => {
                    const dateTimeInput = document.getElementById(dateTimeId).value;
                    let prefixMessage = basePrefix;
                    
                    if (dateTimeInput) {
                        const selectedTime = new Date(dateTimeInput);
                        const currentTime = new Date();
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ –≤—Ä–µ–º—è –≤—ã–±—Ä–∞–Ω–æ –≤ –±—É–¥—É—â–µ–º (—Å –∑–∞–ø–∞—Å–æ–º 5 –º–∏–Ω—É—Ç)
                        if (selectedTime.getTime() > (currentTime.getTime() + 5 * 60 * 1000)) {
                            const formattedDate = selectedTime.toLocaleString('ru-RU', { 
                                year: 'numeric', month: '2-digit', day: '2-digit', 
                                hour: '2-digit', minute: '2-digit' 
                            });
                            prefixMessage = `‚è∞ –ü–†–ï–î–ó–ê–ö–ê–ó (${modalConfig.title}) ‚è∞\n\n`;
                            prefixMessage += `*–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏*:\n${formattedDate}\n\n`;
                        }
                    }
                    
                    return prefixMessage;
                };

                let addressesToSave = [];


                switch (modalKey) {
                    case 'taxi':
                        const fromAddress = document.getElementById('taxiFrom').value.trim();
                        const toAddress = document.getElementById('taxiTo').value.trim();
                        const wishes = document.getElementById('taxiWishes').value.trim();
                        const passengerPhone = document.getElementById('passengerPhone').value.trim(); 
                        
                        message = handlePreorder('taxiDateTime', modalConfig.prefix);
                        
                        message += getVal('taxiFrom', '–û—Ç–∫—É–¥–∞', true);
                        message += getVal('taxiTo', '–ö—É–¥–∞', true);
                        
                        if (wishes) {
                            message += `*–ü–æ–∂–µ–ª–∞–Ω–∏—è*:\n${wishes}\n\n`;
                        }

                        let stopMessage = collectStops('additionalStops');

                        if (stopMessage) {
                            message += '\n--- –î–û–ü. –ê–î–†–ï–°–ê –ü–û –ü–£–¢–ò ---\n\n';
                            message += stopMessage;
                            message += '---------------------------\n\n';
                        }
                        
                        if (passengerPhone) {
                            message += 'üìû –ö–û–ù–¢–ê–ö–¢–´:\n';
                            message += `*–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏*:\n${passengerPhone}\n\n`;
                        }
                        
                        const currentPriceText = document.getElementById('taxiPriceEstimate').textContent;
                        message += `üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: ${currentPriceText} (—É—Ç–æ—á–Ω–∏—Ç –≤–æ–¥–∏—Ç–µ–ª—å)`;
                        
                        if (fromAddress) addressesToSave.push(fromAddress);
                        if (toAddress) addressesToSave.push(toAddress);

                        break;
                        
                    case 'auction':
                        const auctionPrice = document.getElementById('auctionPrice').value;
                        if (!auctionPrice || parseInt(auctionPrice) < 500) {
                            requiredFieldsMissing = true;
                            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—à–∏–±–∫—É –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –∞—É–∫—Ü–∏–æ–Ω–∞
                            statusEl.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É (–º–∏–Ω–∏–º—É–º 500 KZT).';
                            statusEl.classList.remove('hidden');
                            return;
                        }
                        message += getVal('auctionFrom', '–û—Ç–∫—É–¥–∞', true);
                        message += getVal('auctionTo', '–ö—É–¥–∞', true);
                        message += collectStops('additionalStopsAuction');
                        message += `*–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Ü–µ–Ω–∞*:\n${auctionPrice} KZT\n\n`;
                        message += '‚ö†Ô∏è –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –≠—Ç–æ —Ü–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞. –ü—Ä–∏–º–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –∑–∞–∫–∞–∑—É —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.';
                        
                        const auctionFromAddress = document.getElementById('auctionFrom').value.trim();
                        const auctionToAddress = document.getElementById('auctionTo').value.trim();
                        if (auctionFromAddress) addressesToSave.push(auctionFromAddress);
                        if (auctionToAddress) addressesToSave.push(auctionToAddress);

                        break;
                        
                    case 'delivery':
                        message += getVal('deliveryItems', '–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤', true);
                        message += getVal('deliveryAddress', '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏', true);
                        message += getVal('deliveryStore', '–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –º–∞–≥–∞–∑–∏–Ω—É');
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 1200 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è/–æ–±—ä–µ–º–∞)';
                        
                        const deliveryAddress = document.getElementById('deliveryAddress').value.trim();
                        if (deliveryAddress) addressesToSave.push(deliveryAddress);
                        break;
                        
                    case 'cargo':
                        const cargoMoversSelect = document.getElementById('cargoMovers');
                        const moversCount = parseInt(cargoMoversSelect.value);
                        const totalPrice = CARGO_BASE_PRICE + (moversCount * MOVER_PRICE_PER_HOUR);
                        const formattedPrice = totalPrice.toLocaleString('ru-RU');
                        
                        const moversText = (moversCount > 0) 
                            ? `${moversCount} —á–µ–ª. (–î–æ–ø–ª–∞—Ç–∞: ${moversCount * MOVER_PRICE_PER_HOUR} —Ç–≥/—á–∞—Å)` 
                            : '–ù–µ —Ç—Ä–µ–±—É—é—Ç—Å—è';
                        
                        message = handlePreorder('cargoDateTime', modalConfig.prefix);
                        
                        message += getVal('cargoFrom', '–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏', true);
                        message += getVal('cargoTo', '–ê–¥—Ä–µ—Å –≤—ã–≥—Ä—É–∑–∫–∏', true);
                        message += getVal('cargoDescription', '–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–∑–∞', true);
                        
                        message += `*–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–∑—á–∏–∫–æ–≤*:\n${moversText}\n\n`;
                        message += `*–ò–¢–û–ì–û–í–ê–Ø –°–£–ú–ú–ê (–∑–∞ 1 —á–∞—Å)*:\n${formattedPrice} —Ç–≥\n\n`;

                        message += `üí∞ –ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞: ${CARGO_BASE_PRICE.toLocaleString('ru-RU')} —Ç–≥/—á–∞—Å`;
                        
                        const cargoFromAddress = document.getElementById('cargoFrom').value.trim();
                        const cargoToAddress = document.getElementById('cargoTo').value.trim();
                        if (cargoFromAddress) addressesToSave.push(cargoFromAddress);
                        if (cargoToAddress) addressesToSave.push(cargoToAddress);
                        break;

                    case 'soberDriver':
                        message += getVal('soberDriverFrom', '–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å (–ê–≤—Ç–æ)', true);
                        message += getVal('soberDriverCarModel', '–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ', true); 
                        message += getVal('soberDriverTo', '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∞–≤—Ç–æ', true);
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 3800 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è)';
                        
                        const soberDriverFromAddress = document.getElementById('soberDriverFrom').value.trim();
                        if (soberDriverFromAddress) addressesToSave.push(soberDriverFromAddress);
                        break;
                        
                    case 'assistance':
                        const type = document.getElementById('assistanceType').value;
                        if (!type) {
                            requiredFieldsMissing = true;
                            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—à–∏–±–∫—É –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                            statusEl.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏.';
                            statusEl.classList.remove('hidden');
                            return;
                        }

                        message += getVal('assistanceType', '–¢–∏–ø –ø–æ–º–æ—â–∏');
                        
                        if (type === '–ü–æ–¥–∫–∞—á–∞—Ç—å –∫–æ–ª–µ—Å–æ' || type === '–ü—Ä–∏–∫—É—Ä–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å') {
                            message += getVal('carModel', '–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ');
                            message += getVal('licencePlate', '–ì–æ—Å. –Ω–æ–º–µ—Ä');
                        }
                        
                        message += getVal('assistanceTask', '–î–µ—Ç–∞–ª–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è');
                        message += getVal('assistanceAddress', '–ê–¥—Ä–µ—Å (–≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å)', true);
                        message += 'üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ü–µ–Ω–∞: –æ—Ç 1500 —Ç–≥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ —Ç—Ä–µ–±—É–µ–º–æ–π –ø–æ–º–æ—â–∏)';
                        
                        const assistanceAddress = document.getElementById('assistanceAddress').value.trim();
                        if (assistanceAddress) addressesToSave.push(assistanceAddress);
                        break;
                }

                if (requiredFieldsMissing) {
                    // –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ –ø–æ–ª–µ –ø–æ–º–æ—â–∏, –Ω–æ –æ—à–∏–±–∫–∞ –ø—Ä–æ–±—Ä–æ—Å–∏–ª–∞—Å—å –≤—ã—à–µ (–∫–∞–∫ –≤ –∞—É–∫—Ü–∏–æ–Ω–µ)
                    if (statusEl.classList.contains('hidden')) {
                         statusEl.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.';
                         statusEl.classList.remove('hidden');
                    }
                    return;
                }
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤
                for (const address of addressesToSave) {
                    await saveAddress(address);
                }

                // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ WhatsApp
                const waLink = `https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(message)}`;
                window.open(waLink, '_blank');

                window.closeModal(modalId);
                this.reset();
            });
        });

    </script>
</body>
</html>
